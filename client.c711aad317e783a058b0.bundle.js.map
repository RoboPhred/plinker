{"version":3,"sources":["webpack:///./src/services/boing/state.ts","webpack:///./src/math.ts","webpack:///./src/services/boing/actions/tick.ts","webpack:///./src/identity.ts","webpack:///./src/theme/index.ts","webpack:///./src/theme/theme.ts","webpack:///./src/services/boing/actions/create-bouncer.ts","webpack:///./src/services/boing/actions/move-emitter.ts","webpack:///./src/services/boing/actions/move-bouncer.ts","webpack:///./src/services/boing/actions/set-emitter-rate.ts","webpack:///./src/services/boing/actions/set-size.ts","webpack:///./src/services/boing/actions/set-gravity.ts","webpack:///./src/tone.ts","webpack:///./src/services/boing/selectors/balls.ts","webpack:///./src/services/boing/selectors/bouncers.ts","webpack:///./src/services/boing/selectors/emitters.ts","webpack:///./src/index.tsx","webpack:///./src/style.css?8f34","webpack:///./src/style.css","webpack:///./src/root.tsx","webpack:///./src/theme/components/ThemeProvider.tsx","webpack:///./src/store/components/StoreProvider.tsx","webpack:///./src/store/store.ts","webpack:///./src/store/reducer.ts","webpack:///./src/state.ts","webpack:///./src/time.ts","webpack:///./src/services/boing/reducer/index.ts","webpack:///./src/services/boing/reducer/tick-emitters.ts","webpack:///./src/services/boing/reducer/tick-balls.ts","webpack:///./src/utils.ts","webpack:///./src/services/boing/reducer/create-bouncer.ts","webpack:///./src/services/boing/reducer/move-emitter.ts","webpack:///./src/services/boing/reducer/move-bouncer.ts","webpack:///./src/services/boing/reducer/set-emitter-rate.ts","webpack:///./src/services/boing/reducer/set-size.ts","webpack:///./src/services/boing/reducer/set-gravity.ts","webpack:///./src/store/saga.ts","webpack:///./src/services/boing/saga/index.ts","webpack:///./src/services/boing/saga/tick.ts","webpack:///./src/store/devtool-sanitizer.ts","webpack:///./src/components/App/index.ts","webpack:///./src/components/App/component.tsx","webpack:///./src/theme/utils.ts","webpack:///./src/components/Starter/index.ts","webpack:///./src/components/Starter/component.tsx","webpack:///./src/components/Game/index.ts","webpack:///./src/components/Game/component.tsx","webpack:///./src/components/BallField/index.ts","webpack:///./src/components/BallField/component.tsx","webpack:///./src/components/Ball/index.ts","webpack:///./src/components/Ball/component.tsx","webpack:///./src/components/Ball/connector.ts","webpack:///./src/components/BallField/connector.ts","webpack:///./src/components/BouncerField/index.ts","webpack:///./src/components/BouncerField/component.tsx","webpack:///./src/components/Bouncer/index.ts","webpack:///./src/components/Bouncer/component.tsx","webpack:///./src/components/DragHandle/index.ts","webpack:///./src/components/DragHandle/component.tsx","webpack:///./src/components/Bouncer/connector.ts","webpack:///./src/components/BouncerField/connector.ts","webpack:///./src/components/EmitterField/index.ts","webpack:///./src/components/EmitterField/component.tsx","webpack:///./src/components/Emitter/index.ts","webpack:///./src/components/Emitter/component.tsx","webpack:///./src/components/RadialSvgSlider/index.ts","webpack:///./src/components/RadialSvgSlider/component.tsx","webpack:///./src/components/Emitter/connector.ts","webpack:///./src/components/EmitterField/connector.ts","webpack:///./src/components/GravitySlider/index.ts","webpack:///./src/components/AngleSvgSlider/index.ts","webpack:///./src/components/AngleSvgSlider/component.tsx","webpack:///./src/components/GravitySlider/connector.ts","webpack:///./src/services/boing/selectors/field.tsx","webpack:///./src/components/Game/connector.ts"],"names":["math_1","__webpack_require__","time_1","exports","defaultBallState","Object","freeze","position","VEC_ZERO","velocity","defaultEmitterState","rate","lastEmit","defaultBouncerState","toneTriggerTimestamp","defaultBoingServiceState","tick","gravity","x","y","SECOND_AS_MILLIS","fieldMin","fieldMax","ballsById","emittersById","a","__assign","id","bouncersById","b","p1","p2","dotProduct","determinate","pointInRange","p","minX","Math","min","maxX","max","minY","maxY","VEC_X","constrain","add","subtract","scale","scaler","length","sqrt","magnitude","angle","det","dot","atan2","vector","cos","sin","intercept","am","ab","bm","bb","Number","isFinite","ACTION_TICK","millis","type","payload","millisElapsed","isTickAction","action","identities","collection","keys","values","map","__export","theme","pixelsPerMeter","default","ACTION_CREATE_BOUNCER","createBouncer","isCreateBouncerAction","ACTION_MOVE_EMITTER","moveEmitter","isMoveEmitterAction","ACTION_MOVE_BOUNCER","moveBouncer","isMoveBouncerAction","ACTION_SET_EMITTER_RATE","setEmitterRate","isSetEmitterRateAction","ACTION_SET_SIZE","setSize","isSetSizeAction","ACTION_SET_GRAVITY_DIRECTION","setGravityDirection","isSetGravityDirectionAction","ACTION_SET_GRAVITY_POWER","setGravityStrength","strength","isSetGravityStrengthAction","tone_1","__importDefault","context","lookAhead","init","start","window","testSynth","AMSynth","toMaster","ballsByIdSelector","state","services","boing","bouncersByIdSelector","emittersByIdSelector","React","__importStar","ReactDOM","root_1","rootEl","document","getElementById","render","createElement","content","module","i","options","hmr","transform","insertInto","undefined","locals","push","ThemeProvider_1","StoreProvider_1","App_1","react_jss_1","theme_1","_a","children","ThemeProvider","Fragment","react_redux_1","store_1","Provider","store","redux_1","redux_saga_1","reducer_1","saga_1","devtool_sanitizer_1","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","actionSanitizer","stateSanitizer","actionsBlacklist","compose","sagaMiddleware","createStore","applyMiddleware","run","state_1","servicesReducer","combineReducers","defaultAppState","reduce_reducers_1","tick_1","tick_emitters_1","tick_balls_1","create_bouncer_1","move_emitter_1","move_bouncer_1","set_emitter_rate_1","set_size_1","set_gravity_1","childReducers","v4_1","identity_1","_d","__values","_e","next","done","emitterId","value","emitter","newBallId","_b","_c","lodash_1","fp_1","utils_1","reduce","ballId","ball","unset","movementLine","movementVec","interceptData","line","intercepts","bouncer","bouncerId","filter","isNotNull","first","interceptBouncer","intercept_1","bouncerVec","interceptAngle","lineAngle","bounceAngle","PI","reflect","abs","bouncerState","Date","now","set","ballState","tickBall","val","newEmitter","newBouncer","size","angle_1","effects_1","fork","sent","FIXED_TIME","onTick","elapsedMillis","put","takeEvery","delayMillis","previous","eventChannel","iv","setInterval","current","elapsed","clearInterval","component_1","Starter_1","Game_1","styles","createStyles","game","width","height","classes","__read","useState","started","setStarted","onStarted","useCallback","className","onStart","onClick","connector_1","component_size_1","BallField_1","BouncerField_1","EmitterField_1","GravitySlider_1","onCreateBouncer","onResize","newBouncerStart","setNewBouncerStart","newBouncerEnd","setNewBouncerEnd","pointerDown","e","clientX","clientY","stopPropagation","preventDefault","pointerMove","pointerUp","newBouncerFinal","ref","useRef","oldSize","setOldSize","viewBox","onPointerDown","onPointerMove","onPointerUp","r","cx","cy","x1","y1","x2","y2","stroke","Ball_1","ballIds","key","balls_1","connect","props","pick","Bouncer_1","bouncerIds","DragHandle_1","synth","PolySynth","TONE_MIN","TONE_MAX","LENGTH_MIN","LENGTH_MAX","onMove","lastTone","setLastTone","triggerAttackRelease","onP1Move","onP2Move","onDrag","rect","cursor","isMoving","setMoving","setPointerCapture","pointerId","releasePointerCapture","fill","bouncers_1","dispatch","Emitter_1","emitterIds","RadialSvgSlider_1","onSetRate","onChange","handle","startAngle","endAngle","range","generatePath","join","generateHandlePath","percent","rootRef","handleRef","isPointerDown","setPointerDown","onHandlePointerDown","onHandlePointerMove","box","getBoundingClientRect","handleVec","left","top","handleAngle","valueAngle","onHandlePointerUp","d","strokeWidth","emitters_1","AngleSvgSlider_1","console","log","field_1","mapDispatchToProps","gravityDirectionSelector","gravitySelector"],"mappings":"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","file":"client.c711aad317e783a058b0.bundle.js","sourcesContent":["import { Vector2, Line, VEC_ZERO } from \"@/math\";\r\nimport { SECOND_AS_MILLIS } from \"@/time\";\r\nimport { IdentityObject, IdentityCollection } from \"@/identity\";\r\n\r\nexport interface BallState extends IdentityObject {\r\n  position: Vector2;\r\n  velocity: Vector2;\r\n}\r\nexport const defaultBallState = Object.freeze({\r\n  position: VEC_ZERO,\r\n  velocity: VEC_ZERO\r\n});\r\n\r\nexport interface EmitterState extends IdentityObject {\r\n  position: Vector2;\r\n  rate: number;\r\n  velocity: Vector2;\r\n  lastEmit: number;\r\n}\r\n\r\nexport const defaultEmitterState = Object.freeze({\r\n  position: VEC_ZERO,\r\n  rate: 1000,\r\n  velocity: VEC_ZERO,\r\n  lastEmit: 0\r\n});\r\n\r\nexport interface BouncerState extends IdentityObject, Line {\r\n  toneTriggerTimestamp: number;\r\n}\r\n\r\nexport const defaultBouncerState = Object.freeze({\r\n  toneTriggerTimestamp: 0\r\n});\r\n\r\nexport interface BoingServiceState {\r\n  tick: number;\r\n  gravity: Vector2;\r\n  fieldMin: Vector2;\r\n  fieldMax: Vector2;\r\n  ballsById: IdentityCollection<BallState>;\r\n  emittersById: IdentityCollection<EmitterState>;\r\n  bouncersById: IdentityCollection<BouncerState>;\r\n}\r\n\r\nexport const defaultBoingServiceState: Readonly<\r\n  BoingServiceState\r\n> = Object.freeze({\r\n  tick: 0,\r\n  gravity: { x: 0, y: 9.8 / SECOND_AS_MILLIS },\r\n  fieldMin: { x: 0, y: 0 },\r\n  fieldMax: { x: 1000, y: 1000 },\r\n  ballsById: {},\r\n  emittersById: {\r\n    a: {\r\n      ...defaultEmitterState,\r\n      id: \"a\",\r\n      position: { x: 100, y: 100 },\r\n      velocity: { x: 5, y: 0 },\r\n      rate: 1000\r\n    }\r\n  },\r\n  bouncersById: {\r\n    b: {\r\n      ...defaultBouncerState,\r\n      id: \"b\",\r\n      p1: {\r\n        x: 300,\r\n        y: 50\r\n      },\r\n      p2: {\r\n        x: 300,\r\n        y: 150\r\n      }\r\n    }\r\n  }\r\n});\r\n","export interface Vector2 {\r\n  x: number;\r\n  y: number;\r\n}\r\n\r\n// It might simplify intercept calculations to store the line\r\n//  as a starting point, angle, and length\r\nexport interface Line {\r\n  p1: Vector2;\r\n  p2: Vector2;\r\n}\r\n\r\nexport const VEC_ZERO: Readonly<Vector2> = Object.freeze({ x: 0, y: 0 });\r\nexport const VEC_X: Readonly<Vector2> = Object.freeze({ x: 1, y: 0 });\r\n\r\nexport function constrain(x: number, min: number, max: number): number {\r\n  return Math.min(Math.max(x, min), max);\r\n}\r\n\r\nexport function add(a: Readonly<Vector2>, b: Readonly<Vector2>): Vector2 {\r\n  return {\r\n    x: a.x + b.x,\r\n    y: a.y + b.y\r\n  };\r\n}\r\n\r\nexport function subtract(a: Readonly<Vector2>, b: Readonly<Vector2>): Vector2 {\r\n  return {\r\n    x: a.x - b.x,\r\n    y: a.y - b.y\r\n  };\r\n}\r\n\r\nexport function scale(a: Readonly<Vector2>, scaler: number): Vector2 {\r\n  return {\r\n    x: a.x * scaler,\r\n    y: a.y * scaler\r\n  };\r\n}\r\n\r\nexport function length(a: Readonly<Line>): number {\r\n  const x = a.p1.x - a.p2.x;\r\n  const y = a.p1.y - a.p2.y;\r\n  return Math.sqrt(x * x + y * y);\r\n}\r\n\r\nexport function magnitude(a: Readonly<Vector2>): number {\r\n  return Math.sqrt(a.x * a.x + a.y * a.y);\r\n}\r\n\r\nexport function dotProduct(a: Readonly<Vector2>, b: Readonly<Vector2>) {\r\n  return a.x * b.x + a.y * b.y;\r\n}\r\n\r\nexport function determinate(a: Readonly<Vector2>, b: Readonly<Vector2>) {\r\n  return a.x * b.y - a.y * b.x;\r\n}\r\n\r\nexport function angle(a: Readonly<Vector2>, b: Readonly<Vector2>): number {\r\n  // This method only produces in range of 0 to 180\r\n  // // a.b = |a| * |b| * cos t\r\n  // // cos t = a.b / (|a| * |b|)\r\n  // const la = magnitude(a);\r\n  // const lb = magnitude(b);\r\n  // const dot = dotProduct(a, b);\r\n  // return Math.acos(dot / (la * lb));\r\n\r\n  // This method gives full circle angles\r\n  const det = determinate(a, b);\r\n  const dot = dotProduct(a, b);\r\n  return Math.atan2(det, dot);\r\n}\r\n\r\nexport function vector(angle: number, magnitude: number) {\r\n  return {\r\n    x: magnitude * Math.cos(angle),\r\n    y: magnitude * Math.sin(angle)\r\n  };\r\n}\r\n\r\nexport function intercept(\r\n  a: Readonly<Line>,\r\n  b: Readonly<Line>\r\n): Vector2 | null {\r\n  // y = mx+b\r\n  // m1*x+b1 = m2*x+b2\r\n  // b1 = m2*x - m1*x + b2\r\n  // b1 - b2 = m2*x - m1*x\r\n  // b1 - b2 = x*(m2 - m1)\r\n  // (b1 - b2) / (m2 - m1) = x\r\n\r\n  // y = mx+b\r\n  // y - b = mx\r\n  // (y - b)/m = x\r\n\r\n  const am = (a.p2.y - a.p1.y) / (a.p2.x - a.p1.x);\r\n  const ab = a.p1.y - am * a.p1.x;\r\n\r\n  const bm = (b.p2.y - b.p1.y) / (b.p2.x - b.p1.x);\r\n  const bb = b.p1.y - bm * b.p1.x;\r\n\r\n  if (bm - am === 0) {\r\n    // parallel lines\r\n    return null;\r\n  }\r\n\r\n  let x: number, y: number;\r\n  if (!Number.isFinite(am)) {\r\n    // a is vertical line\r\n    y = bm * a.p1.x + bb;\r\n    x = a.p1.x;\r\n  } else if (!Number.isFinite(bm)) {\r\n    // b is vertical line\r\n    y = am * b.p1.x + ab;\r\n    x = b.p1.x;\r\n  } else {\r\n    x = (ab - bb) / (bm - am);\r\n    y = am * x + ab;\r\n  }\r\n\r\n  const intercept: Vector2 = {\r\n    x,\r\n    y\r\n  };\r\n\r\n  // Check to see if intercept is within the lines\r\n  if (!pointInRange(intercept, a.p1, a.p2)) {\r\n    return null;\r\n  }\r\n  if (!pointInRange(intercept, b.p1, b.p2)) {\r\n    return null;\r\n  }\r\n\r\n  return intercept;\r\n}\r\n\r\nfunction pointInRange(\r\n  p: Readonly<Vector2>,\r\n  a: Readonly<Vector2>,\r\n  b: Readonly<Vector2>\r\n): boolean {\r\n  const minX = Math.min(a.x, b.x);\r\n  const maxX = Math.max(a.x, b.x);\r\n  const minY = Math.min(a.y, b.y);\r\n  const maxY = Math.max(a.y, b.y);\r\n  return p.x >= minX && p.x <= maxX && p.y >= minY && p.y <= maxY;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_TICK = \"boing/tick\";\r\nexport const tick = (millis: number) => ({\r\n  type: ACTION_TICK as typeof ACTION_TICK,\r\n  payload: { millisElapsed: millis }\r\n});\r\nexport type TickAction = ReturnType<typeof tick>;\r\nexport function isTickAction(action: AnyAction): action is TickAction {\r\n  return action.type === ACTION_TICK;\r\n}\r\n","export interface IdentityObject {\r\n  id: string;\r\n}\r\n\r\nexport interface IdentityCollection<T extends IdentityObject> {\r\n  [id: string]: T;\r\n}\r\n\r\nexport function identities(collection: IdentityCollection<any>): string[] {\r\n  return Object.keys(collection);\r\n}\r\nexport function values<T extends IdentityObject>(\r\n  collection: IdentityCollection<T>\r\n): T[] {\r\n  return Object.keys(collection).map(id => collection[id]);\r\n}\r\n","export * from \"./theme\";\r\nexport * from \"./utils\";\r\n","const PIXELS_PER_INCH = 96;\r\n\r\nconst theme = {\r\n  pixelsPerMeter: 1 * PIXELS_PER_INCH\r\n};\r\nexport default theme;\r\n\r\nexport type Theme = typeof theme;\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { Vector2 } from \"@/math\";\r\n\r\nexport const ACTION_CREATE_BOUNCER = \"boing/create-bouncer\";\r\nexport const createBouncer = (p1: Vector2, p2: Vector2) => ({\r\n  type: ACTION_CREATE_BOUNCER as typeof ACTION_CREATE_BOUNCER,\r\n  payload: { p1, p2 }\r\n});\r\nexport type CreateBouncerAction = ReturnType<typeof createBouncer>;\r\nexport function isCreateBouncerAction(\r\n  action: AnyAction\r\n): action is CreateBouncerAction {\r\n  return action.type === ACTION_CREATE_BOUNCER;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_MOVE_EMITTER = \"boing/move-emitter\";\r\nexport const moveEmitter = (id: string, x: number, y: number) => ({\r\n  type: ACTION_MOVE_EMITTER as typeof ACTION_MOVE_EMITTER,\r\n  payload: { id, x, y }\r\n});\r\nexport type MoveEmitterAction = ReturnType<typeof moveEmitter>;\r\nexport function isMoveEmitterAction(\r\n  action: AnyAction\r\n): action is MoveEmitterAction {\r\n  return action.type === ACTION_MOVE_EMITTER;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { Vector2 } from \"@/math\";\r\n\r\nexport const ACTION_MOVE_BOUNCER = \"boing/move-bouncer\";\r\nexport const moveBouncer = (id: string, p1: Vector2, p2: Vector2) => ({\r\n  type: ACTION_MOVE_BOUNCER as typeof ACTION_MOVE_BOUNCER,\r\n  payload: { id, p1, p2 }\r\n});\r\nexport type MoveBouncerAction = ReturnType<typeof moveBouncer>;\r\nexport function isMoveBouncerAction(\r\n  action: AnyAction\r\n): action is MoveBouncerAction {\r\n  return action.type === ACTION_MOVE_BOUNCER;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_SET_EMITTER_RATE = \"boing/set-emitter-rate\";\r\nexport const setEmitterRate = (id: string, rate: number) => ({\r\n  type: ACTION_SET_EMITTER_RATE as typeof ACTION_SET_EMITTER_RATE,\r\n  payload: { id, rate }\r\n});\r\nexport type SetEmitterRateAction = ReturnType<typeof setEmitterRate>;\r\nexport function isSetEmitterRateAction(\r\n  action: AnyAction\r\n): action is SetEmitterRateAction {\r\n  return action.type === ACTION_SET_EMITTER_RATE;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_SET_SIZE = \"boing/set-size\";\r\nexport const setSize = (x: number, y: number) => ({\r\n  type: ACTION_SET_SIZE as typeof ACTION_SET_SIZE,\r\n  payload: { x, y }\r\n});\r\nexport type SetSizeAction = ReturnType<typeof setSize>;\r\nexport function isSetSizeAction(action: AnyAction): action is SetSizeAction {\r\n  return action.type === ACTION_SET_SIZE;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_SET_GRAVITY_DIRECTION = \"boing/set-gravity-direction\";\r\nexport const setGravityDirection = (angle: number) => ({\r\n  type: ACTION_SET_GRAVITY_DIRECTION as typeof ACTION_SET_GRAVITY_DIRECTION,\r\n  payload: { angle }\r\n});\r\nexport type SetGravityDirectionAction = ReturnType<typeof setGravityDirection>;\r\nexport function isSetGravityDirectionAction(\r\n  action: AnyAction\r\n): action is SetGravityDirectionAction {\r\n  return action.type === ACTION_SET_GRAVITY_DIRECTION;\r\n}\r\n\r\nexport const ACTION_SET_GRAVITY_POWER = \"boing/set-gravity-power\";\r\nexport const setGravityStrength = (strength: number) => ({\r\n  type: ACTION_SET_GRAVITY_POWER as typeof ACTION_SET_GRAVITY_POWER,\r\n  payload: { strength }\r\n});\r\nexport type SetGravityStrengthAction = ReturnType<typeof setGravityStrength>;\r\nexport function isSetGravityStrengthAction(\r\n  action: AnyAction\r\n): action is SetGravityStrengthAction {\r\n  return action.type === ACTION_SET_GRAVITY_POWER;\r\n}\r\n","import Tone from \"tone\";\r\n\r\n// We are triggering tones in response to visual events, so we need\r\n//  the tone to occur without any delay.\r\n// Remove the lookAhead scheduling to play the tone asap.\r\nTone.context.lookAhead = 0;\r\n\r\nexport default Tone;\r\n\r\nexport function init() {\r\n  Tone.start();\r\n  (window as any).testSynth = new Tone.AMSynth().toMaster();\r\n}\r\n","import { AppState } from \"@/state\";\r\n\r\nexport const ballsByIdSelector = (state: AppState) =>\r\n  state.services.boing.ballsById;\r\n","import { AppState } from \"@/state\";\r\n\r\nexport const bouncersByIdSelector = (state: AppState) =>\r\n  state.services.boing.bouncersById;\r\n","import { AppState } from \"@/state\";\r\n\r\nexport const emittersByIdSelector = (state: AppState) =>\r\n  state.services.boing.emittersById;\r\n","import \"es6-promise/auto\";\r\nimport \"resize-observer-polyfill\";\r\n\r\nimport \"@/style.css\";\r\n\r\nimport * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\n\r\nimport Root from \"./root\";\r\n\r\nconst rootEl = document.getElementById(\"root\");\r\nif (rootEl) {\r\n  ReactDOM.render(<Root />, rootEl);\r\n}\r\n","\nvar content = require(\"!!../node_modules/css-loader/dist/cjs.js!./style.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/css-loader/dist/cjs.js!./style.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/css-loader/dist/cjs.js!./style.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/*\\r\\nThis should be kept minimal and only provide globals\\r\\nor non-react component styles.\\r\\n*/\\r\\n\\r\\nhtml, body, #root {\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  margin: 0;\\r\\n}\", \"\"]);\n\n","import * as React from \"react\";\r\n\r\nimport ThemeProvider from \"@/theme/components/ThemeProvider\";\r\nimport StoreProvider from \"@/store/components/StoreProvider\";\r\n\r\nimport App from \"@/components/App\";\r\n\r\nconst Root: React.FC = () => (\r\n  <ThemeProvider>\r\n    <StoreProvider>\r\n      <App />\r\n    </StoreProvider>\r\n  </ThemeProvider>\r\n);\r\n\r\nexport default Root;\r\n","import * as React from \"react\";\r\n\r\nimport { ThemeProvider as JssProvider } from \"react-jss\";\r\n\r\nimport theme from \"../theme\";\r\n\r\nconst ThemeProvider: React.FC = ({ children }) => (\r\n  <JssProvider theme={theme}>\r\n    <>{children}</>\r\n  </JssProvider>\r\n);\r\n\r\nexport default ThemeProvider;\r\n","import * as React from \"react\";\r\n\r\nimport { Provider } from \"react-redux\";\r\n\r\nimport store from \"../store\";\r\n\r\nconst StoreProvider: React.FC = ({ children }) => (\r\n  <Provider store={store}>{children}</Provider>\r\n);\r\nexport default StoreProvider;\r\n","import {\r\n  compose,\r\n  createStore as createReduxStore,\r\n  applyMiddleware\r\n} from \"redux\";\r\n\r\nimport createSagaMiddleware from \"redux-saga\";\r\n\r\nimport reducer from \"./reducer\";\r\nimport saga from \"./saga\";\r\n\r\nimport {\r\n  actionSanitizer,\r\n  stateSanitizer,\r\n  actionsBlacklist\r\n} from \"./devtool-sanitizer\";\r\n\r\nfunction createStore() {\r\n  const composeEnhancers =\r\n    (window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ &&\r\n      window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\r\n        actionSanitizer,\r\n        stateSanitizer,\r\n        actionsBlacklist\r\n      })) ||\r\n    compose;\r\n\r\n  const sagaMiddleware = createSagaMiddleware();\r\n\r\n  const store = createReduxStore(\r\n    reducer,\r\n    composeEnhancers(applyMiddleware(sagaMiddleware))\r\n  );\r\n  sagaMiddleware.run(saga);\r\n  return store;\r\n}\r\n\r\nconst store = createStore();\r\nexport default store;\r\n","import { combineReducers, AnyAction } from \"redux\";\r\n\r\nimport { AppState, defaultAppState } from \"@/state\";\r\n\r\nimport boingServiceReducer from \"@/services/boing/reducer\";\r\n\r\nconst servicesReducer = combineReducers({\r\n  boing: boingServiceReducer\r\n});\r\n\r\nexport default function reducer(\r\n  state: AppState = defaultAppState,\r\n  action: AnyAction\r\n): AppState {\r\n  return {\r\n    services: servicesReducer(state.services, action)\r\n  };\r\n}\r\n","import {\r\n  BoingServiceState,\r\n  defaultBoingServiceState\r\n} from \"@/services/boing/state\";\r\n\r\nexport interface AppState {\r\n  services: {\r\n    boing: BoingServiceState;\r\n  };\r\n}\r\n\r\nexport const defaultAppState: Readonly<AppState> = Object.freeze({\r\n  services: {\r\n    boing: defaultBoingServiceState\r\n  }\r\n});\r\n","export const SECOND_AS_MILLIS = 1000;\r\n","import reduceReducers from \"reduce-reducers\";\r\nimport { AnyAction } from \"redux\";\r\n\r\nimport { BoingServiceState, defaultBoingServiceState } from \"../state\";\r\n\r\nimport { isTickAction } from \"../actions/tick\";\r\n\r\nimport tickEmittersReducer from \"./tick-emitters\";\r\nimport tickBallsReducer from \"./tick-balls\";\r\nimport createBouncerReducer from \"./create-bouncer\";\r\nimport moveEmitterReducer from \"./move-emitter\";\r\nimport moveBouncerReducer from \"./move-bouncer\";\r\nimport setEmitterRateReducer from \"./set-emitter-rate\";\r\nimport setSizeReducer from \"./set-size\";\r\nimport setGravityReducer from \"./set-gravity\";\r\n\r\nconst childReducers = reduceReducers(\r\n  tickEmittersReducer,\r\n  tickBallsReducer,\r\n  createBouncerReducer,\r\n  moveEmitterReducer,\r\n  moveBouncerReducer,\r\n  setEmitterRateReducer,\r\n  setSizeReducer,\r\n  setGravityReducer\r\n);\r\n\r\nexport default function reducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n) {\r\n  if (isTickAction(action)) {\r\n    state = {\r\n      ...state,\r\n      tick: state.tick + action.payload.millisElapsed\r\n    };\r\n  }\r\n\r\n  return childReducers(state, action);\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport uuid from \"uuid/v4\";\r\n\r\nimport {\r\n  BoingServiceState,\r\n  defaultBoingServiceState,\r\n  defaultBallState\r\n} from \"../state\";\r\n\r\nimport { identities } from \"@/identity\";\r\nimport { VEC_ZERO } from \"@/math\";\r\n\r\nimport { isTickAction } from \"../actions/tick\";\r\n\r\nexport default function tickEmittersReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (!isTickAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  for (const emitterId of identities(state.emittersById)) {\r\n    const emitter = state.emittersById[emitterId];\r\n    if (state.tick - emitter.lastEmit >= emitter.rate) {\r\n      const newBallId = uuid();\r\n      state = {\r\n        ...state,\r\n        emittersById: {\r\n          ...state.emittersById,\r\n          [emitterId]: {\r\n            ...state.emittersById[emitterId],\r\n            lastEmit: state.tick\r\n          }\r\n        },\r\n        ballsById: {\r\n          ...state.ballsById,\r\n          [newBallId]: {\r\n            ...defaultBallState,\r\n            id: newBallId,\r\n            position: emitter.position,\r\n            velocity: emitter.velocity\r\n          }\r\n        }\r\n      };\r\n    }\r\n  }\r\n\r\n  return state;\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport { first } from \"lodash\";\r\nimport { set, unset } from \"lodash/fp\";\r\n\r\nimport {\r\n  add,\r\n  scale,\r\n  Line,\r\n  intercept,\r\n  length,\r\n  Vector2,\r\n  angle,\r\n  vector,\r\n  magnitude,\r\n  VEC_X,\r\n  subtract\r\n} from \"@/math\";\r\nimport { isNotNull } from \"@/utils\";\r\nimport { values, identities } from \"@/identity\";\r\n\r\nimport {\r\n  BoingServiceState,\r\n  defaultBoingServiceState,\r\n  BallState,\r\n  BouncerState\r\n} from \"../state\";\r\n\r\nimport { isTickAction } from \"../actions/tick\";\r\n\r\nexport default function tickBallsReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (!isTickAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { millisElapsed } = action.payload;\r\n\r\n  const ballIds = identities(state.ballsById);\r\n\r\n  state = ballIds.reduce(\r\n    (state, id) => tickBall(state, id, millisElapsed),\r\n    state\r\n  );\r\n\r\n  return state;\r\n}\r\n\r\nfunction tickBall(\r\n  state: BoingServiceState,\r\n  ballId: string,\r\n  millisElapsed: number\r\n): BoingServiceState {\r\n  const { gravity, fieldMin, fieldMax, ballsById: balls } = state;\r\n  const ball = balls[ballId];\r\n\r\n  let velocity = add(ball.velocity, scale(gravity, millisElapsed));\r\n  let position = add(ball.position, velocity);\r\n\r\n  if (\r\n    position.x < fieldMin.x ||\r\n    position.x > fieldMax.x ||\r\n    position.y > fieldMax.y\r\n  ) {\r\n    return unset([\"ballsById\", ballId], state);\r\n  }\r\n\r\n  // Trace a line from the ball's previous position to the\r\n  //  current position, then see if it intercepts a bouncer\r\n  const movementLine: Line = { p1: ball.position, p2: position };\r\n  const movementVec: Vector2 = subtract(movementLine.p1, movementLine.p2);\r\n  const interceptData = interceptBouncer(movementLine, state);\r\n\r\n  if (interceptData) {\r\n    const { bouncerId, intercept } = interceptData;\r\n    const bouncer = state.bouncersById[bouncerId];\r\n    const bouncerVec = subtract(bouncer.p2, bouncer.p1);\r\n\r\n    const interceptAngle = angle(bouncerVec, movementVec);\r\n    const lineAngle = angle(VEC_X, bouncerVec);\r\n    const bounceAngle = lineAngle + (Math.PI - interceptAngle);\r\n\r\n    let reflect = Math.abs(\r\n      length(movementLine) - length({ p1: ball.position, p2: intercept })\r\n    );\r\n    reflect = Math.max(reflect, 1);\r\n\r\n    position = add(intercept, vector(bounceAngle, reflect));\r\n    velocity = vector(bounceAngle, magnitude(velocity));\r\n\r\n    const bouncerState: BouncerState = {\r\n      ...bouncer,\r\n      toneTriggerTimestamp: Date.now()\r\n    };\r\n    Object.freeze(bouncerState);\r\n    Object.freeze(bouncerState.p1);\r\n    Object.freeze(bouncerState.p2);\r\n\r\n    state = set([\"bouncersById\", bouncerId], bouncerState, state);\r\n  }\r\n\r\n  const ballState: BallState = {\r\n    ...ball,\r\n    position,\r\n    velocity\r\n  };\r\n  Object.freeze(ballState);\r\n\r\n  state = set([\"ballsById\", ballId], ballState, state);\r\n\r\n  return state;\r\n}\r\n\r\nfunction interceptBouncer(\r\n  line: Line,\r\n  state: BoingServiceState\r\n): { bouncerId: string; intercept: Vector2 } | null {\r\n  const intercepts = values(state.bouncersById)\r\n    .map(bouncer => {\r\n      const i = intercept(line, bouncer);\r\n      if (i) {\r\n        return {\r\n          bouncerId: bouncer.id,\r\n          intercept: i\r\n        };\r\n      }\r\n      return null;\r\n    })\r\n    .filter(isNotNull);\r\n  return first(intercepts) || null;\r\n}\r\n","export function isNotNull<T>(val: T | null | undefined): val is T {\r\n  return val != null;\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport uuid from \"uuid/v4\";\r\n\r\nimport {\r\n  defaultBoingServiceState,\r\n  BoingServiceState,\r\n  defaultBouncerState\r\n} from \"../state\";\r\n\r\nimport { isCreateBouncerAction } from \"../actions/create-bouncer\";\r\n\r\nexport default function createBouncerReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (!isCreateBouncerAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { p1, p2 } = action.payload;\r\n  const id = uuid();\r\n\r\n  return {\r\n    ...state,\r\n    bouncersById: {\r\n      ...state.bouncersById,\r\n      [id]: {\r\n        ...defaultBouncerState,\r\n        id,\r\n        p1,\r\n        p2\r\n      }\r\n    }\r\n  };\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport { set } from \"lodash/fp\";\r\n\r\nimport {\r\n  BoingServiceState,\r\n  defaultBoingServiceState,\r\n  EmitterState\r\n} from \"../state\";\r\n\r\nimport { isMoveEmitterAction } from \"../actions/move-emitter\";\r\n\r\nexport default function moveEmitterReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (!isMoveEmitterAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { id, x, y } = action.payload;\r\n\r\n  const emitter = state.emittersById[id];\r\n  if (!emitter) {\r\n    return state;\r\n  }\r\n\r\n  const newEmitter: EmitterState = {\r\n    ...emitter,\r\n    position: { x, y }\r\n  };\r\n\r\n  return set([\"emittersById\", id], newEmitter, state);\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport { set } from \"lodash/fp\";\r\n\r\nimport {\r\n  BoingServiceState,\r\n  defaultBoingServiceState,\r\n  BouncerState\r\n} from \"../state\";\r\n\r\nimport { isMoveBouncerAction } from \"../actions/move-bouncer\";\r\n\r\nexport default function moveBouncerReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (!isMoveBouncerAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { id, p1, p2 } = action.payload;\r\n\r\n  const bouncer = state.bouncersById[id];\r\n  if (!bouncer) {\r\n    return state;\r\n  }\r\n\r\n  const newBouncer: BouncerState = {\r\n    ...bouncer,\r\n    p1,\r\n    p2\r\n  };\r\n\r\n  return set([\"bouncersById\", id], newBouncer, state);\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport { set } from \"lodash/fp\";\r\n\r\nimport {\r\n  BoingServiceState,\r\n  defaultBoingServiceState,\r\n  EmitterState\r\n} from \"../state\";\r\nimport { isSetEmitterRateAction } from \"../actions/set-emitter-rate\";\r\n\r\nexport default function setEmitterRateReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (!isSetEmitterRateAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { id, rate } = action.payload;\r\n\r\n  const emitter = state.emittersById[id];\r\n  if (!emitter) {\r\n    return state;\r\n  }\r\n\r\n  const newEmitter: EmitterState = {\r\n    ...emitter,\r\n    rate\r\n  };\r\n\r\n  return set([\"emittersById\", id], newEmitter, state);\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { BoingServiceState, defaultBoingServiceState } from \"../state\";\r\n\r\nimport { isSetSizeAction } from \"../actions/set-size\";\r\n\r\nexport default function setSizeReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (!isSetSizeAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const size = action.payload;\r\n\r\n  return {\r\n    ...state,\r\n    fieldMax: size\r\n  };\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport { vector, magnitude, angle, VEC_X } from \"@/math\";\r\n\r\nimport { BoingServiceState, defaultBoingServiceState } from \"../state\";\r\nimport {\r\n  isSetGravityDirectionAction,\r\n  isSetGravityStrengthAction\r\n} from \"../actions/set-gravity\";\r\n\r\nexport default function setGravityReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (isSetGravityDirectionAction(action)) {\r\n    const { angle } = action.payload;\r\n    return {\r\n      ...state,\r\n      gravity: vector(angle, magnitude(state.gravity))\r\n    };\r\n  }\r\n\r\n  if (isSetGravityStrengthAction(action)) {\r\n    const { strength } = action.payload;\r\n    return {\r\n      ...state,\r\n      gravity: vector(angle(VEC_X, state.gravity), strength)\r\n    };\r\n  }\r\n\r\n  return state;\r\n}\r\n","import { fork } from \"redux-saga/effects\";\r\n\r\nimport boingSaga from \"@/services/boing/saga\";\r\n\r\nexport default function* rootSaga(): IterableIterator<any> {\r\n  yield fork(boingSaga);\r\n}\r\n","import tickSaga from \"./tick\";\r\n\r\nexport default tickSaga;\r\n","import { eventChannel } from \"redux-saga\";\r\nimport { takeEvery, put } from \"redux-saga/effects\";\r\n\r\nimport { tick } from \"@/services/boing/actions/tick\";\r\n\r\n// Allowing us to calculate the offset seems to cause crazyness,\r\n//  rounding errors?\r\nconst FIXED_TIME = true;\r\n\r\nexport default function* tickSaga() {\r\n  yield takeEvery(interval(10), onTick);\r\n}\r\n\r\nfunction* onTick(elapsedMillis: number) {\r\n  yield put(tick(elapsedMillis));\r\n}\r\n\r\nfunction interval(delayMillis: number) {\r\n  let previous = Date.now();\r\n  return eventChannel(emitter => {\r\n    const iv = setInterval(() => {\r\n      const current = Date.now();\r\n      const elapsed = current - previous;\r\n      emitter(FIXED_TIME ? 10 : elapsed);\r\n      previous - current;\r\n    }, delayMillis);\r\n    return () => {\r\n      clearInterval(iv);\r\n    };\r\n  });\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { AppState } from \"@/state\";\r\n\r\nimport { ACTION_TICK } from \"@/services/boing/actions/tick\";\r\n\r\nexport const actionsBlacklist: string[] = [ACTION_TICK];\r\n\r\nexport function actionSanitizer(action: AnyAction): AnyAction {\r\n  return action;\r\n}\r\n\r\nexport function stateSanitizer(state: AppState): any {\r\n  return state;\r\n}\r\n","import App from \"./component\";\r\nexport default App;\r\n","import * as React from \"react\";\r\nimport withSheet from \"react-jss\";\r\n\r\nimport { createStyles, WithStyles } from \"@/theme\";\r\n\r\nimport Starter from \"../Starter\";\r\nimport Game from \"../Game\";\r\n\r\nconst styles = createStyles({\r\n  game: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  }\r\n});\r\n\r\ntype Props = WithStyles<typeof styles>;\r\nconst App: React.FC<Props> = ({ classes }) => {\r\n  const [started, setStarted] = React.useState(false);\r\n  const onStarted = React.useCallback(() => {\r\n    setStarted(true);\r\n  }, [setStarted]);\r\n  if (!started) {\r\n    return <Starter onStart={onStarted} />;\r\n  } else {\r\n    return <Game className={classes.game} />;\r\n  }\r\n};\r\n\r\nexport default withSheet(styles)(App);\r\n","import { CSSProperties } from \"react-jss\";\r\n\r\nexport function createStyles<C extends string>(\r\n  styles: Record<C, CSSProperties<{}>>\r\n): Record<C, CSSProperties<{}>> {\r\n  return styles;\r\n}\r\n\r\nexport type WithStyles<T> = { classes: { [K in keyof T]: string } };\r\n","import Starter from \"./component\";\r\nexport default Starter;\r\n","import * as React from \"react\";\r\n\r\nimport { init } from \"@/tone\";\r\n\r\nexport interface StarterProps {\r\n  onStart(): void;\r\n}\r\nconst Starter: React.FC<StarterProps> = ({ onStart }) => {\r\n  const onClick = React.useCallback(() => {\r\n    init();\r\n    onStart();\r\n  }, []);\r\n  return (\r\n    <div>\r\n      <button onClick={onClick}>Start</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Starter;\r\n","import Game from \"./component\";\r\nimport connectGame from \"./connector\";\r\n\r\nexport default connectGame(Game);\r\n","import * as React from \"react\";\r\nimport useComponentSize from \"@rehooks/component-size\";\r\n\r\nimport { Vector2, VEC_ZERO, magnitude, subtract } from \"@/math\";\r\n\r\nimport BallField from \"../BallField\";\r\nimport BouncerField from \"../BouncerField\";\r\nimport EmitterField from \"../EmitterField\";\r\nimport GravitySlider from \"../GravitySlider\";\r\n\r\nexport interface GameProps {\r\n  className?: string;\r\n  onCreateBouncer(p1: Vector2, p2: Vector2): void;\r\n  onResize(x: number, y: number): void;\r\n}\r\n\r\nconst Game: React.FC<GameProps> = ({\r\n  className,\r\n  onCreateBouncer,\r\n  onResize\r\n}) => {\r\n  const [newBouncerStart, setNewBouncerStart] = React.useState<Vector2 | null>(\r\n    null\r\n  );\r\n  const [newBouncerEnd, setNewBouncerEnd] = React.useState<Vector2 | null>(\r\n    null\r\n  );\r\n  const pointerDown = React.useCallback(\r\n    (e: React.PointerEvent<SVGElement>) => {\r\n      setNewBouncerStart({ x: e.clientX, y: e.clientY });\r\n      setNewBouncerEnd({ x: e.clientX, y: e.clientY });\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    },\r\n    [setNewBouncerStart, setNewBouncerEnd]\r\n  );\r\n  const pointerMove = React.useCallback(\r\n    (e: React.PointerEvent<SVGElement>) => {\r\n      setNewBouncerEnd({ x: e.clientX, y: e.clientY });\r\n    },\r\n    [setNewBouncerEnd]\r\n  );\r\n  const pointerUp = React.useCallback(\r\n    (e: React.PointerEvent<SVGElement>) => {\r\n      if (newBouncerStart == null) {\r\n        return;\r\n      }\r\n      const newBouncerFinal = { x: e.clientX, y: e.clientY };\r\n      const length = Math.abs(\r\n        magnitude(subtract(newBouncerStart, newBouncerFinal))\r\n      );\r\n      if (length >= 50) {\r\n        onCreateBouncer(newBouncerStart, newBouncerFinal);\r\n      }\r\n      setNewBouncerStart(null);\r\n      setNewBouncerEnd(null);\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    },\r\n    [newBouncerStart, setNewBouncerStart, setNewBouncerEnd, onCreateBouncer]\r\n  );\r\n\r\n  const ref = React.useRef(null);\r\n  const [oldSize, setOldSize] = React.useState(VEC_ZERO);\r\n  const size = useComponentSize(ref);\r\n  if (size.width !== oldSize.x || size.height !== oldSize.y) {\r\n    setOldSize({ x: size.width, y: size.height });\r\n    onResize(size.width, size.height);\r\n  }\r\n\r\n  return (\r\n    <div className={className} ref={ref}>\r\n      <svg\r\n        width={`${size.width}`}\r\n        height={`${size.height}`}\r\n        viewBox={`0 0 ${size.width} ${size.height}`}\r\n        onPointerDown={pointerDown}\r\n        onPointerMove={pointerMove}\r\n        onPointerUp={pointerUp}\r\n      >\r\n        <GravitySlider r={15} cx={size.width - 35} cy={size.height - 35} />\r\n        <BallField />\r\n        <BouncerField />\r\n        <EmitterField />\r\n        {newBouncerStart && newBouncerEnd && (\r\n          <line\r\n            x1={newBouncerStart.x}\r\n            y1={newBouncerStart.y}\r\n            x2={newBouncerEnd.x}\r\n            y2={newBouncerEnd.y}\r\n            stroke=\"darkgrey\"\r\n          />\r\n        )}\r\n      </svg>\r\n    </div>\r\n  );\r\n};\r\nexport default Game;\r\n","import BallField from \"./component\";\r\nimport connectBallField from \"./connector\";\r\nexport default connectBallField(BallField);\r\n","import * as React from \"react\";\r\n\r\nimport Ball from \"../Ball\";\r\n\r\nexport interface BallFieldProps {\r\n  ballIds: string[];\r\n}\r\n\r\nconst BallField: React.FC<BallFieldProps> = ({ ballIds }) => (\r\n  <g>\r\n    {ballIds.map(id => (\r\n      <Ball key={id} id={id} />\r\n    ))}\r\n  </g>\r\n);\r\n\r\nexport default BallField;\r\n","import Ball from \"./component\";\r\nimport connectBall from \"./connector\";\r\nexport default connectBall(Ball);\r\n","import * as React from \"react\";\r\n\r\nimport { Vector2 } from \"@/math\";\r\n\r\nexport interface BallProps {\r\n  position: Vector2;\r\n}\r\n\r\nconst Ball: React.FC<BallProps> = ({ position }) => {\r\n  return <circle r={3} cx={position.x} cy={position.y} />;\r\n};\r\n\r\nexport default Ball;\r\n","import { connect } from \"react-redux\";\r\nimport { pick } from \"lodash\";\r\n\r\nimport { AppState } from \"@/state\";\r\nimport { ballsByIdSelector } from \"@/services/boing/selectors/balls\";\r\n\r\nexport interface BallInputProps {\r\n  id: string;\r\n}\r\n\r\nfunction mapStateToProps(state: AppState, props: BallInputProps) {\r\n  const { id } = props;\r\n  const ball = ballsByIdSelector(state)[id];\r\n  return pick(ball, [\"position\"]);\r\n}\r\n\r\nexport default connect(mapStateToProps);\r\n","import { connect } from \"react-redux\";\r\n\r\nimport { identities } from \"@/identity\";\r\n\r\nimport { AppState } from \"@/state\";\r\n\r\nimport { ballsByIdSelector } from \"@/services/boing/selectors/balls\";\r\n\r\nfunction mapStateToProps(state: AppState) {\r\n  const ballsById = ballsByIdSelector(state);\r\n  const ballIds = identities(ballsById);\r\n\r\n  return {\r\n    ballIds\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps);\r\n","import BouncerField from \"./component\";\r\nimport connectBallField from \"./connector\";\r\nexport default connectBallField(BouncerField);\r\n","import * as React from \"react\";\r\n\r\nimport Bouncer from \"../Bouncer\";\r\n\r\nexport interface BouncerFieldProps {\r\n  bouncerIds: string[];\r\n}\r\n\r\nconst BouncerField: React.FC<BouncerFieldProps> = ({ bouncerIds }) => (\r\n  <g>\r\n    {bouncerIds.map(id => (\r\n      <Bouncer key={id} id={id} />\r\n    ))}\r\n  </g>\r\n);\r\n\r\nexport default BouncerField;\r\n","import Bouncer from \"./component\";\r\nimport connectBouncer from \"./connector\";\r\nexport default connectBouncer(Bouncer);\r\n","import * as React from \"react\";\r\n\r\nimport Tone from \"@/tone\";\r\nimport { Vector2, constrain, length } from \"@/math\";\r\n\r\nimport DragHandle from \"../DragHandle\";\r\n\r\nconst synth = new Tone.PolySynth(6, Tone.AMSynth).toMaster();\r\n\r\nexport interface BouncerProps {\r\n  toneTriggerTimestamp: number;\r\n  p1: Vector2;\r\n  p2: Vector2;\r\n  onMove(p1: Vector2, p2: Vector2): void;\r\n}\r\n\r\nconst Bouncer: React.FC<BouncerProps> = ({\r\n  p1,\r\n  p2,\r\n  toneTriggerTimestamp,\r\n  onMove\r\n}) => {\r\n  const [lastTone, setLastTone] = React.useState(0);\r\n  if (toneTriggerTimestamp > lastTone) {\r\n    setLastTone(toneTriggerTimestamp);\r\n    synth.triggerAttackRelease(getTone(length({ p1, p2 })), \"32n\");\r\n  }\r\n\r\n  const onP1Move = React.useCallback(\r\n    (x: number, y: number) => {\r\n      onMove({ x, y }, p2);\r\n    },\r\n    [onMove, p2]\r\n  );\r\n\r\n  const onP2Move = React.useCallback(\r\n    (x: number, y: number) => {\r\n      onMove(p1, { x, y });\r\n    },\r\n    [onMove, p1]\r\n  );\r\n\r\n  return (\r\n    <g>\r\n      <line x1={p1.x} y1={p1.y} x2={p2.x} y2={p2.y} stroke=\"black\" />\r\n      <DragHandle x={p1.x} y={p1.y} onDrag={onP1Move} />\r\n      <DragHandle x={p2.x} y={p2.y} onDrag={onP2Move} />\r\n    </g>\r\n  );\r\n};\r\n\r\nconst TONE_MIN = 50;\r\nconst TONE_MAX = 1000;\r\n\r\nconst LENGTH_MIN = 50;\r\nconst LENGTH_MAX = 500;\r\nfunction getTone(length: number): number {\r\n  // (length - minLength ) / (maxLength) = (tone - minTone) / (maxTone)\r\n  // (length - minLength) / maxLength * maxTone = tone - minTone\r\n  length = LENGTH_MAX - constrain(length, LENGTH_MIN, LENGTH_MAX);\r\n  return (\r\n    ((length - LENGTH_MIN) / (LENGTH_MAX - LENGTH_MIN)) *\r\n      (TONE_MAX - TONE_MIN) +\r\n    TONE_MIN\r\n  );\r\n}\r\n\r\nexport default Bouncer;\r\n","import DragHandle from \"./component\";\r\nexport default DragHandle;\r\n","import * as React from \"react\";\r\nimport injectSheet from \"react-jss\";\r\n\r\nimport { createStyles, WithStyles } from \"@/theme\";\r\n\r\nexport interface DragHandleProps {\r\n  x: number;\r\n  y: number;\r\n  onDrag(x: number, y: number): void;\r\n}\r\n\r\nconst styles = createStyles({\r\n  rect: {\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\ntype Props = DragHandleProps & WithStyles<typeof styles>;\r\nconst DragHandle: React.FC<Props> = ({ x, y, classes, onDrag }) => {\r\n  const ref = React.useRef<SVGCircleElement>(null);\r\n  const [isMoving, setMoving] = React.useState(false);\r\n  const pointerDown = React.useCallback(\r\n    (e: React.PointerEvent<SVGCircleElement>) => {\r\n      if (!ref.current) {\r\n        return;\r\n      }\r\n      ref.current.setPointerCapture(e.pointerId);\r\n      setMoving(true);\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    },\r\n    [ref, setMoving]\r\n  );\r\n  const pointerMove = React.useCallback(\r\n    (e: React.PointerEvent<SVGCircleElement>) => {\r\n      if (!isMoving) {\r\n        return false;\r\n      }\r\n      onDrag(e.clientX, e.clientY);\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    },\r\n    [isMoving]\r\n  );\r\n  const pointerUp = React.useCallback(\r\n    (e: React.PointerEvent<SVGCircleElement>) => {\r\n      if (!ref.current) {\r\n        return;\r\n      }\r\n      ref.current.releasePointerCapture(e.pointerId);\r\n      setMoving(false);\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    },\r\n    [ref, setMoving]\r\n  );\r\n  return (\r\n    <circle\r\n      className={classes.rect}\r\n      ref={ref}\r\n      cx={x}\r\n      cy={y}\r\n      r={6}\r\n      fill=\"darkgrey\"\r\n      onPointerDown={pointerDown}\r\n      onPointerMove={pointerMove}\r\n      onPointerUp={pointerUp}\r\n    />\r\n  );\r\n};\r\n\r\nexport default injectSheet(styles)(DragHandle);\r\n","import { connect } from \"react-redux\";\r\nimport { Dispatch } from \"redux\";\r\nimport { pick } from \"lodash\";\r\n\r\nimport { Vector2 } from \"@/math\";\r\n\r\nimport { AppState } from \"@/state\";\r\nimport { bouncersByIdSelector } from \"@/services/boing/selectors/bouncers\";\r\nimport { moveBouncer } from \"@/services/boing/actions/move-bouncer\";\r\n\r\nexport interface BouncerInputProps {\r\n  id: string;\r\n}\r\n\r\nfunction mapStateToProps(state: AppState, props: BouncerInputProps) {\r\n  const { id } = props;\r\n  const ball = bouncersByIdSelector(state)[id];\r\n  return pick(ball, [\"p1\", \"p2\", \"toneTriggerTimestamp\"]);\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch, props: BouncerInputProps) {\r\n  const { id } = props;\r\n  return {\r\n    onMove: (p1: Vector2, p2: Vector2) => dispatch(moveBouncer(id, p1, p2))\r\n  };\r\n}\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n);\r\n","import { connect } from \"react-redux\";\r\n\r\nimport { identities } from \"@/identity\";\r\n\r\nimport { AppState } from \"@/state\";\r\n\r\nimport { bouncersByIdSelector } from \"@/services/boing/selectors/bouncers\";\r\n\r\nfunction mapStateToProps(state: AppState) {\r\n  const bouncersById = bouncersByIdSelector(state);\r\n  const bouncerIds = identities(bouncersById);\r\n\r\n  return {\r\n    bouncerIds\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps);\r\n","import Emitter from \"./component\";\r\nimport connectEmitter from \"./connector\";\r\nexport default connectEmitter(Emitter);\r\n","import * as React from \"react\";\r\n\r\nimport Emitter from \"../Emitter\";\r\n\r\nexport interface BouncerFieldProps {\r\n  emitterIds: string[];\r\n}\r\n\r\nconst EmitterField: React.FC<BouncerFieldProps> = ({ emitterIds }) => (\r\n  <g>\r\n    {emitterIds.map(id => (\r\n      <Emitter key={id} id={id} />\r\n    ))}\r\n  </g>\r\n);\r\n\r\nexport default EmitterField;\r\n","import Emitter from \"./component\";\r\nimport connectEmitter from \"./connector\";\r\nexport default connectEmitter(Emitter);\r\n","import * as React from \"react\";\r\n\r\nimport { Vector2 } from \"@/math\";\r\n\r\nimport RadialSvgSlider from \"@/components/RadialSvgSlider\";\r\n\r\nexport interface EmitterProps {\r\n  position: Vector2;\r\n  rate: number;\r\n  onMove(x: number, y: number): void;\r\n  onSetRate(rate: number): void;\r\n}\r\n\r\nconst Emitter: React.FC<EmitterProps> = ({\r\n  position,\r\n  rate,\r\n  onMove,\r\n  onSetRate\r\n}) => {\r\n  const ref = React.useRef<SVGCircleElement>(null);\r\n  const [isMoving, setMoving] = React.useState(false);\r\n  const pointerDown = React.useCallback(\r\n    (e: React.PointerEvent<SVGCircleElement>) => {\r\n      if (!ref.current) {\r\n        return;\r\n      }\r\n      ref.current.setPointerCapture(e.pointerId);\r\n      setMoving(true);\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    },\r\n    [ref, setMoving]\r\n  );\r\n  const pointerMove = React.useCallback(\r\n    (e: React.PointerEvent<SVGCircleElement>) => {\r\n      if (!isMoving) {\r\n        return false;\r\n      }\r\n      onMove(e.clientX, e.clientY);\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    },\r\n    [isMoving]\r\n  );\r\n  const pointerUp = React.useCallback(\r\n    (e: React.PointerEvent<SVGCircleElement>) => {\r\n      if (!ref.current) {\r\n        return;\r\n      }\r\n      ref.current.releasePointerCapture(e.pointerId);\r\n      setMoving(false);\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    },\r\n    [ref, setMoving]\r\n  );\r\n  return (\r\n    <g transform={`translate(${position.x}, ${position.y})`}>\r\n      <circle\r\n        ref={ref}\r\n        fill=\"grey\"\r\n        r={5}\r\n        cx={0}\r\n        cy={0}\r\n        onPointerDown={pointerDown}\r\n        onPointerMove={pointerMove}\r\n        onPointerUp={pointerUp}\r\n      />\r\n      <RadialSvgSlider\r\n        cx={0}\r\n        cy={0}\r\n        r={15}\r\n        min={250}\r\n        max={3000}\r\n        value={rate}\r\n        onChange={onSetRate}\r\n      />\r\n    </g>\r\n  );\r\n};\r\n\r\nexport default Emitter;\r\n","import RadialSvgSlider from \"./component\";\r\nexport default RadialSvgSlider;\r\n","import * as React from \"react\";\r\nimport injectSheet from \"react-jss\";\r\n\r\nimport { constrain, Vector2, angle, VEC_X } from \"@/math\";\r\n\r\nimport { createStyles, WithStyles } from \"@/theme\";\r\n\r\nexport interface RadialSvgSliderProps {\r\n  cx: number;\r\n  cy: number;\r\n  r: number;\r\n  min: number;\r\n  max: number;\r\n  value: number;\r\n  onChange(value: number): void;\r\n}\r\n\r\nconst styles = createStyles({\r\n  handle: {\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\nconst startAngle = Math.PI * (1 / 3);\r\nconst endAngle = Math.PI * (2 / 3);\r\nconst range = Math.PI * 2 - (endAngle - startAngle);\r\n\r\ntype Props = RadialSvgSliderProps & WithStyles<typeof styles>;\r\nconst RadialSvgSlider: React.FC<Props> = ({\r\n  cx,\r\n  cy,\r\n  r,\r\n  min,\r\n  max,\r\n  value,\r\n  classes,\r\n  onChange\r\n}) => {\r\n  const percent = constrain((value - min) / (max - min), 0, 1);\r\n  const rootRef = React.useRef<SVGPathElement>(null);\r\n  const handleRef = React.useRef<SVGPathElement>(null);\r\n  const [isPointerDown, setPointerDown] = React.useState(false);\r\n  const onHandlePointerDown = React.useCallback(\r\n    (e: React.PointerEvent<SVGPathElement>) => {\r\n      if (!handleRef.current) {\r\n        return;\r\n      }\r\n      setPointerDown(true);\r\n      handleRef.current.setPointerCapture(e.pointerId);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    [handleRef]\r\n  );\r\n  const onHandlePointerMove = React.useCallback(\r\n    (e: React.PointerEvent<SVGPathElement>) => {\r\n      if (!isPointerDown || !rootRef.current) {\r\n        return;\r\n      }\r\n\r\n      const box = rootRef.current.getBoundingClientRect();\r\n      const handleVec: Vector2 = {\r\n        x: e.clientX - (box.left + box.width / 2),\r\n        y: e.clientY - (box.top + box.height / 2)\r\n      };\r\n      const handleAngle = angle(VEC_X, handleVec);\r\n      let valueAngle = startAngle - handleAngle;\r\n      if (valueAngle < 0) {\r\n        valueAngle += Math.PI * 2;\r\n      }\r\n      const percent = constrain(valueAngle / range, 0, 1);\r\n      onChange(min + (max - min) * percent);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    [isPointerDown, rootRef, min, max, onChange]\r\n  );\r\n  const onHandlePointerUp = React.useCallback(\r\n    (e: React.PointerEvent<SVGPathElement>) => {\r\n      if (!handleRef.current) {\r\n        return;\r\n      }\r\n      setPointerDown(false);\r\n      handleRef.current.releasePointerCapture(e.pointerId);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    [handleRef]\r\n  );\r\n  return (\r\n    <g>\r\n      <path\r\n        ref={rootRef}\r\n        d={generatePath(cx, cy, r)}\r\n        stroke=\"dimgrey\"\r\n        strokeWidth={2}\r\n        fill=\"none\"\r\n      />\r\n      <path\r\n        className={classes.handle}\r\n        ref={handleRef}\r\n        d={generateHandlePath(cx, cy, r, percent)}\r\n        stroke=\"red\"\r\n        strokeWidth={5}\r\n        fill=\"none\"\r\n        onPointerDown={onHandlePointerDown}\r\n        onPointerMove={onHandlePointerMove}\r\n        onPointerUp={onHandlePointerUp}\r\n      />\r\n    </g>\r\n  );\r\n};\r\n\r\nexport default injectSheet(styles)(RadialSvgSlider);\r\n\r\nfunction generatePath(cx: number, cy: number, r: number): string {\r\n  return [\r\n    \"M\",\r\n    cx + Math.cos(startAngle) * r,\r\n    cy + Math.sin(startAngle) * r,\r\n    \"A\",\r\n    r,\r\n    r,\r\n    0,\r\n    1, //large\r\n    0,\r\n    cx + Math.cos(endAngle) * r,\r\n    cy + Math.sin(endAngle) * r\r\n  ].join(\" \");\r\n}\r\n\r\nfunction generateHandlePath(\r\n  cx: number,\r\n  cy: number,\r\n  r: number,\r\n  percent: number\r\n): string {\r\n  const angle = startAngle - range * percent;\r\n  return [\r\n    \"M\",\r\n    cx + Math.cos(angle) * (r - 6),\r\n    cy + Math.sin(angle) * (r - 6),\r\n    \"L\",\r\n    cx + Math.cos(angle) * (r + 6),\r\n    cy + Math.sin(angle) * (r + 6)\r\n  ].join(\" \");\r\n}\r\n","import { connect } from \"react-redux\";\r\n\r\nimport { pick } from \"lodash\";\r\n\r\nimport { AppState } from \"@/state\";\r\nimport { emittersByIdSelector } from \"@/services/boing/selectors/emitters\";\r\nimport { Dispatch } from \"redux\";\r\nimport { moveEmitter } from \"@/services/boing/actions/move-emitter\";\r\nimport { setEmitterRate } from \"@/services/boing/actions/set-emitter-rate\";\r\n\r\nexport interface EmitterInputProps {\r\n  id: string;\r\n}\r\n\r\nfunction mapStateToProps(state: AppState, props: EmitterInputProps) {\r\n  const { id } = props;\r\n  const emitter = emittersByIdSelector(state)[id];\r\n  return pick(emitter, [\"position\", \"rate\"]);\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch, props: EmitterInputProps) {\r\n  const { id } = props;\r\n  return {\r\n    onMove: (x: number, y: number) => dispatch(moveEmitter(id, x, y)),\r\n    onSetRate: (rate: number) => dispatch(setEmitterRate(id, rate))\r\n  };\r\n}\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n);\r\n","import { connect } from \"react-redux\";\r\n\r\nimport { identities } from \"@/identity\";\r\n\r\nimport { AppState } from \"@/state\";\r\n\r\nimport { emittersByIdSelector } from \"@/services/boing/selectors/emitters\";\r\n\r\nfunction mapStateToProps(state: AppState) {\r\n  const emittersById = emittersByIdSelector(state);\r\n  const emitterIds = identities(emittersById);\r\n\r\n  return {\r\n    emitterIds\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps);\r\n","import AngleSvgSlider from \"../AngleSvgSlider\";\r\nimport connectGravitySlider from \"./connector\";\r\nexport default connectGravitySlider(AngleSvgSlider);\r\n","import AngleSvgSlider from \"./component\";\r\nexport default AngleSvgSlider;\r\n","import * as React from \"react\";\r\nimport injectSheet from \"react-jss\";\r\n\r\nimport { createStyles, WithStyles } from \"@/theme\";\r\nimport { VEC_X, Vector2, angle } from \"@/math\";\r\n\r\nexport interface AngleSvgSliderProps {\r\n  cx: number;\r\n  cy: number;\r\n  r: number;\r\n  value: number;\r\n  onChange(value: number): void;\r\n}\r\n\r\nconst styles = createStyles({\r\n  handle: {\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\ntype Props = AngleSvgSliderProps & WithStyles<typeof styles>;\r\nconst AngleSvgSlider: React.FC<Props> = ({\r\n  cx,\r\n  cy,\r\n  r,\r\n  value,\r\n  classes,\r\n  onChange\r\n}) => {\r\n  console.log(value);\r\n  const rootRef = React.useRef<SVGCircleElement>(null);\r\n  const handleRef = React.useRef<SVGPathElement>(null);\r\n  const [isPointerDown, setPointerDown] = React.useState(false);\r\n  const onHandlePointerDown = React.useCallback(\r\n    (e: React.PointerEvent<SVGPathElement>) => {\r\n      if (!handleRef.current) {\r\n        return;\r\n      }\r\n      setPointerDown(true);\r\n      handleRef.current.setPointerCapture(e.pointerId);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    [handleRef]\r\n  );\r\n  const onHandlePointerMove = React.useCallback(\r\n    (e: React.PointerEvent<SVGPathElement>) => {\r\n      if (!isPointerDown || !rootRef.current) {\r\n        return;\r\n      }\r\n      const box = rootRef.current.getBoundingClientRect();\r\n      const handleVec: Vector2 = {\r\n        x: e.clientX - (box.left + box.width / 2),\r\n        y: e.clientY - (box.top + box.height / 2)\r\n      };\r\n      let handleAngle = angle(VEC_X, handleVec);\r\n      if (handleAngle < 0) {\r\n        handleAngle += Math.PI * 2;\r\n      }\r\n      onChange(handleAngle);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    [isPointerDown, rootRef, onChange]\r\n  );\r\n  const onHandlePointerUp = React.useCallback(\r\n    (e: React.PointerEvent<SVGPathElement>) => {\r\n      if (!handleRef.current) {\r\n        return;\r\n      }\r\n      setPointerDown(false);\r\n      handleRef.current.releasePointerCapture(e.pointerId);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    [handleRef]\r\n  );\r\n  return (\r\n    <g>\r\n      <circle\r\n        ref={rootRef}\r\n        cx={cx}\r\n        cy={cy}\r\n        r={r}\r\n        stroke=\"grey\"\r\n        fill=\"none\"\r\n        strokeWidth={2}\r\n      />\r\n      <path\r\n        ref={handleRef}\r\n        className={classes.handle}\r\n        d={generateHandlePath(cx, cy, r, value)}\r\n        stroke=\"red\"\r\n        strokeWidth={5}\r\n        fill=\"none\"\r\n        onPointerDown={onHandlePointerDown}\r\n        onPointerMove={onHandlePointerMove}\r\n        onPointerUp={onHandlePointerUp}\r\n      />\r\n    </g>\r\n  );\r\n};\r\n\r\nexport default injectSheet(styles)(AngleSvgSlider);\r\n\r\nfunction generateHandlePath(\r\n  cx: number,\r\n  cy: number,\r\n  r: number,\r\n  angle: number\r\n): string {\r\n  return [\r\n    \"M\",\r\n    cx + Math.cos(angle) * (r - 6),\r\n    cy + Math.sin(angle) * (r - 6),\r\n    \"L\",\r\n    cx + Math.cos(angle) * (r + 6),\r\n    cy + Math.sin(angle) * (r + 6)\r\n  ].join(\" \");\r\n}\r\n","import { connect } from \"react-redux\";\r\n\r\nimport { AppState } from \"@/state\";\r\nimport { setGravityDirection } from \"@/services/boing/actions/set-gravity\";\r\nimport { gravityDirectionSelector } from \"@/services/boing/selectors/field\";\r\n\r\nfunction mapStateToProps(state: AppState) {\r\n  return {\r\n    value: gravityDirectionSelector(state)\r\n  };\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n  onChange: setGravityDirection\r\n};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n);\r\n","import { AppState } from \"@/state\";\r\nimport { angle, VEC_X } from \"@/math\";\r\n\r\nexport const gravitySelector = (state: AppState) =>\r\n  state.services.boing.gravity;\r\n\r\nexport const gravityDirectionSelector = (state: AppState) =>\r\n  angle(VEC_X, gravitySelector(state));\r\n","import { connect } from \"react-redux\";\r\n\r\nimport { createBouncer } from \"@/services/boing/actions/create-bouncer\";\r\nimport { setSize } from \"@/services/boing/actions/set-size\";\r\n\r\nconst mapDispatchToProps = {\r\n  onCreateBouncer: createBouncer,\r\n  onResize: setSize\r\n};\r\n\r\nexport default connect(\r\n  null,\r\n  mapDispatchToProps\r\n);\r\n"],"sourceRoot":""}