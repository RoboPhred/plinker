{"version":3,"sources":["webpack:///./src/services/boing/state.ts","webpack:///./src/math.ts","webpack:///./src/theme/index.ts","webpack:///./src/services/boing/actions/tick.ts","webpack:///./src/identity.ts","webpack:///./src/theme/theme.ts","webpack:///./src/services/boing/actions/reset.ts","webpack:///./src/services/boing/actions/create-bouncer.ts","webpack:///./src/services/boing/actions/move-emitter.ts","webpack:///./src/services/boing/actions/move-bouncer.ts","webpack:///./src/services/boing/actions/set-emitter-rate.ts","webpack:///./src/services/boing/actions/set-emitter-velocity.ts","webpack:///./src/services/boing/actions/set-size.ts","webpack:///./src/services/boing/actions/set-gravity.ts","webpack:///./src/tone.ts","webpack:///./src/hooks/use-pointer-drag.ts","webpack:///./src/services/boing/selectors/balls.ts","webpack:///./src/components/MouseReveal/index.ts","webpack:///./src/services/boing/selectors/bouncers.ts","webpack:///./src/components/AngleSvgSlider/index.ts","webpack:///./src/services/boing/selectors/emitters.ts","webpack:///./src/index.tsx","webpack:///./src/style.css?8f34","webpack:///./src/style.css","webpack:///./src/root.tsx","webpack:///./src/theme/components/ThemeProvider.tsx","webpack:///./src/store/components/StoreProvider.tsx","webpack:///./src/store/store.ts","webpack:///./src/store/reducer.ts","webpack:///./src/state.ts","webpack:///./src/time.ts","webpack:///./src/services/boing/reducer/index.ts","webpack:///./src/services/boing/reducer/reset.ts","webpack:///./src/services/boing/reducer/tick-emitters.ts","webpack:///./src/services/boing/reducer/tick-balls.ts","webpack:///./src/utils.ts","webpack:///./src/services/boing/reducer/create-bouncer.ts","webpack:///./src/services/boing/reducer/move-emitter.ts","webpack:///./src/services/boing/reducer/move-bouncer.ts","webpack:///./src/services/boing/reducer/set-emitter-rate.ts","webpack:///./src/services/boing/reducer/set-emitter-velocity.ts","webpack:///./src/services/boing/reducer/set-size.ts","webpack:///./src/services/boing/reducer/set-gravity.ts","webpack:///./src/store/saga.ts","webpack:///./src/services/boing/saga/index.ts","webpack:///./src/services/boing/saga/tick.ts","webpack:///./src/store/devtool-sanitizer.ts","webpack:///./src/components/App/index.ts","webpack:///./src/components/App/component.tsx","webpack:///./src/theme/utils.ts","webpack:///./src/components/Game/index.ts","webpack:///./src/components/Game/component.tsx","webpack:///./src/components/BallField/index.ts","webpack:///./src/components/BallField/component.tsx","webpack:///./src/components/Ball/index.ts","webpack:///./src/components/Ball/component.tsx","webpack:///./src/components/Ball/connector.ts","webpack:///./src/components/BallField/connector.ts","webpack:///./src/components/BouncerField/index.ts","webpack:///./src/components/BouncerField/component.tsx","webpack:///./src/components/Bouncer/index.ts","webpack:///./src/components/Bouncer/component.tsx","webpack:///./src/components/DragHandle/index.ts","webpack:///./src/components/DragHandle/component.tsx","webpack:///./src/components/MouseReveal/component.tsx","webpack:///./src/hooks/use-mouse-distance.ts","webpack:///./src/components/Bouncer/connector.ts","webpack:///./src/components/BouncerField/connector.ts","webpack:///./src/components/EmitterField/index.ts","webpack:///./src/components/EmitterField/component.tsx","webpack:///./src/components/Emitter/index.ts","webpack:///./src/components/Emitter/component.tsx","webpack:///./src/components/RadialSvgSlider/index.ts","webpack:///./src/components/RadialSvgSlider/component.tsx","webpack:///./src/components/AngleSvgSlider/component.tsx","webpack:///./src/components/Emitter/connector.ts","webpack:///./src/components/EmitterField/connector.ts","webpack:///./src/components/GravityDirectionSlider/index.ts","webpack:///./src/components/GravityDirectionSlider/connector.ts","webpack:///./src/services/boing/selectors/field.tsx","webpack:///./src/components/ResetButton/index.ts","webpack:///./src/components/ResetButton/component.tsx","webpack:///./src/components/ResetButton/connector.ts","webpack:///./src/components/PlayButton/index.ts","webpack:///./src/components/PlayButton/component.tsx","webpack:///./src/components/Game/connector.ts"],"names":["math_1","__webpack_require__","time_1","exports","defaultBallState","Object","freeze","position","VEC_ZERO","velocity","defaultEmitterState","rate","lastEmit","defaultBouncerState","toneTriggerTimestamp","defaultBoingServiceState","tick","gravity","x","y","SECOND_AS_MILLIS","fieldMin","fieldMax","ballsById","emittersById","a","__assign","id","bouncersById","b","p1","p2","dotProduct","determinate","pointInRange","p","minX","Math","min","maxX","max","minY","maxY","isVector2","val","VEC_X","constrain","add","subtract","scale","scaler","length","sqrt","magnitude","angle","det","dot","atan2","vector","cos","sin","intercept","am","ab","bm","bb","Number","isFinite","__export","ACTION_TICK","millis","type","payload","millisElapsed","isTickAction","action","identities","collection","keys","values","map","theme","pixelsPerMeter","default","ACTION_RESET","reset","isResetAction","ACTION_CREATE_BOUNCER","createBouncer","isCreateBouncerAction","ACTION_MOVE_EMITTER","moveEmitter","isMoveEmitterAction","ACTION_MOVE_BOUNCER","moveBouncer","isMoveBouncerAction","ACTION_SET_EMITTER_RATE","setEmitterRate","isSetEmitterRateAction","ACTION_SET_EMITTER_DIRECTION","setEmitterDirection","isSetEmitterDirectionAction","ACTION_SET_SIZE","setSize","isSetSizeAction","ACTION_SET_GRAVITY_DIRECTION","setGravityDirection","isSetGravityDirectionAction","ACTION_SET_GRAVITY_POWER","setGravityStrength","strength","isSetGravityStrengthAction","tone_1","__importDefault","context","lookAhead","synth","init","start","window","testSynth","AMSynth","toMaster","PolySynth","tone","time","triggerAttackRelease","React","__importStar","onDragComplete","onMove","shouldCapture","_a","__read","useState","mouseDown","setMouseDown","_b","mouseMove","setMouseMove","pointerDown","useCallback","e","target","clientX","clientY","currentTarget","setPointerCapture","pointerId","preventDefault","stopPropagation","pointerMove","ev","dX","dY","pointerUp","releasePointerCapture","end","ballsByIdSelector","state","services","boing","component_1","bouncersByIdSelector","emittersByIdSelector","ReactDOM","root_1","rootEl","document","getElementById","render","createElement","content","module","i","options","hmr","transform","insertInto","undefined","locals","push","ThemeProvider_1","StoreProvider_1","App_1","react_jss_1","theme_1","children","ThemeProvider","Fragment","react_redux_1","store_1","Provider","store","redux_1","redux_saga_1","reducer_1","saga_1","devtool_sanitizer_1","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","actionSanitizer","stateSanitizer","actionsBlacklist","compose","sagaMiddleware","createStore","applyMiddleware","run","state_1","servicesReducer","combineReducers","defaultAppState","reduce_reducers_1","tick_1","reset_1","tick_emitters_1","tick_balls_1","create_bouncer_1","move_emitter_1","move_bouncer_1","set_emitter_rate_1","set_emitter_velocity_1","set_size_1","set_gravity_1","childReducers","v4_1","identity_1","_d","__values","_e","next","done","emitterId","value","emitter","newBallId","_c","lodash_1","fp_1","utils_1","reduce","ballId","ball","unset","movementLine","movementVec","interceptData","line","intercepts","bouncer","bouncerId","filter","isNotNull","first","interceptBouncer","intercept_1","bouncerVec","interceptAngle","lineAngle","bounceAngle","PI","reflect","abs","bouncerState","Date","now","set","ballState","tickBall","newEmitter","newBouncer","size","angle_1","effects_1","fork","sent","FIXED_TIME","onTick","elapsedMillis","put","takeEvery","delayMillis","previous","eventChannel","iv","setInterval","current","elapsed","clearInterval","Game_1","styles","createStyles","game","width","height","classes","className","connector_1","component_size_1","use_pointer_drag_1","BallField_1","BouncerField_1","EmitterField_1","GravityDirectionSlider_1","ResetButton_1","PlayButton_1","svg","touchAction","onCreateBouncer","onResize","started","setStarted","rootRef","useRef","svgRef","onStart","createBouncerDragRelease","oldSize","setOldSize","ref","viewBox","onPointerDown","onPointerMove","onPointerUp","r","cx","cy","onClick","x1","y1","x2","y2","stroke","opacity","fill","Ball_1","ballIds","key","balls_1","connect","props","pick","Bouncer_1","bouncerIds","DragHandle_1","MouseReveal_1","TONE_MIN","TONE_MAX","LENGTH_MIN","LENGTH_MAX","lastTone","setLastTone","l","onP1Move","onP2Move","center","onCenterMove","pt","movement","originVec","revealDistance","onDrag","rect","cursor","isMoving","setMoving","use_mouse_distance_1","originRef","console","warn","mouseInRange","setMouseInRange","onMouseDistance","useMouseDistance","onMouseDistanceChanged","useEffect","onMouseMove","origin","getBoundingClientRect","left","top","vec","addEventListener","removeEventListener","bouncers_1","dispatch","Emitter_1","emitterIds","RadialSvgSlider_1","AngleSvgSlider_1","circle","onSetRate","onSetDirection","onDragMove","dragMove","onChange","handle","startAngle","endAngle","range","generatePath","join","generateHandlePath","percent","handleRef","isPointerDown","setPointerDown","onHandlePointerDown","onHandlePointerMove","box","handleVec","handleAngle","valueAngle","onHandlePointerUp","d","strokeWidth","emitters_1","field_1","mapDispatchToProps","gravityDirectionSelector","gravitySelector","button","xmlns","log"],"mappings":"qXAAA,IAAAA,EAAAC,EAAA,GACAC,EAAAD,EAAA,KAOaE,EAAAC,iBAAmBC,OAAOC,OAAO,CAC5CC,SAAUP,EAAAQ,SACVC,SAAUT,EAAAQ,WAUCL,EAAAO,oBAAsBL,OAAOC,OAAO,CAC/CC,SAAUP,EAAAQ,SACVG,KAAM,IACNF,SAAUT,EAAAQ,SACVI,SAAU,IAOCT,EAAAU,oBAAsBR,OAAOC,OAAO,CAC/CQ,qBAAsB,IAaXX,EAAAY,yBAETV,OAAOC,OAAO,CAChBU,KAAM,EACNC,QAAS,CAAEC,EAAG,EAAGC,EAAG,IAAMjB,EAAAkB,kBAC1BC,SAAU,CAAEH,EAAG,EAAGC,EAAG,GACrBG,SAAU,CAAEJ,EAAG,IAAMC,EAAG,KACxBI,UAAW,GACXC,aAAc,CACZC,EAACC,EAAA,GACIvB,EAAAO,oBAAmB,CACtBiB,GAAI,IACJpB,SAAU,CAAEW,EAAG,IAAKC,EAAG,KACvBV,SAAU,CAAES,EAAG,EAAGC,EAAG,GACrBR,KAAM,OAGViB,aAAc,CACZC,EAACH,EAAA,GACIvB,EAAAU,oBAAmB,CACtBc,GAAI,IACJG,GAAI,CACFZ,EAAG,GACHC,EAAG,KAELY,GAAI,CACFb,EAAG,IACHC,EAAG,wCCnBX,SAAgBa,EAAWP,EAAsBI,GAC/C,OAAOJ,EAAEP,EAAIW,EAAEX,EAAIO,EAAEN,EAAIU,EAAEV,EAG7B,SAAgBc,EAAYR,EAAsBI,GAChD,OAAOJ,EAAEP,EAAIW,EAAEV,EAAIM,EAAEN,EAAIU,EAAEX,EAiF7B,SAASgB,EACPC,EACAV,EACAI,GAEA,IAAMO,EAAOC,KAAKC,IAAIb,EAAEP,EAAGW,EAAEX,GACvBqB,EAAOF,KAAKG,IAAIf,EAAEP,EAAGW,EAAEX,GACvBuB,EAAOJ,KAAKC,IAAIb,EAAEN,EAAGU,EAAEV,GACvBuB,EAAOL,KAAKG,IAAIf,EAAEN,EAAGU,EAAEV,GAC7B,OAAOgB,EAAEjB,GAAKkB,GAAQD,EAAEjB,GAAKqB,GAAQJ,EAAEhB,GAAKsB,GAAQN,EAAEhB,GAAKuB,mDAhJ7DvC,EAAAwC,UAAA,SAA0BC,GACxB,MAAwB,iBAAVA,EAAI1B,GAAmC,iBAAV0B,EAAIzB,GAUpChB,EAAAK,SAA8BH,OAAOC,OAAO,CAAEY,EAAG,EAAGC,EAAG,IACvDhB,EAAA0C,MAA2BxC,OAAOC,OAAO,CAAEY,EAAG,EAAGC,EAAG,IAEjEhB,EAAA2C,UAAA,SAA0B5B,EAAWoB,EAAaE,GAChD,OAAOH,KAAKC,IAAID,KAAKG,IAAItB,EAAGoB,GAAME,IAGpCrC,EAAA4C,IAAA,SAAoBtB,EAAsBI,GACxC,MAAO,CACLX,EAAGO,EAAEP,EAAIW,EAAEX,EACXC,EAAGM,EAAEN,EAAIU,EAAEV,IAIfhB,EAAA6C,SAAA,SAAyBvB,EAAsBI,GAC7C,MAAO,CACLX,EAAGO,EAAEP,EAAIW,EAAEX,EACXC,EAAGM,EAAEN,EAAIU,EAAEV,IAIfhB,EAAA8C,MAAA,SAAsBxB,EAAsByB,GAC1C,MAAO,CACLhC,EAAGO,EAAEP,EAAIgC,EACT/B,EAAGM,EAAEN,EAAI+B,IAIb/C,EAAAgD,OAAA,SAAuB1B,GACrB,IAAMP,EAAIO,EAAEK,GAAGZ,EAAIO,EAAEM,GAAGb,EAClBC,EAAIM,EAAEK,GAAGX,EAAIM,EAAEM,GAAGZ,EACxB,OAAOkB,KAAKe,KAAKlC,EAAIA,EAAIC,EAAIA,IAG/BhB,EAAAkD,UAAA,SAA0B5B,GACxB,OAAOY,KAAKe,KAAK3B,EAAEP,EAAIO,EAAEP,EAAIO,EAAEN,EAAIM,EAAEN,IAGvChB,EAAA6B,aAIA7B,EAAA8B,cAIA9B,EAAAmD,MAAA,SAAsB7B,EAAsBI,GAU1C,IAAM0B,EAAMtB,EAAYR,EAAGI,GACrB2B,EAAMxB,EAAWP,EAAGI,GAC1B,OAAOQ,KAAKoB,MAAMF,EAAKC,IAGzBrD,EAAAuD,OAAA,SAAuBJ,EAAeD,GACpC,MAAO,CACLnC,EAAGmC,EAAYhB,KAAKsB,IAAIL,GACxBnC,EAAGkC,EAAYhB,KAAKuB,IAAIN,KAI5BnD,EAAA0D,UAAA,SACEpC,EACAI,GAaA,IAWIX,EAAWC,EAXT2C,GAAMrC,EAAEM,GAAGZ,EAAIM,EAAEK,GAAGX,IAAMM,EAAEM,GAAGb,EAAIO,EAAEK,GAAGZ,GACxC6C,EAAKtC,EAAEK,GAAGX,EAAI2C,EAAKrC,EAAEK,GAAGZ,EAExB8C,GAAMnC,EAAEE,GAAGZ,EAAIU,EAAEC,GAAGX,IAAMU,EAAEE,GAAGb,EAAIW,EAAEC,GAAGZ,GACxC+C,EAAKpC,EAAEC,GAAGX,EAAI6C,EAAKnC,EAAEC,GAAGZ,EAE9B,GAAI8C,EAAKF,GAAO,EAEd,OAAO,KAIJI,OAAOC,SAASL,GAITI,OAAOC,SAASH,GAM1B7C,EAAI2C,GADJ5C,GAAK6C,EAAKE,IAAOD,EAAKF,IACTC,GAJb5C,EAAI2C,EAAKjC,EAAEC,GAAGZ,EAAI6C,EAClB7C,EAAIW,EAAEC,GAAGZ,IALTC,EAAI6C,EAAKvC,EAAEK,GAAGZ,EAAI+C,EAClB/C,EAAIO,EAAEK,GAAGZ,GAUX,IAAM2C,EAAqB,CACzB3C,EAACA,EACDC,EAACA,GAIH,OAAKe,EAAa2B,EAAWpC,EAAEK,GAAIL,EAAEM,KAGhCG,EAAa2B,EAAWhC,EAAEC,GAAID,EAAEE,IAI9B8B,EANE,uJClIXO,EAAAnE,EAAA,KACAmE,EAAAnE,EAAA,0FCCaE,EAAAkE,YAAc,aACdlE,EAAAa,KAAO,SAACsD,GAAmB,OACtCC,KAAMpE,EAAAkE,YACNG,QAAS,CAAEC,cAAeH,KAG5BnE,EAAAuE,aAAA,SAA6BC,GAC3B,OAAOA,EAAOJ,OAASpE,EAAAkE,4FCDzBlE,EAAAyE,WAAA,SAA2BC,GACzB,OAAOxE,OAAOyE,KAAKD,IAErB1E,EAAA4E,OAAA,SACEF,GAEA,OAAOxE,OAAOyE,KAAKD,GAAYG,IAAI,SAAArD,GAAM,OAAAkD,EAAWlD,6GCdtD,IAEMsD,EAAQ,CACZC,eAAgB,IAElB/E,EAAAgF,QAAeF,iFCHF9E,EAAAiF,aAAe,cACfjF,EAAAkF,MAAQ,WAAM,OACzBd,KAAMpE,EAAAiF,eAGRjF,EAAAmF,cAAA,SAA8BX,GAC5B,OAAOA,EAAOJ,OAASpE,EAAAiF,+FCJZjF,EAAAoF,sBAAwB,uBACxBpF,EAAAqF,cAAgB,SAAC1D,EAAaC,GAAgB,OACzDwC,KAAMpE,EAAAoF,sBACNf,QAAS,CAAE1C,GAAEA,EAAEC,GAAEA,KAGnB5B,EAAAsF,sBAAA,SACEd,GAEA,OAAOA,EAAOJ,OAASpE,EAAAoF,sGCXZpF,EAAAuF,oBAAsB,qBACtBvF,EAAAwF,YAAc,SAAChE,EAAYT,EAAWC,GAAc,OAC/DoD,KAAMpE,EAAAuF,oBACNlB,QAAS,CAAE7C,GAAEA,EAAET,EAACA,EAAEC,EAACA,KAGrBhB,EAAAyF,oBAAA,SACEjB,GAEA,OAAOA,EAAOJ,OAASpE,EAAAuF,oGCPZvF,EAAA0F,oBAAsB,qBACtB1F,EAAA2F,YAAc,SAACnE,EAAYG,EAAaC,GAAgB,OACnEwC,KAAMpE,EAAA0F,oBACNrB,QAAS,CAAE7C,GAAEA,EAAEG,GAAEA,EAAEC,GAAEA,KAGvB5B,EAAA4F,oBAAA,SACEpB,GAEA,OAAOA,EAAOJ,OAASpE,EAAA0F,oGCXZ1F,EAAA6F,wBAA0B,yBAC1B7F,EAAA8F,eAAiB,SAACtE,EAAYhB,GAAiB,OAC1D4D,KAAMpE,EAAA6F,wBACNxB,QAAS,CAAE7C,GAAEA,EAAEhB,KAAIA,KAGrBR,EAAA+F,uBAAA,SACEvB,GAEA,OAAOA,EAAOJ,OAASpE,EAAA6F,wGCTZ7F,EAAAgG,6BAA+B,8BAC/BhG,EAAAiG,oBAAsB,SAACzE,EAAY2B,GAAkB,OAChEiB,KAAMpE,EAAAgG,6BACN3B,QAAS,CAAE7C,GAAEA,EAAE2B,MAAKA,KAGtBnD,EAAAkG,4BAAA,SACE1B,GAEA,OAAOA,EAAOJ,OAASpE,EAAAgG,6GCTZhG,EAAAmG,gBAAkB,iBAClBnG,EAAAoG,QAAU,SAACrF,EAAWC,GAAc,OAC/CoD,KAAMpE,EAAAmG,gBACN9B,QAAS,CAAEtD,EAACA,EAAEC,EAACA,KAGjBhB,EAAAqG,gBAAA,SAAgC7B,GAC9B,OAAOA,EAAOJ,OAASpE,EAAAmG,gGCPZnG,EAAAsG,6BAA+B,8BAC/BtG,EAAAuG,oBAAsB,SAACpD,GAAkB,OACpDiB,KAAMpE,EAAAsG,6BACNjC,QAAS,CAAElB,MAAKA,KAGlBnD,EAAAwG,4BAAA,SACEhC,GAEA,OAAOA,EAAOJ,OAASpE,EAAAsG,8BAGZtG,EAAAyG,yBAA2B,0BAC3BzG,EAAA0G,mBAAqB,SAACC,GAAqB,OACtDvC,KAAMpE,EAAAyG,yBACNpC,QAAS,CAAEsC,SAAQA,KAGrB3G,EAAA4G,2BAAA,SACEpC,GAEA,OAAOA,EAAOJ,OAASpE,EAAAyG,6LCvBzB,IAAAI,EAAAC,EAAAhH,EAAA,MAKA+G,EAAA7B,QAAK+B,QAAQC,UAAY,EAEzB,IAAIC,EAAa,KACjBjH,EAAAkH,KAAA,WACEL,EAAA7B,QAAKmC,QACJC,OAAeC,WAAY,IAAIR,EAAA7B,QAAKsC,SAAUC,WAC/CN,EAAQ,IAAIJ,EAAA7B,QAAKwC,UAAU,EAAGX,EAAA7B,QAAKsC,SAASC,YAG9CvH,EAAAgF,QAAA,SAAiCyC,EAAcC,GACxCT,GAGLA,EAAMU,qBAAqBF,EAAMC,6iBClBnC,IAAAE,EAAAC,EAAA/H,EAAA,IAyBAE,EAAAgF,QAAA,SACE8C,EACAC,EACAC,GAEM,IAAAC,EAAAC,EAAAN,EAAAO,SAAA,SAACC,EAAAH,EAAA,GAAWI,EAAAJ,EAAA,GACZK,EAAAJ,EAAAN,EAAAO,SAAA,SAACI,EAAAD,EAAA,GAAWE,EAAAF,EAAA,GAEZG,EAAcb,EAAMc,YAAY,SAACC,GACjCX,IAAkBA,EAAcW,EAAEC,UAItCP,EAAa,CAAEtH,EAAG4H,EAAEE,QAAS7H,EAAG2H,EAAEG,UAClCH,EAAEI,cAAcC,kBAAkBL,EAAEM,WAEpCN,EAAEO,iBACFP,EAAEQ,oBACD,IAEGC,EAAcxB,EAAMc,YACxB,SAACC,GACC,GAAKP,EAAL,CAIA,GAAIL,EAAQ,CACV,IAAMsB,EAAgB,CACpBlC,MAAO,CACL0B,QAAST,EAAUrH,EACnB+H,QAASV,EAAUpH,GAErB6H,QAASF,EAAEE,QACXC,QAASH,EAAEG,QACXQ,GAAIX,EAAEE,QAAUT,EAAUrH,EAC1BwI,GAAIZ,EAAEG,QAAUV,EAAUpH,GAE5B+G,EAAOsB,GAGTb,EAAa,CAAEzH,EAAG4H,EAAEE,QAAS7H,EAAG2H,EAAEG,UAElCH,EAAEO,mBAEJ,CAACd,EAAWL,IAGRyB,EAAY5B,EAAMc,YACtB,SAACC,GAGC,GAFAA,EAAEI,cAAcU,sBAAsBd,EAAEM,WAEpCb,EAAW,CACb,GAAIN,EAAgB,CAClB,IAAMuB,EAAgB,CACpBlC,MAAO,CACL0B,QAAST,EAAUrH,EACnB+H,QAASV,EAAUpH,GAErB6H,QAASF,EAAEE,QACXC,QAASH,EAAEG,QACXQ,GAAIX,EAAEE,QAAUT,EAAUrH,EAC1BwI,GAAIZ,EAAEG,QAAUV,EAAUpH,GAE5B8G,EAAeuB,GAGjBhB,EAAa,MACbG,EAAa,MAEbG,EAAEO,iBACFP,EAAEQ,oBAGN,CAACrB,EAAgBM,IAGnB,MAAO,CACLjB,MAAOiB,EAAY,CAAES,QAAST,EAAUrH,EAAG+H,QAASV,EAAUpH,GAAM,KACpE0I,IAAKnB,EAAY,CAAEM,QAASN,EAAUxH,EAAG+H,QAASP,EAAUvH,GAAM,KAClEyH,YAAWA,EACXW,YAAWA,EACXI,UAASA,mFCxGAxJ,EAAA2J,kBAAoB,SAACC,GAChC,OAAAA,EAAMC,SAASC,MAAM1I,8KCHvB,IAAA2I,EAAAjD,EAAAhH,EAAA,MACAE,EAAAgF,QAAe+E,EAAA/E,uFCCFhF,EAAAgK,qBAAuB,SAACJ,GACnC,OAAAA,EAAMC,SAASC,MAAMrI,iLCHvB,IAAAsI,EAAAjD,EAAAhH,EAAA,MACAE,EAAAgF,QAAe+E,EAAA/E,uFCCFhF,EAAAiK,qBAAuB,SAACL,GACnC,OAAAA,EAAMC,SAASC,MAAMzI,gYCHvBvB,EAAA,IACAA,EAAA,IAEAA,EAAA,IAEA,IAAA8H,EAAAC,EAAA/H,EAAA,IACAoK,EAAArC,EAAA/H,EAAA,KAEAqK,EAAArD,EAAAhH,EAAA,KAEMsK,EAASC,SAASC,eAAe,QACnCF,GACFF,EAASK,OAAO3C,EAAA4C,cAACL,EAAAnF,QAAI,MAAKoF,wBCX5B,IAAAK,EAAc3K,EAAQ,IAEtB,iBAAA2K,MAAA,EAA4CC,EAAAC,EAASF,EAAA,MAOrD,IAAAG,EAAA,CAAeC,KAAA,EAEfC,eAPAA,EAQAC,gBAAAC,GAEalL,EAAQ,GAARA,CAAwD2K,EAAAG,GAErEH,EAAAQ,SAAAP,EAAA1K,QAAAyK,EAAAQ,0BCjBAP,EAAA1K,QAA2BF,EAAQ,GAARA,EAAwD,IAEnFoL,KAAA,CAAcR,EAAAC,EAAS,sZAAkZ,yVCFza,IAAA/C,EAAAC,EAAA/H,EAAA,IAEAqL,EAAArE,EAAAhH,EAAA,KACAsL,EAAAtE,EAAAhH,EAAA,MAEAuL,EAAAvE,EAAAhH,EAAA,MAUAE,EAAAgF,QARuB,WAAM,OAC3B4C,EAAA4C,cAACW,EAAAnG,QAAa,KACZ4C,EAAA4C,cAACY,EAAApG,QAAa,KACZ4C,EAAA4C,cAACa,EAAArG,QAAG,qVCVV,IAAA4C,EAAAC,EAAA/H,EAAA,IAEAwL,EAAAxL,EAAA,IAEAyL,EAAAzE,EAAAhH,EAAA,KAQAE,EAAAgF,QANgC,SAACiD,OAAEuD,EAAAvD,EAAAuD,SAAe,OAChD5D,EAAA4C,cAACc,EAAAG,cAAW,CAAC3G,MAAOyG,EAAAvG,SAClB4C,EAAA4C,cAAA5C,EAAA8D,SAAA,KAAGF,+XCRP,IAAA5D,EAAAC,EAAA/H,EAAA,IAEA6L,EAAA7L,EAAA,GAEA8L,EAAA9E,EAAAhH,EAAA,MAKAE,EAAAgF,QAHgC,SAACiD,OAAEuD,EAAAvD,EAAAuD,SAAe,OAChD5D,EAAA4C,cAACmB,EAAAE,SAAQ,CAACC,MAAOF,EAAA5G,SAAQwG,wKCP3B,IAAAO,EAAAjM,EAAA,IAMAkM,EAAAlF,EAAAhH,EAAA,KAEAmM,EAAAnF,EAAAhH,EAAA,MACAoM,EAAApF,EAAAhH,EAAA,MAEAqM,EAAArM,EAAA,KA0BA,IAAMgM,EApBN,WACE,IAAMM,EACHhF,OAAOiF,sCACNjF,OAAOiF,qCAAqC,CAC1CC,gBAAeH,EAAAG,gBACfC,eAAcJ,EAAAI,eACdC,iBAAgBL,EAAAK,oBAEpBT,EAAAU,QAEIC,EAAiBV,EAAAhH,UAEjB8G,EAAQC,EAAAY,YACZV,EAAAjH,QACAoH,EAAiBL,EAAAa,gBAAgBF,KAGnC,OADAA,EAAeG,IAAIX,EAAAlH,SACZ8G,EAGKa,GACd3M,EAAAgF,QAAe8G,qKCtCf,IAAAC,EAAAjM,EAAA,IAEAgN,EAAAhN,EAAA,KAEAmM,EAAAnF,EAAAhH,EAAA,MAEMiN,EAAkBhB,EAAAiB,gBAAgB,CACtClD,MAAOmC,EAAAjH,UAGThF,EAAAgF,QAAA,SACE4E,EACApF,GAEA,YAHA,IAAAoF,MAAkBkD,EAAAG,iBAGX,CACLpD,SAAUkD,EAAgBnD,EAAMC,SAAUrF,oFCf9C,IAAAsI,EAAAhN,EAAA,GAWaE,EAAAiN,gBAAsC/M,OAAOC,OAAO,CAC/D0J,SAAU,CACRC,MAAOgD,EAAAlM,2GCbEZ,EAAAiB,iBAAmB,2YCAhC,IAAAiM,EAAApG,EAAAhH,EAAA,MAGAgN,EAAAhN,EAAA,GAEAqN,EAAArN,EAAA,IAEAsN,EAAAtG,EAAAhH,EAAA,MACAuN,EAAAvG,EAAAhH,EAAA,MACAwN,EAAAxG,EAAAhH,EAAA,MACAyN,EAAAzG,EAAAhH,EAAA,MACA0N,EAAA1G,EAAAhH,EAAA,MACA2N,EAAA3G,EAAAhH,EAAA,MACA4N,EAAA5G,EAAAhH,EAAA,MACA6N,EAAA7G,EAAAhH,EAAA,MACA8N,EAAA9G,EAAAhH,EAAA,MACA+N,EAAA/G,EAAAhH,EAAA,MAEMgO,EAAgBZ,EAAAlI,QACpBoI,EAAApI,QACAqI,EAAArI,QACAsI,EAAAtI,QACAuI,EAAAvI,QACAwI,EAAAxI,QACAyI,EAAAzI,QACA0I,EAAA1I,QACA2I,EAAA3I,QACA4I,EAAA5I,QACA6I,EAAA7I,SAGFhF,EAAAgF,QAAA,SACE4E,EACApF,GASA,YAVA,IAAAoF,MAA2BkD,EAAAlM,0BAGvBuM,EAAA5I,aAAaC,KACfoF,EAAKrI,EAAA,GACAqI,EAAK,CACR/I,KAAM+I,EAAM/I,KAAO2D,EAAOH,QAAQC,iBAI/BwJ,EAAclE,EAAOpF,oFCzC9B,IAAAsI,EAAAhN,EAAA,GACAsN,EAAAtN,EAAA,IAEAE,EAAAgF,QAAA,SACE4E,EACApF,GAEA,YAHA,IAAAoF,MAA2BkD,EAAAlM,0BAGvBwM,EAAAjI,cAAcX,GACTsI,EAAAlM,yBAEFgJ,wkBCVT,IAAAmE,EAAAjH,EAAAhH,EAAA,KAEAgN,EAAAhN,EAAA,GAMAkO,EAAAlO,EAAA,IAGAqN,EAAArN,EAAA,IAEAE,EAAAgF,QAAA,SACE4E,EACApF,eAEA,QAHA,IAAAoF,MAA2BkD,EAAAlM,2BAGtBuM,EAAA5I,aAAaC,GAChB,OAAOoF,MAGT,IAAwB,IAAAqE,EAAAC,EAAAF,EAAAvJ,WAAWmF,EAAMvI,eAAa8M,EAAAF,EAAAG,QAAAD,EAAAE,KAAAF,EAAAF,EAAAG,OAAE,CAAnD,IAAME,EAASH,EAAAI,MACZC,EAAU5E,EAAMvI,aAAaiN,GACnC,GAAI1E,EAAM/I,KAAO2N,EAAQ/N,UAAY+N,EAAQhO,KAAM,CACjD,IAAMiO,EAAYV,EAAA/I,UAClB4E,EAAKrI,EAAA,GACAqI,EAAK,CACRvI,aAAYE,EAAA,GACPqI,EAAMvI,cAAYiH,EAAA,GAAAA,EACpBgG,GAAS/M,EAAA,GACLqI,EAAMvI,aAAaiN,GAAU,CAChC7N,SAAUmJ,EAAM/I,OAAIyH,IAGxBlH,UAASG,EAAA,GACJqI,EAAMxI,WAASsN,EAAA,GAAAA,EACjBD,GAASlN,EAAA,GACLuL,EAAA7M,iBAAgB,CACnBuB,GAAIiN,EACJrO,SAAUoO,EAAQpO,SAClBE,SAAUkO,EAAQlO,WAAQoO,yGAOpC,OAAO9E,4TC/CT,IAAA+E,EAAA7O,EAAA,IACA8O,EAAA9O,EAAA,IAEAD,EAAAC,EAAA,GAaA+O,EAAA/O,EAAA,KACAkO,EAAAlO,EAAA,IAEAgN,EAAAhN,EAAA,GAOAqN,EAAArN,EAAA,IAEAE,EAAAgF,QAAA,SACE4E,EACApF,GAEA,QAHA,IAAAoF,MAA2BkD,EAAAlM,2BAGtBuM,EAAA5I,aAAaC,GAChB,OAAOoF,EAGD,IAAAtF,EAAAE,EAAAH,QAAAC,cASR,OALAsF,EAFgBoE,EAAAvJ,WAAWmF,EAAMxI,WAEjB0N,OACd,SAAClF,EAAOpI,GAAO,OAOnB,SACEoI,EACAmF,EACAzK,GAEQ,IAAAxD,EAAA8I,EAAA9I,QAASI,EAAA0I,EAAA1I,SAAUC,EAAAyI,EAAAzI,SACrB6N,EAD+BpF,EAAAxI,UAClB2N,GAEfzO,EAAWT,EAAA+C,IAAIoM,EAAK1O,SAAUT,EAAAiD,MAAMhC,EAASwD,IAC7ClE,EAAWP,EAAA+C,IAAIoM,EAAK5O,SAAUE,GAElC,GACEF,EAASW,EAAIG,EAASH,GACtBX,EAASW,EAAII,EAASJ,GACtBX,EAASY,EAAIG,EAASH,EAEtB,OAAO4N,EAAAK,MAAM,CAAC,YAAaF,GAASnF,GAKtC,IAAMsF,EAAqB,CAAEvN,GAAIqN,EAAK5O,SAAUwB,GAAIxB,GAC9C+O,EAAuBtP,EAAAgD,SAASqM,EAAavN,GAAIuN,EAAatN,IAC9DwN,EA0CR,SACEC,EACAzF,GAEA,IAAM0F,EAAatB,EAAApJ,OAAOgF,EAAMnI,cAC7BoD,IAAI,SAAA0K,GACH,IAAM5E,EAAI9K,EAAA6D,UAAU2L,EAAME,GAC1B,OAAI5E,EACK,CACL6E,UAAWD,EAAQ/N,GACnBkC,UAAWiH,GAGR,OAER8E,OAAOZ,EAAAa,WACV,OAAOf,EAAAgB,MAAML,IAAe,KA1DNM,CAAiBV,EAActF,GAErD,GAAIwF,EAAe,CACT,IAAAI,EAAAJ,EAAAI,UAAWK,EAAAT,EAAA1L,UACb6L,EAAU3F,EAAMnI,aAAa+N,GAC7BM,EAAajQ,EAAAgD,SAAS0M,EAAQ3N,GAAI2N,EAAQ5N,IAE1CoO,EAAiBlQ,EAAAsD,MAAM2M,EAAYX,GACnCa,EAAYnQ,EAAAsD,MAAMtD,EAAA6C,MAAOoN,GACzBG,EAAcD,GAAa9N,KAAKgO,GAAKH,GAEvCI,EAAUjO,KAAKkO,IACjBvQ,EAAAmD,OAAOkM,GAAgBrP,EAAAmD,OAAO,CAAErB,GAAIqN,EAAK5O,SAAUwB,GAAIiO,KAEzDM,EAAUjO,KAAKG,IAAI8N,EAAS,GAE5B/P,EAAWP,EAAA+C,IAAIiN,EAAWhQ,EAAA0D,OAAO0M,EAAaE,IAC9C7P,EAAWT,EAAA0D,OAAO0M,EAAapQ,EAAAqD,UAAU5C,IAEzC,IAAM+P,EAAY9O,EAAA,GACbgO,EAAO,CACV5O,qBAAsB2P,KAAKC,QAE7BrQ,OAAOC,OAAOkQ,GACdnQ,OAAOC,OAAOkQ,EAAa1O,IAC3BzB,OAAOC,OAAOkQ,EAAazO,IAE3BgI,EAAQgF,EAAA4B,IAAI,CAAC,eAAgBhB,GAAYa,EAAczG,GAGzD,IAAM6G,EAASlP,EAAA,GACVyN,EAAI,CACP5O,SAAQA,EACRE,SAAQA,IAMV,OAJAJ,OAAOC,OAAOsQ,GAEd7G,EAAQgF,EAAA4B,IAAI,CAAC,YAAazB,GAAS0B,EAAW7G,GAnE7B8G,CAAS9G,EAAOpI,EAAI8C,IACnCsF,uFC3CJ5J,EAAA0P,UAAA,SAA6BjN,GAC3B,OAAc,MAAPA,0YCAT,IAAAsL,EAAAjH,EAAAhH,EAAA,KAEAgN,EAAAhN,EAAA,GAMAyN,EAAAzN,EAAA,IAEAE,EAAAgF,QAAA,SACE4E,EACApF,SAEA,QAHA,IAAAoF,MAA2BkD,EAAAlM,2BAGtB2M,EAAAjI,sBAAsBd,GACzB,OAAOoF,EAGH,IAAAtB,EAAA9D,EAAAH,QAAE1C,EAAA2G,EAAA3G,GAAIC,EAAA0G,EAAA1G,GACNJ,EAAKuM,EAAA/I,UAEX,OAAAzD,EAAA,GACKqI,EAAK,CACRnI,aAAYF,EAAA,GACPqI,EAAMnI,cAAYwG,EAAA,GAAAA,EACpBzG,GAAED,EAAA,GACEuL,EAAApM,oBAAmB,CACtBc,GAAEA,EACFG,GAAEA,EACFC,GAAEA,IAAAqG,8TC7BV,IAAA2G,EAAA9O,EAAA,IAEAgN,EAAAhN,EAAA,GAMA0N,EAAA1N,EAAA,IAEAE,EAAAgF,QAAA,SACE4E,EACApF,GAEA,QAHA,IAAAoF,MAA2BkD,EAAAlM,2BAGtB4M,EAAA/H,oBAAoBjB,GACvB,OAAOoF,EAGH,IAAA3B,EAAAzD,EAAAH,QAAE7C,EAAAyG,EAAAzG,GAAIT,EAAAkH,EAAAlH,EAAGC,EAAAiH,EAAAjH,EAETwN,EAAU5E,EAAMvI,aAAaG,GACnC,IAAKgN,EACH,OAAO5E,EAGT,IAAM+G,EAAUpP,EAAA,GACXiN,EAAO,CACVpO,SAAU,CAAEW,EAACA,EAAEC,EAACA,KAGlB,OAAO4N,EAAA4B,IAAI,CAAC,eAAgBhP,GAAKmP,EAAY/G,2TC9B/C,IAAAgF,EAAA9O,EAAA,IAEAgN,EAAAhN,EAAA,GAMA2N,EAAA3N,EAAA,IAEAE,EAAAgF,QAAA,SACE4E,EACApF,GAEA,QAHA,IAAAoF,MAA2BkD,EAAAlM,2BAGtB6M,EAAA7H,oBAAoBpB,GACvB,OAAOoF,EAGH,IAAA3B,EAAAzD,EAAAH,QAAE7C,EAAAyG,EAAAzG,GAAIG,EAAAsG,EAAAtG,GAAIC,EAAAqG,EAAArG,GAEV2N,EAAU3F,EAAMnI,aAAaD,GACnC,IAAK+N,EACH,OAAO3F,EAGT,IAAMgH,EAAUrP,EAAA,GACXgO,EAAO,CACV5N,GAAEA,EACFC,GAAEA,IAGJ,OAAOgN,EAAA4B,IAAI,CAAC,eAAgBhP,GAAKoP,EAAYhH,2TC/B/C,IAAAgF,EAAA9O,EAAA,IAEAgN,EAAAhN,EAAA,GAKA4N,EAAA5N,EAAA,IAEAE,EAAAgF,QAAA,SACE4E,EACApF,GAEA,QAHA,IAAAoF,MAA2BkD,EAAAlM,2BAGtB8M,EAAA3H,uBAAuBvB,GAC1B,OAAOoF,EAGH,IAAA3B,EAAAzD,EAAAH,QAAE7C,EAAAyG,EAAAzG,GAAIhB,EAAAyH,EAAAzH,KAENgO,EAAU5E,EAAMvI,aAAaG,GACnC,IAAKgN,EACH,OAAO5E,EAGT,IAAM+G,EAAUpP,EAAA,GACXiN,EAAO,CACVhO,KAAIA,IAGN,OAAOoO,EAAA4B,IAAI,CAAC,eAAgBhP,GAAKmP,EAAY/G,2TC7B/C,IAAAgF,EAAA9O,EAAA,IAEAgN,EAAAhN,EAAA,GAKA6N,EAAA7N,EAAA,IACAD,EAAAC,EAAA,GAEAE,EAAAgF,QAAA,SACE4E,EACApF,GAEA,QAHA,IAAAoF,MAA2BkD,EAAAlM,0BAGvB+M,EAAAzH,4BAA4B1B,GAAS,CACjC,IAAAyD,EAAAzD,EAAAH,QAAE7C,EAAAyG,EAAAzG,GAAI2B,EAAA8E,EAAA9E,MACNqL,EAAU5E,EAAMvI,aAAaG,GACnC,IAAKgN,EACH,OAAO5E,EAET,IAAM+G,EAAUpP,EAAA,GACXiN,EAAO,CACVlO,SAAUT,EAAA0D,OAAOJ,EAAOtD,EAAAqD,UAAUsL,EAAQlO,aAE5C,OAAOsO,EAAA4B,IAAI,CAAC,eAAgBhP,GAAKmP,EAAY/G,GAG/C,OAAOA,0TC1BT,IAAAkD,EAAAhN,EAAA,GAEA8N,EAAA9N,EAAA,IAEAE,EAAAgF,QAAA,SACE4E,EACApF,GAEA,QAHA,IAAAoF,MAA2BkD,EAAAlM,2BAGtBgN,EAAAvH,gBAAgB7B,GACnB,OAAOoF,EAGT,IAAMiH,EAAOrM,EAAOH,QAEpB,OAAA9C,EAAA,GACKqI,EAAK,CACRzI,SAAU0P,4TCjBd,IAAAhR,EAAAC,EAAA,GAEAgN,EAAAhN,EAAA,GACA+N,EAAA/N,EAAA,IAKAE,EAAAgF,QAAA,SACE4E,EACApF,GAEA,QAHA,IAAAoF,MAA2BkD,EAAAlM,0BAGvBiN,EAAArH,4BAA4BhC,GAAS,CAC/B,IAAAsM,EAAAtM,EAAAH,QAAAlB,MACR,OAAA5B,EAAA,GACKqI,EAAK,CACR9I,QAASjB,EAAA0D,OAAOuN,EAAOjR,EAAAqD,UAAU0G,EAAM9I,YAI3C,GAAI+M,EAAAjH,2BAA2BpC,GAAS,CAC9B,IAAAmC,EAAAnC,EAAAH,QAAAsC,SACR,OAAApF,EAAA,GACKqI,EAAK,CACR9I,QAASjB,EAAA0D,OAAO1D,EAAAsD,MAAMtD,EAAA6C,MAAOkH,EAAM9I,SAAU6F,KAIjD,OAAOiD,quCC7BT,IAAAmH,EAAAjR,EAAA,IAEAoM,EAAApF,EAAAhH,EAAA,MAEAE,EAAAgF,QAAA,4DACE,SAAM+L,EAAAC,KAAK9E,EAAAlH,wBAAXiD,EAAAgJ,kLCLF,IAAA9D,EAAArG,EAAAhH,EAAA,MAEAE,EAAAgF,QAAemI,EAAAnI,0pCCFf,IAAAgH,EAAAlM,EAAA,IACAiR,EAAAjR,EAAA,IAEAqN,EAAArN,EAAA,IAIMoR,GAAa,EAMnB,SAAUC,EAAOC,oDACf,SAAML,EAAAM,IAAIlE,EAAAtM,KAAKuQ,mBAAfnJ,EAAAgJ,cALFjR,EAAAgF,QAAA,4DACE,SAAM+L,EAAAO,WAOUC,EAPS,GAQrBC,EAAWlB,KAAKC,MACbvE,EAAAyF,aAAa,SAAAjD,GAClB,IAAMkD,EAAKC,YAAY,WACrB,IAAMC,EAAUtB,KAAKC,MACfsB,EAAUD,EAAUJ,EAC1BhD,EAAQ0C,EAAa,GAAKW,IAEzBN,GACH,OAAO,WACLO,cAAcJ,OAjBYP,kBAA9BlJ,EAAAgJ,WAOF,IAAkBM,EACZC,oFCdN,IAAArE,EAAArN,EAAA,IAEaE,EAAAwM,iBAA6B,CAACW,EAAAjJ,aAE3ClE,EAAAsM,gBAAA,SAAgC9H,GAC9B,OAAOA,GAGTxE,EAAAuM,eAAA,SAA+B3C,GAC7B,OAAOA,sKCbT,IAAAG,EAAAjD,EAAAhH,EAAA,MACAE,EAAAgF,QAAe+E,EAAA/E,oVCDf,IAAA4C,EAAAC,EAAA/H,EAAA,IACAwL,EAAAxE,EAAAhH,EAAA,KAEAyL,EAAAzL,EAAA,IAEAiS,EAAAjL,EAAAhH,EAAA,MAEMkS,EAASzG,EAAA0G,aAAa,CAC1BC,KAAM,CACJC,MAAO,OACPC,OAAQ,UASZpS,EAAAgF,QAAesG,EAAAtG,QAAUgN,EAAV1G,CAJc,SAACrD,OAAEoK,EAAApK,EAAAoK,QAC9B,OAAOzK,EAAA4C,cAACuH,EAAA/M,QAAI,CAACsN,UAAWD,EAAQH,wFCdlClS,EAAAiS,aAAA,SACED,GAEA,OAAOA,sKCLT,IAAAjI,EAAAjD,EAAAhH,EAAA,MACAyS,EAAAzL,EAAAhH,EAAA,MAEAE,EAAAgF,QAAeuN,EAAAvN,QAAY+E,EAAA/E,koBCH3B,IAAA4C,EAAAC,EAAA/H,EAAA,IACA0S,EAAA1L,EAAAhH,EAAA,MACAwL,EAAAxE,EAAAhH,EAAA,KAEAyL,EAAAzL,EAAA,IAEA+G,EAAA/G,EAAA,IAEAD,EAAAC,EAAA,GAEA2S,EAAA3L,EAAAhH,EAAA,KAEA4S,EAAA5L,EAAAhH,EAAA,MACA6S,EAAA7L,EAAAhH,EAAA,MACA8S,EAAA9L,EAAAhH,EAAA,MACA+S,EAAA/L,EAAAhH,EAAA,MACAgT,EAAAhM,EAAAhH,EAAA,MACAiT,EAAAjM,EAAAhH,EAAA,MAQMkS,EAASzG,EAAA0G,aAAa,CAC1Be,IAAK,CACHC,YAAa,UAiGjBjT,EAAAgF,QAAesG,EAAAtG,QAAYgN,EAAZ1G,CA5Fe,SAACrD,OAC7BqK,EAAArK,EAAAqK,UACAD,EAAApK,EAAAoK,QACAa,EAAAjL,EAAAiL,gBACAC,EAAAlL,EAAAkL,SAEM7K,EAAAJ,EAAAN,EAAAO,UAAA,MAACiL,EAAA9K,EAAA,GAAS+K,EAAA/K,EAAA,GACVgL,EAAU1L,EAAM2L,OAAO,MACvBC,EAAS5L,EAAM2L,OAAO,MAEtBE,EAAU7L,EAAMc,YAAY,WAChC2K,GAAW,GACXxM,EAAAK,QACC,IAEGwM,EAA2B9L,EAAMc,YACrC,SAACC,GACC,IAAMxB,EAAQ,CAAEpG,EAAG4H,EAAExB,MAAM0B,QAAS7H,EAAG2H,EAAExB,MAAM2B,SACzCY,EAAM,CAAE3I,EAAG4H,EAAEE,QAAS7H,EAAG2H,EAAEG,SAClB5G,KAAKkO,IAAIvQ,EAAAqD,UAAUrD,EAAAgD,SAASsE,EAAOuC,MACpC,IACZwJ,EAAgB/L,EAAOuC,IAG3B,CAACwJ,IAGG7N,EAAgBoN,EAAAzN,QACpB0O,OACA1I,EACA,SAAApC,GAAU,OAAAA,IAAW4K,EAAO5B,UAGxBlD,EAAAxG,EAAAN,EAAAO,SAAAtI,EAAAQ,UAAA,GAACsT,EAAAjF,EAAA,GAASkF,EAAAlF,EAAA,GACVmC,EAAO2B,EAAAxN,QAAiBsO,GAM9B,OALIzC,EAAKsB,QAAUwB,EAAQ5S,GAAK8P,EAAKuB,SAAWuB,EAAQ3S,IACtD4S,EAAW,CAAE7S,EAAG8P,EAAKsB,MAAOnR,EAAG6P,EAAKuB,SACpCe,EAAStC,EAAKsB,MAAOtB,EAAKuB,SAI1BxK,EAAA4C,cAAA,OAAK8H,UAAWA,EAAWuB,IAAKP,GAC9B1L,EAAA4C,cAAA,OACEqJ,IAAKL,EACLlB,UAAWD,EAAQW,IACnBb,MAAO,GAAGtB,EAAKsB,MACfC,OAAQ,GAAGvB,EAAKuB,OAChB0B,QAAS,OAAOjD,EAAKsB,MAAK,IAAItB,EAAKuB,OACnC2B,cAAe1O,EAAcoD,YAC7BuL,cAAe3O,EAAc+D,YAC7B6K,YAAa5O,EAAcmE,WAE3B5B,EAAA4C,cAACqI,EAAA7N,QAAsB,CACrBkP,EAAG,GACHC,GAAItD,EAAKsB,MAAQ,GACjBiC,GAAIvD,EAAKuB,OAAS,KAEpBxK,EAAA4C,cAACsI,EAAA9N,QAAW,CAACjE,EAAG,GAAIC,EAAG6P,EAAKuB,OAAS,GAAIiC,QAAS,eAClDzM,EAAA4C,cAACkI,EAAA1N,QAAS,MACV4C,EAAA4C,cAACmI,EAAA3N,QAAY,MACb4C,EAAA4C,cAACoI,EAAA5N,QAAY,MACZK,EAAc8B,OAAS9B,EAAcqE,KACpC9B,EAAA4C,cAAA,QACE8J,GAAIjP,EAAc8B,MAAM0B,QACxB0L,GAAIlP,EAAc8B,MAAM2B,QACxB0L,GAAInP,EAAcqE,IAAIb,QACtB4L,GAAIpP,EAAcqE,IAAIZ,QACtB4L,OAAO,cAITtB,GACAxL,EAAA4C,cAAA,SACE5C,EAAA4C,cAAA,QACEzJ,EAAG,EACHC,EAAG,EACHmR,MAAOtB,EAAKsB,MACZC,OAAQvB,EAAKuB,OACbuC,QAAS,GACTC,KAAK,YAEPhN,EAAA4C,cAACuI,EAAA/N,QAAU,CACTjE,EAAG8P,EAAKsB,MAAQ,EAAI,IACpBnR,EAAG6P,EAAKuB,OAAS,EAAI,IACrBiC,QAASZ,8KCpHvB,IAAA1J,EAAAjD,EAAAhH,EAAA,MACAyS,EAAAzL,EAAAhH,EAAA,MACAE,EAAAgF,QAAeuN,EAAAvN,QAAiB+E,EAAA/E,qVCFhC,IAAA4C,EAAAC,EAAA/H,EAAA,IAEA+U,EAAA/N,EAAAhH,EAAA,MAcAE,EAAAgF,QAR4C,SAACiD,OAAE6M,EAAA7M,EAAA6M,QAAc,OAC3DlN,EAAA4C,cAAA,SACGsK,EAAQjQ,IAAI,SAAArD,GAAM,OACjBoG,EAAA4C,cAACqK,EAAA7P,QAAI,CAAC+P,IAAKvT,EAAIA,GAAIA,2KCXzB,IAAAuI,EAAAjD,EAAAhH,EAAA,MACAyS,EAAAzL,EAAAhH,EAAA,MACAE,EAAAgF,QAAeuN,EAAAvN,QAAY+E,EAAA/E,qQCF3B,IAAA4C,EAAAC,EAAA/H,EAAA,IAYAE,EAAAgF,QAJkC,SAACiD,OAAE7H,EAAA6H,EAAA7H,SACnC,OAAOwH,EAAA4C,cAAA,UAAQ0J,EAAG,EAAGC,GAAI/T,EAASW,EAAGqT,GAAIhU,EAASY,oFCTpD,IAAA2K,EAAA7L,EAAA,GACA6O,EAAA7O,EAAA,IAGAkV,EAAAlV,EAAA,IAYAE,EAAAgF,QAAe2G,EAAAsJ,QANf,SAAyBrL,EAAiBsL,GAChC,IAAA1T,EAAA0T,EAAA1T,GACFwN,EAAOgG,EAAArL,kBAAkBC,GAAOpI,GACtC,OAAOmN,EAAAwG,KAAKnG,EAAM,CAAC,8FCbrB,IAAArD,EAAA7L,EAAA,GAEAkO,EAAAlO,EAAA,IAIAkV,EAAAlV,EAAA,IAWAE,EAAAgF,QAAe2G,EAAAsJ,QATf,SAAyBrL,GACvB,IAAMxI,EAAY4T,EAAArL,kBAAkBC,GAGpC,MAAO,CACLkL,QAHc9G,EAAAvJ,WAAWrD,yKCV7B,IAAA2I,EAAAjD,EAAAhH,EAAA,MACAyS,EAAAzL,EAAAhH,EAAA,MACAE,EAAAgF,QAAeuN,EAAAvN,QAAiB+E,EAAA/E,qVCFhC,IAAA4C,EAAAC,EAAA/H,EAAA,IAEAsV,EAAAtO,EAAAhH,EAAA,MAcAE,EAAAgF,QARkD,SAACiD,OAAEoN,EAAApN,EAAAoN,WAAiB,OACpEzN,EAAA4C,cAAA,SACG6K,EAAWxQ,IAAI,SAAArD,GAAM,OACpBoG,EAAA4C,cAAC4K,EAAApQ,QAAO,CAAC+P,IAAKvT,EAAIA,GAAIA,2KCX5B,IAAAuI,EAAAjD,EAAAhH,EAAA,MACAyS,EAAAzL,EAAAhH,EAAA,MACAE,EAAAgF,QAAeuN,EAAAvN,QAAe+E,EAAA/E,koBCF9B,IAAA4C,EAAAC,EAAA/H,EAAA,IAEA+G,EAAAC,EAAAhH,EAAA,KACAD,EAAAC,EAAA,GAEAwV,EAAAxO,EAAAhH,EAAA,MACAyV,EAAAzO,EAAAhH,EAAA,KAmEM0V,EAAW,GACXC,EAAW,KAEXC,EAAa,GACbC,EAAa,IAYnB3V,EAAAgF,QA1EwC,SAACiD,OA+DxBjF,EA9DfrB,EAAAsG,EAAAtG,GACAC,EAAAqG,EAAArG,GACAjB,EAAAsH,EAAAtH,qBACAoH,EAAAE,EAAAF,OAEMO,EAAAJ,EAAAN,EAAAO,SAAA,MAACyN,EAAAtN,EAAA,GAAUuN,EAAAvN,EAAA,GACjB,GAAI3H,EAAuBiV,EAAU,CACnCC,EAAYlV,GACZ,IAAMmV,EAAIjW,EAAAmD,OAAO,CAAErB,GAAEA,EAAEC,GAAEA,IACnB6F,GAqDOzE,EArDQ8S,IAwDvB9S,EAASnD,EAAA8C,UAAUgT,EAAa3S,EAAQ0S,EAAYC,IAEvCD,IAAeC,EAAaD,IACpCD,EAAWD,GACdA,GA3DA3O,EAAA7B,QAASyC,EAAM,OAGjB,IAAMsO,EAAWnO,EAAMc,YACrB,SAAC3H,EAAWC,GACV+G,EAAO,CAAEhH,EAACA,EAAEC,EAACA,GAAIY,IAEnB,CAACmG,EAAQnG,IAGLoU,EAAWpO,EAAMc,YACrB,SAAC3H,EAAWC,GACV+G,EAAOpG,EAAI,CAAEZ,EAACA,EAAEC,EAACA,KAEnB,CAAC+G,EAAQpG,IAGLsU,EAAS,CACblV,EAAGY,EAAGZ,GAAKa,EAAGb,EAAIY,EAAGZ,GAAK,EAC1BC,EAAGW,EAAGX,GAAKY,EAAGZ,EAAIW,EAAGX,GAAK,GAGtBkV,EAAetO,EAAMc,YACzB,SAAC3H,EAAWC,GACV,IAAMmV,EAAK,CAAEpV,EAACA,EAAEC,EAACA,GACXoV,EAAWvW,EAAAgD,SAASsT,EAAIF,GAC9BlO,EAAOlI,EAAA+C,IAAIjB,EAAIyU,GAAWvW,EAAA+C,IAAIhB,EAAIwU,KAEpC,CAACrO,EAAQpG,EAAI,CAAC,KAGhB,OACEiG,EAAA4C,cAAA,SACE5C,EAAA4C,cAAA,QAAM8J,GAAI3S,EAAGZ,EAAGwT,GAAI5S,EAAGX,EAAGwT,GAAI5S,EAAGb,EAAG0T,GAAI7S,EAAGZ,EAAG0T,OAAO,UACrD9M,EAAA4C,cAAC+K,EAAAvQ,QAAW,CAACqR,UAAW1U,EAAI2U,eAAgB,IAC1C1O,EAAA4C,cAAC8K,EAAAtQ,QAAU,CAACjE,EAAGY,EAAGZ,EAAGC,EAAGW,EAAGX,EAAGuV,OAAQR,KAExCnO,EAAA4C,cAAC+K,EAAAvQ,QAAW,CAACqR,UAAWzU,EAAI0U,eAAgB,IAC1C1O,EAAA4C,cAAC8K,EAAAtQ,QAAU,CAACjE,EAAGa,EAAGb,EAAGC,EAAGY,EAAGZ,EAAGuV,OAAQP,KAExCpO,EAAA4C,cAAC+K,EAAAvQ,QAAW,CAACqR,UAAWJ,EAAQK,eAAgB,IAC9C1O,EAAA4C,cAAC8K,EAAAtQ,QAAU,CAACjE,EAAGkV,EAAOlV,EAAGC,EAAGiV,EAAOjV,EAAGuV,OAAQL,0KCnEtD,IAAAnM,EAAAjD,EAAAhH,EAAA,MACAE,EAAAgF,QAAe+E,EAAA/E,ioBCDf,IAAA4C,EAAAC,EAAA/H,EAAA,IACAwL,EAAAxE,EAAAhH,EAAA,KAUMkS,EARNlS,EAAA,IAQemS,aAAa,CAC1BuE,KAAM,CACJC,OAAQ,aA0DZzW,EAAAgF,QAAesG,EAAAtG,QAAYgN,EAAZ1G,CArDqB,SAACrD,OAAElH,EAAAkH,EAAAlH,EAAGC,EAAAiH,EAAAjH,EAAGqR,EAAApK,EAAAoK,QAASkE,EAAAtO,EAAAsO,OAC9C1C,EAAMjM,EAAM2L,OAAyB,MACrCjL,EAAAJ,EAAAN,EAAAO,UAAA,MAACuO,EAAApO,EAAA,GAAUqO,EAAArO,EAAA,GACXG,EAAcb,EAAMc,YACxB,SAACC,GACMkL,EAAIjC,UAGTiC,EAAIjC,QAAQ5I,kBAAkBL,EAAEM,WAChC0N,GAAU,GACVhO,EAAEQ,kBACFR,EAAEO,mBAEJ,CAAC2K,EAAK8C,IAEFvN,EAAcxB,EAAMc,YACxB,SAACC,GACC,IAAK+N,EACH,OAAO,EAETH,EAAO5N,EAAEE,QAASF,EAAEG,SACpBH,EAAEQ,kBACFR,EAAEO,kBAEJ,CAACwN,IAEGlN,EAAY5B,EAAMc,YACtB,SAACC,GACMkL,EAAIjC,UAGTiC,EAAIjC,QAAQnI,sBAAsBd,EAAEM,WACpC0N,GAAU,GACVhO,EAAEQ,kBACFR,EAAEO,mBAEJ,CAAC2K,EAAK8C,IAER,OACE/O,EAAA4C,cAAA,UACE8H,UAAWD,EAAQmE,KACnB3C,IAAKA,EACLM,GAAIpT,EACJqT,GAAIpT,EACJkT,EAAG,EACHU,KAAK,WACLb,cAAetL,EACfuL,cAAe5K,EACf6K,YAAazK,+iBClEnB,IAAA5B,EAAAC,EAAA/H,EAAA,IAGA8W,EAAA9W,EAAA,KAmCAE,EAAAgF,QA3BgD,SAACiD,OAC/C4O,EAAA5O,EAAA4O,UACAR,EAAApO,EAAAoO,UACA/N,EAAAL,EAAAqO,sBAAA,IAAAhO,EAAA,GAAAA,EACAkD,EAAAvD,EAAAuD,SAEA,IAAKqL,IAAcR,EAEjB,OADAS,QAAQC,KAAK,+CACNnP,EAAA4C,cAAC5C,EAAM8D,SAAQ,MAGlB,IAAAgD,EAAAxG,EAAAN,EAAAO,UAAA,MAAC6O,EAAAtI,EAAA,GAAcuI,EAAAvI,EAAA,GACfwI,EAAkBtP,EAAMc,YAC5B,SAAC1F,IACMgU,GAAgBhU,GAAUsT,EAC7BW,GAAgB,GACPD,GAAgBhU,EAASsT,GAClCW,GAAgB,IAGpB,CAACD,IAIH,OAFAJ,EAAAO,iBAAkBN,GAAaR,EAAmBa,GAE3CtP,EAAA4C,cAAC5C,EAAM8D,SAAQ,KAAEsL,GAAgBxL,gQCnC1C,IAAA5D,EAAAC,EAAA/H,EAAA,IACAD,EAAAC,EAAA,GAEAE,EAAAmX,iBAAA,SACEtD,EACAuD,GAEAxP,EAAMyP,UAAU,WACd,IAAMC,EAAc,SAAC3O,GACnB,IAAI4O,EACJ,GAAI1X,EAAA2C,UAAUqR,GACZ0D,EAAS1D,MACJ,CACL,IAAKA,EAAIjC,QACP,OAEF,IAAM4E,EAAO3C,EAAIjC,QAAQ4F,wBACzBD,EAAS,CAAExW,EAAGyV,EAAKiB,KAAMzW,EAAGwV,EAAKkB,KAGnC,IAAMC,EAAM,CAAE5W,EAAG4H,EAAEE,QAAU0O,EAAOxW,EAAGC,EAAG2H,EAAEG,QAAUyO,EAAOvW,GACvDgC,EAASnD,EAAAqD,UAAUyU,GACzBP,EAAuBpU,IAKzB,OAFAqH,SAASuN,iBAAiB,YAAaN,GAEhC,WACLjN,SAASwN,oBAAoB,YAAaP,KAE3C,CAACzD,EAAKuD,oFC9BX,IAAAzL,EAAA7L,EAAA,GAEA6O,EAAA7O,EAAA,IAKAgY,EAAAhY,EAAA,IACA2N,EAAA3N,EAAA,IAmBAE,EAAAgF,QAAe2G,EAAAsJ,QAbf,SAAyBrL,EAAiBsL,GAChC,IAAA1T,EAAA0T,EAAA1T,GACFwN,EAAO8I,EAAA9N,qBAAqBJ,GAAOpI,GACzC,OAAOmN,EAAAwG,KAAKnG,EAAM,CAAC,KAAM,KAAM,0BAGjC,SAA4B+I,EAAoB7C,GACtC,IAAA1T,EAAA0T,EAAA1T,GACR,MAAO,CACLuG,OAAQ,SAACpG,EAAaC,GAAgB,OAAAmW,EAAStK,EAAA9H,YAAYnE,EAAIG,EAAIC,uFCvBvE,IAAA+J,EAAA7L,EAAA,GAEAkO,EAAAlO,EAAA,IAIAgY,EAAAhY,EAAA,IAWAE,EAAAgF,QAAe2G,EAAAsJ,QATf,SAAyBrL,GACvB,IAAMnI,EAAeqW,EAAA9N,qBAAqBJ,GAG1C,MAAO,CACLyL,WAHiBrH,EAAAvJ,WAAWhD,yKCVhC,IAAAsI,EAAAjD,EAAAhH,EAAA,MACAyS,EAAAzL,EAAAhH,EAAA,MACAE,EAAAgF,QAAeuN,EAAAvN,QAAe+E,EAAA/E,qVCF9B,IAAA4C,EAAAC,EAAA/H,EAAA,IAEAkY,EAAAlR,EAAAhH,EAAA,MAcAE,EAAAgF,QARkD,SAACiD,OAAEgQ,EAAAhQ,EAAAgQ,WAAiB,OACpErQ,EAAA4C,cAAA,SACGyN,EAAWpT,IAAI,SAAArD,GAAM,OACpBoG,EAAA4C,cAACwN,EAAAhT,QAAO,CAAC+P,IAAKvT,EAAIA,GAAIA,2KCX5B,IAAAuI,EAAAjD,EAAAhH,EAAA,MACAyS,EAAAzL,EAAAhH,EAAA,MACAE,EAAAgF,QAAeuN,EAAAvN,QAAe+E,EAAA/E,qVCF9B,IAAA4C,EAAAC,EAAA/H,EAAA,IACAwL,EAAAxE,EAAAhH,EAAA,KAGAyL,EAAAzL,EAAA,IAEA2S,EAAA3L,EAAAhH,EAAA,KAEAoY,EAAApR,EAAAhH,EAAA,MACAqY,EAAArR,EAAAhH,EAAA,KACAyV,EAAAzO,EAAAhH,EAAA,KAWMkS,EAASzG,EAAA0G,aAAa,CAC1BmG,OAAQ,CACN3B,OAAQ,aA4DZzW,EAAAgF,QAAesG,EAAAtG,QAAYgN,EAAZ1G,CAvDkB,SAACrD,OAChCoK,EAAApK,EAAAoK,QACAjS,EAAA6H,EAAA7H,SACAI,EAAAyH,EAAAzH,KACA2C,EAAA8E,EAAA9E,MACA4E,EAAAE,EAAAF,OACAsQ,EAAApQ,EAAAoQ,UACAC,EAAArQ,EAAAqQ,eAEMzE,EAAMjM,EAAM2L,OAAyB,MAErCgF,EAAa3Q,EAAMc,YACvB,SAACC,GACCZ,EAAOY,EAAEE,QAASF,EAAEG,UAEtB,CAACf,IAGGyQ,EAAW/F,EAAAzN,QAAe,KAAMuT,GAEtC,OACE3Q,EAAA4C,cAAA,KAAGM,UAAW,aAAa1K,EAASW,EAAC,KAAKX,EAASY,EAAC,KAClD4G,EAAA4C,cAAA,UACE8H,UAAWD,EAAQ+F,OACnBvE,IAAKA,EACLe,KAAK,OACLV,EAAG,EACHC,GAAI,EACJC,GAAI,EACJL,cAAeyE,EAAS/P,YACxBuL,cAAewE,EAASpP,YACxB6K,YAAauE,EAAShP,YAExB5B,EAAA4C,cAAC+K,EAAAvQ,QAAW,CAAC6R,UAAWhD,GACtBjM,EAAA4C,cAAC0N,EAAAlT,QAAe,CACdmP,GAAI,EACJC,GAAI,EACJF,EAAG,GACH/R,IAAK,IACLE,IAAK,IACLkM,MAAO/N,EACPiY,SAAUJ,IAEZzQ,EAAA4C,cAAC2N,EAAAnT,QAAc,CACbmP,GAAI,EACJC,GAAI,EACJF,EAAG,GACH3F,MAAOpL,EACPsV,SAAUH,2KC5EpB,IAAAvO,EAAAjD,EAAAhH,EAAA,MACAE,EAAAgF,QAAe+E,EAAA/E,ioBCDf,IAAA4C,EAAAC,EAAA/H,EAAA,IACAwL,EAAAxE,EAAAhH,EAAA,KAEAD,EAAAC,EAAA,GAcMkS,EAZNlS,EAAA,IAYemS,aAAa,CAC1ByG,OAAQ,CACNjC,OAAQ,aAINkC,EAAazW,KAAKgO,IAAM,EAAI,GAC5B0I,EAAW1W,KAAKgO,IAAM,EAAI,GAC1B2I,EAAkB,EAAV3W,KAAKgO,IAAU0I,EAAWD,GA0FxC,SAASG,EAAa3E,EAAYC,EAAYF,GAC5C,MAAO,CACL,IACAC,EAAKjS,KAAKsB,IAAImV,GAAczE,EAC5BE,EAAKlS,KAAKuB,IAAIkV,GAAczE,EAC5B,IACAA,EACAA,EACA,EACA,EACA,EACAC,EAAKjS,KAAKsB,IAAIoV,GAAY1E,EAC1BE,EAAKlS,KAAKuB,IAAImV,GAAY1E,GAC1B6E,KAAK,KAGT,SAASC,EACP7E,EACAC,EACAF,EACA+E,GAEA,IAAM9V,EAAQwV,EAAaE,EAAQI,EACnC,MAAO,CACL,IACA9E,EAAKjS,KAAKsB,IAAIL,IAAU+Q,EAAI,GAC5BE,EAAKlS,KAAKuB,IAAIN,IAAU+Q,EAAI,GAC5B,IACAC,EAAKjS,KAAKsB,IAAIL,IAAU+Q,EAAI,GAC5BE,EAAKlS,KAAKuB,IAAIN,IAAU+Q,EAAI,IAC5B6E,KAAK,KAhCT/Y,EAAAgF,QAAesG,EAAAtG,QAAYgN,EAAZ1G,CArF0B,SAACrD,OACxCkM,EAAAlM,EAAAkM,GACAC,EAAAnM,EAAAmM,GACAF,EAAAjM,EAAAiM,EACA/R,EAAA8F,EAAA9F,IACAE,EAAA4F,EAAA5F,IACAkM,EAAAtG,EAAAsG,MACA8D,EAAApK,EAAAoK,QACAoG,EAAAxQ,EAAAwQ,SAEMQ,EAAUpZ,EAAA8C,WAAW4L,EAAQpM,IAAQE,EAAMF,GAAM,EAAG,GACpDmR,EAAU1L,EAAM2L,OAAuB,MACvC2F,EAAYtR,EAAM2L,OAAuB,MACzCjL,EAAAJ,EAAAN,EAAAO,UAAA,MAACgR,EAAA7Q,EAAA,GAAe8Q,EAAA9Q,EAAA,GAChB+Q,EAAsBzR,EAAMc,YAChC,SAACC,GACMuQ,EAAUtH,UAGfwH,GAAe,GACfF,EAAUtH,QAAQ5I,kBAAkBL,EAAEM,WACtCN,EAAEO,iBACFP,EAAEQ,oBAEJ,CAAC+P,IAEGI,EAAsB1R,EAAMc,YAChC,SAACC,GACC,GAAKwQ,GAAkB7F,EAAQ1B,QAA/B,CAIA,IAAM2H,EAAMjG,EAAQ1B,QAAQ4F,wBACtBgC,EAAqB,CACzBzY,EAAG4H,EAAEE,SAAW0Q,EAAI9B,KAAO8B,EAAIpH,MAAQ,GACvCnR,EAAG2H,EAAEG,SAAWyQ,EAAI7B,IAAM6B,EAAInH,OAAS,IAEnCqH,EAAc5Z,EAAAsD,MAAMtD,EAAA6C,MAAO8W,GAC7BE,EAAaf,EAAac,EAC1BC,EAAa,IACfA,GAAwB,EAAVxX,KAAKgO,IAErB,IAAM+I,EAAUpZ,EAAA8C,UAAU+W,EAAab,EAAO,EAAG,GACjDJ,EAAStW,GAAOE,EAAMF,GAAO8W,GAC7BtQ,EAAEO,iBACFP,EAAEQ,oBAEJ,CAACgQ,EAAe7F,EAASnR,EAAKE,EAAKoW,IAE/BkB,EAAoB/R,EAAMc,YAC9B,SAACC,GACMuQ,EAAUtH,UAGfwH,GAAe,GACfF,EAAUtH,QAAQnI,sBAAsBd,EAAEM,WAC1CN,EAAEO,iBACFP,EAAEQ,oBAEJ,CAAC+P,IAEH,OACEtR,EAAA4C,cAAA,SACE5C,EAAA4C,cAAA,QACEqJ,IAAKP,EACLsG,EAAGd,EAAa3E,EAAIC,EAAIF,GACxBQ,OAAO,UACPmF,YAAa,EACbjF,KAAK,SAEPhN,EAAA4C,cAAA,QACE8H,UAAWD,EAAQqG,OACnB7E,IAAKqF,EACLU,EAAGZ,EAAmB7E,EAAIC,EAAIF,EAAG+E,GACjCvE,OAAO,MACPmF,YAAa,EACbjF,KAAK,OACLb,cAAesF,EACfrF,cAAesF,EACfrF,YAAa0F,goBC3GrB,IAAA/R,EAAAC,EAAA/H,EAAA,IACAwL,EAAAxE,EAAAhH,EAAA,KAEAyL,EAAAzL,EAAA,IACAD,EAAAC,EAAA,GAUMkS,EAASzG,EAAA0G,aAAa,CAC1ByG,OAAQ,CACNjC,OAAQ,aAwFZ,SAASuC,EACP7E,EACAC,EACAF,EACA/Q,GAEA,MAAO,CACL,IACAgR,EAAKjS,KAAKsB,IAAIL,IAAU+Q,EAAI,GAC5BE,EAAKlS,KAAKuB,IAAIN,IAAU+Q,EAAI,GAC5B,IACAC,EAAKjS,KAAKsB,IAAIL,IAAU+Q,EAAI,GAC5BE,EAAKlS,KAAKuB,IAAIN,IAAU+Q,EAAI,IAC5B6E,KAAK,KAfT/Y,EAAAgF,QAAesG,EAAAtG,QAAYgN,EAAZ1G,CAjFyB,SAACrD,OACvCkM,EAAAlM,EAAAkM,GACAC,EAAAnM,EAAAmM,GACAF,EAAAjM,EAAAiM,EACA3F,EAAAtG,EAAAsG,MACA8D,EAAApK,EAAAoK,QACAoG,EAAAxQ,EAAAwQ,SAEMnF,EAAU1L,EAAM2L,OAAyB,MACzC2F,EAAYtR,EAAM2L,OAAuB,MACzCjL,EAAAJ,EAAAN,EAAAO,UAAA,MAACgR,EAAA7Q,EAAA,GAAe8Q,EAAA9Q,EAAA,GAChB+Q,EAAsBzR,EAAMc,YAChC,SAACC,GACMuQ,EAAUtH,UAGfwH,GAAe,GACfF,EAAUtH,QAAQ5I,kBAAkBL,EAAEM,WACtCN,EAAEO,iBACFP,EAAEQ,oBAEJ,CAAC+P,IAEGI,EAAsB1R,EAAMc,YAChC,SAACC,GACC,GAAKwQ,GAAkB7F,EAAQ1B,QAA/B,CAGA,IAAM2H,EAAMjG,EAAQ1B,QAAQ4F,wBACtBgC,EAAqB,CACzBzY,EAAG4H,EAAEE,SAAW0Q,EAAI9B,KAAO8B,EAAIpH,MAAQ,GACvCnR,EAAG2H,EAAEG,SAAWyQ,EAAI7B,IAAM6B,EAAInH,OAAS,IAErCqH,EAAc5Z,EAAAsD,MAAMtD,EAAA6C,MAAO8W,GAC3BC,EAAc,IAChBA,GAAyB,EAAVvX,KAAKgO,IAEtBuI,EAASgB,GACT9Q,EAAEO,iBACFP,EAAEQ,oBAEJ,CAACgQ,EAAe7F,EAASmF,IAErBkB,EAAoB/R,EAAMc,YAC9B,SAACC,GACMuQ,EAAUtH,UAGfwH,GAAe,GACfF,EAAUtH,QAAQnI,sBAAsBd,EAAEM,WAC1CN,EAAEO,iBACFP,EAAEQ,oBAEJ,CAAC+P,IAEH,OACEtR,EAAA4C,cAAA,SACE5C,EAAA4C,cAAA,UACEqJ,IAAKP,EACLa,GAAIA,EACJC,GAAIA,EACJF,EAAGA,EACHQ,OAAO,OACPE,KAAK,OACLiF,YAAa,IAEfjS,EAAA4C,cAAA,QACEqJ,IAAKqF,EACL5G,UAAWD,EAAQqG,OACnBkB,EAAGZ,EAAmB7E,EAAIC,EAAIF,EAAG3F,GACjCmG,OAAO,MACPmF,YAAa,EACbjF,KAAK,OACLb,cAAesF,EACfrF,cAAesF,EACfrF,YAAa0F,8TChGrB,IAAAhO,EAAA7L,EAAA,GAEA6O,EAAA7O,EAAA,IAEAD,EAAAC,EAAA,GAGAga,EAAAha,EAAA,IACA0N,EAAA1N,EAAA,IACA4N,EAAA5N,EAAA,IACA6N,EAAA7N,EAAA,IAwBAE,EAAAgF,QAAe2G,EAAAsJ,QAlBf,SAAyBrL,EAAiBsL,GAChC,IAAA1T,EAAA0T,EAAA1T,GACFgN,EAAUsL,EAAA7P,qBAAqBL,GAAOpI,GAC5C,OAAAD,EAAA,GACKoN,EAAAwG,KAAK3G,EAAS,CAAC,WAAY,SAAQ,CACtCrL,MAAOtD,EAAAsD,MAAMtD,EAAA6C,MAAO8L,EAAQlO,aAIhC,SAA4ByX,EAAoB7C,GACtC,IAAA1T,EAAA0T,EAAA1T,GACR,MAAO,CACLuG,OAAQ,SAAChH,EAAWC,GAAc,OAAA+W,EAASvK,EAAAhI,YAAYhE,EAAIT,EAAGC,KAC9DqX,UAAW,SAAC7X,GAAiB,OAAAuX,EAASrK,EAAA5H,eAAetE,EAAIhB,KACzD8X,eAAgB,SAACnV,GAAkB,OAAA4U,EAASpK,EAAA1H,oBAAoBzE,EAAI2B,uFC9BxE,IAAAwI,EAAA7L,EAAA,GAEAkO,EAAAlO,EAAA,IAIAga,EAAAha,EAAA,IAWAE,EAAAgF,QAAe2G,EAAAsJ,QATf,SAAyBrL,GACvB,IAAMvI,EAAeyY,EAAA7P,qBAAqBL,GAG1C,MAAO,CACLqO,WAHiBjK,EAAAvJ,WAAWpD,yKCVhC,IAAA8W,EAAArR,EAAAhH,EAAA,KACAyS,EAAAzL,EAAAhH,EAAA,MACAE,EAAAgF,QAAeuN,EAAAvN,QAAqBmT,EAAAnT,wFCFpC,IAAA2G,EAAA7L,EAAA,GAGA+N,EAAA/N,EAAA,IACAia,EAAAja,EAAA,KAQA,IAAMka,EAAqB,CACzBvB,SAAU5K,EAAAtH,qBAGZvG,EAAAgF,QAAe2G,EAAAsJ,QAVf,SAAyBrL,GACvB,MAAO,CACL2E,MAAOwL,EAAAE,yBAAyBrQ,KAUlCoQ,kFCjBF,IAAAna,EAAAC,EAAA,GAEaE,EAAAka,gBAAkB,SAACtQ,GAC9B,OAAAA,EAAMC,SAASC,MAAMhJ,SAEVd,EAAAia,yBAA2B,SAACrQ,GACvC,OAAA/J,EAAAsD,MAAMtD,EAAA6C,MAAO1C,EAAAka,gBAAgBtQ,wKCP/B,IAAAG,EAAAjD,EAAAhH,EAAA,MACAyS,EAAAzL,EAAAhH,EAAA,MACAE,EAAAgF,QAAeuN,EAAAvN,QAAmB+E,EAAA/E,qVCFlC,IAAA4C,EAAAC,EAAA/H,EAAA,IACAwL,EAAAxE,EAAAhH,EAAA,KAUMkS,EARNlS,EAAA,IAQemS,aAAa,CAC1BkI,OAAQ,CACN1D,OAAQ,aA0BZzW,EAAAgF,QAAesG,EAAAtG,QAAYgN,EAAZ1G,CArBsB,SAACrD,OAAEoK,EAAApK,EAAAoK,QAAStR,EAAAkH,EAAAlH,EAAGC,EAAAiH,EAAAjH,EAAGqT,EAAApM,EAAAoM,QAAc,OAEnEzM,EAAA4C,cAAA,OACE8H,UAAWD,EAAQ8H,OACnBC,MAAM,6BACNrZ,EAAGA,EACHC,EAAGA,EACHmR,MAAM,KACNC,OAAO,KACP0B,QAAQ,cACRc,KAAK,OACLP,QAAS,WACPyC,QAAQuD,IAAI,SACZhG,MAGFzM,EAAA4C,cAAA,UAAQ2J,GAAI,IAAKC,GAAI,IAAKF,EAAG,IAAKU,KAAK,gBACvChN,EAAA4C,cAAA,QAAMoP,EAAE,8cCnCZ,IAAAjO,EAAA7L,EAAA,GAIMka,EAAqB,CACzB3F,QAHFvU,EAAA,IAGWoF,OAGXlF,EAAAgF,QAAe2G,EAAAsJ,QACb,KACA+E,sKCVF,IAAAjQ,EAAAjD,EAAAhH,EAAA,MACAE,EAAAgF,QAAe+E,EAAA/E,oVCDf,IAAA4C,EAAAC,EAAA/H,EAAA,IACAyL,EAAAzL,EAAA,IACAwL,EAAAxE,EAAAhH,EAAA,KAQMkS,EAASzG,EAAA0G,aAAa,CAC1BkI,OAAQ,CACN1D,OAAQ,aAsBZzW,EAAAgF,QAAesG,EAAAtG,QAAYgN,EAAZ1G,CAjBqB,SAACrD,OAAEoK,EAAApK,EAAAoK,QAAStR,EAAAkH,EAAAlH,EAAGC,EAAAiH,EAAAjH,EAAGqT,EAAApM,EAAAoM,QAAc,OAClEzM,EAAA4C,cAAA,OACE8H,UAAWD,EAAQ8H,OACnBC,MAAM,6BACNrZ,EAAGA,EACHC,EAAGA,EACHmR,MAAM,MACNC,OAAO,MACP0B,QAAQ,cACRc,KAAK,OACLP,QAASA,GAETzM,EAAA4C,cAAA,UAAQ2J,GAAI,IAAKC,GAAI,IAAKF,EAAG,IAAKU,KAAK,gBACvChN,EAAA4C,cAAA,QAAMoP,EAAE,wQC9BZ,IAAAjO,EAAA7L,EAAA,GAEAyN,EAAAzN,EAAA,IACA8N,EAAA9N,EAAA,IAEMka,EAAqB,CACzB9G,gBAAiB3F,EAAAlI,cACjB8N,SAAUvF,EAAAxH,SAGZpG,EAAAgF,QAAe2G,EAAAsJ,QACb,KACA+E","file":"client.e5a855c602f73e115833.bundle.js","sourcesContent":["import { Vector2, Line, VEC_ZERO } from \"@/math\";\r\nimport { SECOND_AS_MILLIS } from \"@/time\";\r\nimport { IdentityObject, IdentityCollection } from \"@/identity\";\r\n\r\nexport interface BallState extends IdentityObject {\r\n  position: Vector2;\r\n  velocity: Vector2;\r\n}\r\nexport const defaultBallState = Object.freeze({\r\n  position: VEC_ZERO,\r\n  velocity: VEC_ZERO\r\n});\r\n\r\nexport interface EmitterState extends IdentityObject {\r\n  position: Vector2;\r\n  rate: number;\r\n  velocity: Vector2;\r\n  lastEmit: number;\r\n}\r\n\r\nexport const defaultEmitterState = Object.freeze({\r\n  position: VEC_ZERO,\r\n  rate: 1000,\r\n  velocity: VEC_ZERO,\r\n  lastEmit: 0\r\n});\r\n\r\nexport interface BouncerState extends IdentityObject, Line {\r\n  toneTriggerTimestamp: number;\r\n}\r\n\r\nexport const defaultBouncerState = Object.freeze({\r\n  toneTriggerTimestamp: 0\r\n});\r\n\r\nexport interface BoingServiceState {\r\n  tick: number;\r\n  gravity: Vector2;\r\n  fieldMin: Vector2;\r\n  fieldMax: Vector2;\r\n  ballsById: IdentityCollection<BallState>;\r\n  emittersById: IdentityCollection<EmitterState>;\r\n  bouncersById: IdentityCollection<BouncerState>;\r\n}\r\n\r\nexport const defaultBoingServiceState: Readonly<\r\n  BoingServiceState\r\n> = Object.freeze({\r\n  tick: 0,\r\n  gravity: { x: 0, y: 9.8 / SECOND_AS_MILLIS },\r\n  fieldMin: { x: 0, y: 0 },\r\n  fieldMax: { x: 1000, y: 1000 },\r\n  ballsById: {},\r\n  emittersById: {\r\n    a: {\r\n      ...defaultEmitterState,\r\n      id: \"a\",\r\n      position: { x: 100, y: 100 },\r\n      velocity: { x: 0, y: 5 },\r\n      rate: 1000\r\n    }\r\n  },\r\n  bouncersById: {\r\n    b: {\r\n      ...defaultBouncerState,\r\n      id: \"b\",\r\n      p1: {\r\n        x: 50,\r\n        y: 400\r\n      },\r\n      p2: {\r\n        x: 150,\r\n        y: 500\r\n      }\r\n    }\r\n  }\r\n});\r\n","export interface Vector2 {\r\n  x: number;\r\n  y: number;\r\n}\r\nexport function isVector2(val: any): val is Vector2 {\r\n  return typeof val.x === \"number\" && typeof val.y === \"number\";\r\n}\r\n\r\n// It might simplify intercept calculations to store the line\r\n//  as a starting point, angle, and length\r\nexport interface Line {\r\n  p1: Vector2;\r\n  p2: Vector2;\r\n}\r\n\r\nexport const VEC_ZERO: Readonly<Vector2> = Object.freeze({ x: 0, y: 0 });\r\nexport const VEC_X: Readonly<Vector2> = Object.freeze({ x: 1, y: 0 });\r\n\r\nexport function constrain(x: number, min: number, max: number): number {\r\n  return Math.min(Math.max(x, min), max);\r\n}\r\n\r\nexport function add(a: Readonly<Vector2>, b: Readonly<Vector2>): Vector2 {\r\n  return {\r\n    x: a.x + b.x,\r\n    y: a.y + b.y\r\n  };\r\n}\r\n\r\nexport function subtract(a: Readonly<Vector2>, b: Readonly<Vector2>): Vector2 {\r\n  return {\r\n    x: a.x - b.x,\r\n    y: a.y - b.y\r\n  };\r\n}\r\n\r\nexport function scale(a: Readonly<Vector2>, scaler: number): Vector2 {\r\n  return {\r\n    x: a.x * scaler,\r\n    y: a.y * scaler\r\n  };\r\n}\r\n\r\nexport function length(a: Readonly<Line>): number {\r\n  const x = a.p1.x - a.p2.x;\r\n  const y = a.p1.y - a.p2.y;\r\n  return Math.sqrt(x * x + y * y);\r\n}\r\n\r\nexport function magnitude(a: Readonly<Vector2>): number {\r\n  return Math.sqrt(a.x * a.x + a.y * a.y);\r\n}\r\n\r\nexport function dotProduct(a: Readonly<Vector2>, b: Readonly<Vector2>) {\r\n  return a.x * b.x + a.y * b.y;\r\n}\r\n\r\nexport function determinate(a: Readonly<Vector2>, b: Readonly<Vector2>) {\r\n  return a.x * b.y - a.y * b.x;\r\n}\r\n\r\nexport function angle(a: Readonly<Vector2>, b: Readonly<Vector2>): number {\r\n  // This method only produces in range of 0 to 180\r\n  // // a.b = |a| * |b| * cos t\r\n  // // cos t = a.b / (|a| * |b|)\r\n  // const la = magnitude(a);\r\n  // const lb = magnitude(b);\r\n  // const dot = dotProduct(a, b);\r\n  // return Math.acos(dot / (la * lb));\r\n\r\n  // This method gives full circle angles\r\n  const det = determinate(a, b);\r\n  const dot = dotProduct(a, b);\r\n  return Math.atan2(det, dot);\r\n}\r\n\r\nexport function vector(angle: number, magnitude: number) {\r\n  return {\r\n    x: magnitude * Math.cos(angle),\r\n    y: magnitude * Math.sin(angle)\r\n  };\r\n}\r\n\r\nexport function intercept(\r\n  a: Readonly<Line>,\r\n  b: Readonly<Line>\r\n): Vector2 | null {\r\n  // y = mx+b\r\n  // m1*x+b1 = m2*x+b2\r\n  // b1 = m2*x - m1*x + b2\r\n  // b1 - b2 = m2*x - m1*x\r\n  // b1 - b2 = x*(m2 - m1)\r\n  // (b1 - b2) / (m2 - m1) = x\r\n\r\n  // y = mx+b\r\n  // y - b = mx\r\n  // (y - b)/m = x\r\n\r\n  const am = (a.p2.y - a.p1.y) / (a.p2.x - a.p1.x);\r\n  const ab = a.p1.y - am * a.p1.x;\r\n\r\n  const bm = (b.p2.y - b.p1.y) / (b.p2.x - b.p1.x);\r\n  const bb = b.p1.y - bm * b.p1.x;\r\n\r\n  if (bm - am === 0) {\r\n    // parallel lines\r\n    return null;\r\n  }\r\n\r\n  let x: number, y: number;\r\n  if (!Number.isFinite(am)) {\r\n    // a is vertical line\r\n    y = bm * a.p1.x + bb;\r\n    x = a.p1.x;\r\n  } else if (!Number.isFinite(bm)) {\r\n    // b is vertical line\r\n    y = am * b.p1.x + ab;\r\n    x = b.p1.x;\r\n  } else {\r\n    x = (ab - bb) / (bm - am);\r\n    y = am * x + ab;\r\n  }\r\n\r\n  const intercept: Vector2 = {\r\n    x,\r\n    y\r\n  };\r\n\r\n  // Check to see if intercept is within the lines\r\n  if (!pointInRange(intercept, a.p1, a.p2)) {\r\n    return null;\r\n  }\r\n  if (!pointInRange(intercept, b.p1, b.p2)) {\r\n    return null;\r\n  }\r\n\r\n  return intercept;\r\n}\r\n\r\nfunction pointInRange(\r\n  p: Readonly<Vector2>,\r\n  a: Readonly<Vector2>,\r\n  b: Readonly<Vector2>\r\n): boolean {\r\n  const minX = Math.min(a.x, b.x);\r\n  const maxX = Math.max(a.x, b.x);\r\n  const minY = Math.min(a.y, b.y);\r\n  const maxY = Math.max(a.y, b.y);\r\n  return p.x >= minX && p.x <= maxX && p.y >= minY && p.y <= maxY;\r\n}\r\n","export * from \"./theme\";\r\nexport * from \"./utils\";\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_TICK = \"boing/tick\";\r\nexport const tick = (millis: number) => ({\r\n  type: ACTION_TICK as typeof ACTION_TICK,\r\n  payload: { millisElapsed: millis }\r\n});\r\nexport type TickAction = ReturnType<typeof tick>;\r\nexport function isTickAction(action: AnyAction): action is TickAction {\r\n  return action.type === ACTION_TICK;\r\n}\r\n","export interface IdentityObject {\r\n  id: string;\r\n}\r\n\r\nexport interface IdentityCollection<T extends IdentityObject> {\r\n  [id: string]: T;\r\n}\r\n\r\nexport function identities(collection: IdentityCollection<any>): string[] {\r\n  return Object.keys(collection);\r\n}\r\nexport function values<T extends IdentityObject>(\r\n  collection: IdentityCollection<T>\r\n): T[] {\r\n  return Object.keys(collection).map(id => collection[id]);\r\n}\r\n","const PIXELS_PER_INCH = 96;\r\n\r\nconst theme = {\r\n  pixelsPerMeter: 1 * PIXELS_PER_INCH\r\n};\r\nexport default theme;\r\n\r\nexport type Theme = typeof theme;\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_RESET = \"boing/reset\";\r\nexport const reset = () => ({\r\n  type: ACTION_RESET as typeof ACTION_RESET\r\n});\r\nexport type ResetAction = ReturnType<typeof reset>;\r\nexport function isResetAction(action: AnyAction): action is ResetAction {\r\n  return action.type === ACTION_RESET;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { Vector2 } from \"@/math\";\r\n\r\nexport const ACTION_CREATE_BOUNCER = \"boing/create-bouncer\";\r\nexport const createBouncer = (p1: Vector2, p2: Vector2) => ({\r\n  type: ACTION_CREATE_BOUNCER as typeof ACTION_CREATE_BOUNCER,\r\n  payload: { p1, p2 }\r\n});\r\nexport type CreateBouncerAction = ReturnType<typeof createBouncer>;\r\nexport function isCreateBouncerAction(\r\n  action: AnyAction\r\n): action is CreateBouncerAction {\r\n  return action.type === ACTION_CREATE_BOUNCER;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_MOVE_EMITTER = \"boing/move-emitter\";\r\nexport const moveEmitter = (id: string, x: number, y: number) => ({\r\n  type: ACTION_MOVE_EMITTER as typeof ACTION_MOVE_EMITTER,\r\n  payload: { id, x, y }\r\n});\r\nexport type MoveEmitterAction = ReturnType<typeof moveEmitter>;\r\nexport function isMoveEmitterAction(\r\n  action: AnyAction\r\n): action is MoveEmitterAction {\r\n  return action.type === ACTION_MOVE_EMITTER;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { Vector2 } from \"@/math\";\r\n\r\nexport const ACTION_MOVE_BOUNCER = \"boing/move-bouncer\";\r\nexport const moveBouncer = (id: string, p1: Vector2, p2: Vector2) => ({\r\n  type: ACTION_MOVE_BOUNCER as typeof ACTION_MOVE_BOUNCER,\r\n  payload: { id, p1, p2 }\r\n});\r\nexport type MoveBouncerAction = ReturnType<typeof moveBouncer>;\r\nexport function isMoveBouncerAction(\r\n  action: AnyAction\r\n): action is MoveBouncerAction {\r\n  return action.type === ACTION_MOVE_BOUNCER;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_SET_EMITTER_RATE = \"boing/set-emitter-rate\";\r\nexport const setEmitterRate = (id: string, rate: number) => ({\r\n  type: ACTION_SET_EMITTER_RATE as typeof ACTION_SET_EMITTER_RATE,\r\n  payload: { id, rate }\r\n});\r\nexport type SetEmitterRateAction = ReturnType<typeof setEmitterRate>;\r\nexport function isSetEmitterRateAction(\r\n  action: AnyAction\r\n): action is SetEmitterRateAction {\r\n  return action.type === ACTION_SET_EMITTER_RATE;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_SET_EMITTER_DIRECTION = \"boing/set-emitter-direction\";\r\nexport const setEmitterDirection = (id: string, angle: number) => ({\r\n  type: ACTION_SET_EMITTER_DIRECTION as typeof ACTION_SET_EMITTER_DIRECTION,\r\n  payload: { id, angle }\r\n});\r\nexport type SetEmitterDirectionAction = ReturnType<typeof setEmitterDirection>;\r\nexport function isSetEmitterDirectionAction(\r\n  action: AnyAction\r\n): action is SetEmitterDirectionAction {\r\n  return action.type === ACTION_SET_EMITTER_DIRECTION;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_SET_SIZE = \"boing/set-size\";\r\nexport const setSize = (x: number, y: number) => ({\r\n  type: ACTION_SET_SIZE as typeof ACTION_SET_SIZE,\r\n  payload: { x, y }\r\n});\r\nexport type SetSizeAction = ReturnType<typeof setSize>;\r\nexport function isSetSizeAction(action: AnyAction): action is SetSizeAction {\r\n  return action.type === ACTION_SET_SIZE;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nexport const ACTION_SET_GRAVITY_DIRECTION = \"boing/set-gravity-direction\";\r\nexport const setGravityDirection = (angle: number) => ({\r\n  type: ACTION_SET_GRAVITY_DIRECTION as typeof ACTION_SET_GRAVITY_DIRECTION,\r\n  payload: { angle }\r\n});\r\nexport type SetGravityDirectionAction = ReturnType<typeof setGravityDirection>;\r\nexport function isSetGravityDirectionAction(\r\n  action: AnyAction\r\n): action is SetGravityDirectionAction {\r\n  return action.type === ACTION_SET_GRAVITY_DIRECTION;\r\n}\r\n\r\nexport const ACTION_SET_GRAVITY_POWER = \"boing/set-gravity-power\";\r\nexport const setGravityStrength = (strength: number) => ({\r\n  type: ACTION_SET_GRAVITY_POWER as typeof ACTION_SET_GRAVITY_POWER,\r\n  payload: { strength }\r\n});\r\nexport type SetGravityStrengthAction = ReturnType<typeof setGravityStrength>;\r\nexport function isSetGravityStrengthAction(\r\n  action: AnyAction\r\n): action is SetGravityStrengthAction {\r\n  return action.type === ACTION_SET_GRAVITY_POWER;\r\n}\r\n","import Tone from \"tone\";\r\n\r\n// We are triggering tones in response to visual events, so we need\r\n//  the tone to occur without any delay.\r\n// Remove the lookAhead scheduling to play the tone asap.\r\nTone.context.lookAhead = 0;\r\n\r\nlet synth: any = null;\r\nexport function init() {\r\n  Tone.start();\r\n  (window as any).testSynth = new Tone.AMSynth().toMaster();\r\n  synth = new Tone.PolySynth(6, Tone.AMSynth).toMaster();\r\n}\r\n\r\nexport default function playTone(tone: number, time: string) {\r\n  if (!synth) {\r\n    return;\r\n  }\r\n  synth.triggerAttackRelease(tone, time);\r\n}\r\n","import * as React from \"react\";\r\n\r\nimport { Vector2 } from \"@/math\";\r\n\r\nexport interface ClientPos {\r\n  clientX: number;\r\n  clientY: number;\r\n}\r\n\r\nexport interface DragEvent {\r\n  clientX: number;\r\n  clientY: number;\r\n  start: ClientPos;\r\n  dX: number;\r\n  dY: number;\r\n}\r\n\r\nexport interface UsePointerEvents {\r\n  start: ClientPos | null;\r\n  end: ClientPos | null;\r\n  pointerDown(e: React.PointerEvent<Element>): void;\r\n  pointerMove(e: React.PointerEvent<Element>): void;\r\n  pointerUp(e: React.PointerEvent<Element>): void;\r\n}\r\n\r\nexport default function usePointerDrag(\r\n  onDragComplete: ((e: DragEvent) => void) | null,\r\n  onMove?: (e: DragEvent) => void,\r\n  shouldCapture?: (target: EventTarget) => boolean\r\n) {\r\n  const [mouseDown, setMouseDown] = React.useState<Vector2 | null>(null);\r\n  const [mouseMove, setMouseMove] = React.useState<Vector2 | null>(null);\r\n\r\n  const pointerDown = React.useCallback((e: React.PointerEvent<Element>) => {\r\n    if (shouldCapture && !shouldCapture(e.target)) {\r\n      return;\r\n    }\r\n\r\n    setMouseDown({ x: e.clientX, y: e.clientY });\r\n    e.currentTarget.setPointerCapture(e.pointerId);\r\n\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  }, []);\r\n\r\n  const pointerMove = React.useCallback(\r\n    (e: React.PointerEvent<Element>) => {\r\n      if (!mouseDown) {\r\n        return;\r\n      }\r\n\r\n      if (onMove) {\r\n        const ev: DragEvent = {\r\n          start: {\r\n            clientX: mouseDown.x,\r\n            clientY: mouseDown.y\r\n          },\r\n          clientX: e.clientX,\r\n          clientY: e.clientY,\r\n          dX: e.clientX - mouseDown.x,\r\n          dY: e.clientY - mouseDown.y\r\n        };\r\n        onMove(ev);\r\n      }\r\n\r\n      setMouseMove({ x: e.clientX, y: e.clientY });\r\n\r\n      e.preventDefault();\r\n    },\r\n    [mouseDown, onMove]\r\n  );\r\n\r\n  const pointerUp = React.useCallback(\r\n    (e: React.PointerEvent<Element>) => {\r\n      e.currentTarget.releasePointerCapture(e.pointerId);\r\n\r\n      if (mouseDown) {\r\n        if (onDragComplete) {\r\n          const ev: DragEvent = {\r\n            start: {\r\n              clientX: mouseDown.x,\r\n              clientY: mouseDown.y\r\n            },\r\n            clientX: e.clientX,\r\n            clientY: e.clientY,\r\n            dX: e.clientX - mouseDown.x,\r\n            dY: e.clientY - mouseDown.y\r\n          };\r\n          onDragComplete(ev);\r\n        }\r\n\r\n        setMouseDown(null);\r\n        setMouseMove(null);\r\n\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n      }\r\n    },\r\n    [onDragComplete, mouseDown]\r\n  );\r\n\r\n  return {\r\n    start: mouseDown ? { clientX: mouseDown.x, clientY: mouseDown.y } : null,\r\n    end: mouseMove ? { clientX: mouseMove.x, clientY: mouseMove.y } : null,\r\n    pointerDown,\r\n    pointerMove,\r\n    pointerUp\r\n  };\r\n}\r\n","import { AppState } from \"@/state\";\r\n\r\nexport const ballsByIdSelector = (state: AppState) =>\r\n  state.services.boing.ballsById;\r\n","import MouseReveal from \"./component\";\r\nexport default MouseReveal;\r\n","import { AppState } from \"@/state\";\r\n\r\nexport const bouncersByIdSelector = (state: AppState) =>\r\n  state.services.boing.bouncersById;\r\n","import AngleSvgSlider from \"./component\";\r\nexport default AngleSvgSlider;\r\n","import { AppState } from \"@/state\";\r\n\r\nexport const emittersByIdSelector = (state: AppState) =>\r\n  state.services.boing.emittersById;\r\n","import \"es6-promise/auto\";\r\nimport \"resize-observer-polyfill\";\r\n\r\nimport \"@/style.css\";\r\n\r\nimport * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\n\r\nimport Root from \"./root\";\r\n\r\nconst rootEl = document.getElementById(\"root\");\r\nif (rootEl) {\r\n  ReactDOM.render(<Root />, rootEl);\r\n}\r\n","\nvar content = require(\"!!../node_modules/css-loader/dist/cjs.js!./style.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/css-loader/dist/cjs.js!./style.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/css-loader/dist/cjs.js!./style.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"/*\\r\\nThis should be kept minimal and only provide globals\\r\\nor non-react component styles.\\r\\n*/\\r\\n\\r\\nhtml,\\r\\nbody,\\r\\n#root {\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  margin: 0;\\r\\n  /*\\r\\n  Chrome is showing a rogue scroll bar, possibly due to the svg element.\\r\\n  All sizes are equal to the browser size, but a rogue margin appears along the bottom edge\\r\\n  */\\r\\n  overflow: hidden;\\r\\n}\\r\\n\", \"\"]);\n\n","import * as React from \"react\";\r\n\r\nimport ThemeProvider from \"@/theme/components/ThemeProvider\";\r\nimport StoreProvider from \"@/store/components/StoreProvider\";\r\n\r\nimport App from \"@/components/App\";\r\n\r\nconst Root: React.FC = () => (\r\n  <ThemeProvider>\r\n    <StoreProvider>\r\n      <App />\r\n    </StoreProvider>\r\n  </ThemeProvider>\r\n);\r\n\r\nexport default Root;\r\n","import * as React from \"react\";\r\n\r\nimport { ThemeProvider as JssProvider } from \"react-jss\";\r\n\r\nimport theme from \"../theme\";\r\n\r\nconst ThemeProvider: React.FC = ({ children }) => (\r\n  <JssProvider theme={theme}>\r\n    <>{children}</>\r\n  </JssProvider>\r\n);\r\n\r\nexport default ThemeProvider;\r\n","import * as React from \"react\";\r\n\r\nimport { Provider } from \"react-redux\";\r\n\r\nimport store from \"../store\";\r\n\r\nconst StoreProvider: React.FC = ({ children }) => (\r\n  <Provider store={store}>{children}</Provider>\r\n);\r\nexport default StoreProvider;\r\n","import {\r\n  compose,\r\n  createStore as createReduxStore,\r\n  applyMiddleware\r\n} from \"redux\";\r\n\r\nimport createSagaMiddleware from \"redux-saga\";\r\n\r\nimport reducer from \"./reducer\";\r\nimport saga from \"./saga\";\r\n\r\nimport {\r\n  actionSanitizer,\r\n  stateSanitizer,\r\n  actionsBlacklist\r\n} from \"./devtool-sanitizer\";\r\n\r\nfunction createStore() {\r\n  const composeEnhancers =\r\n    (window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ &&\r\n      window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\r\n        actionSanitizer,\r\n        stateSanitizer,\r\n        actionsBlacklist\r\n      })) ||\r\n    compose;\r\n\r\n  const sagaMiddleware = createSagaMiddleware();\r\n\r\n  const store = createReduxStore(\r\n    reducer,\r\n    composeEnhancers(applyMiddleware(sagaMiddleware))\r\n  );\r\n  sagaMiddleware.run(saga);\r\n  return store;\r\n}\r\n\r\nconst store = createStore();\r\nexport default store;\r\n","import { combineReducers, AnyAction } from \"redux\";\r\n\r\nimport { AppState, defaultAppState } from \"@/state\";\r\n\r\nimport boingServiceReducer from \"@/services/boing/reducer\";\r\n\r\nconst servicesReducer = combineReducers({\r\n  boing: boingServiceReducer\r\n});\r\n\r\nexport default function reducer(\r\n  state: AppState = defaultAppState,\r\n  action: AnyAction\r\n): AppState {\r\n  return {\r\n    services: servicesReducer(state.services, action)\r\n  };\r\n}\r\n","import {\r\n  BoingServiceState,\r\n  defaultBoingServiceState\r\n} from \"@/services/boing/state\";\r\n\r\nexport interface AppState {\r\n  services: {\r\n    boing: BoingServiceState;\r\n  };\r\n}\r\n\r\nexport const defaultAppState: Readonly<AppState> = Object.freeze({\r\n  services: {\r\n    boing: defaultBoingServiceState\r\n  }\r\n});\r\n","export const SECOND_AS_MILLIS = 1000;\r\n","import reduceReducers from \"reduce-reducers\";\r\nimport { AnyAction } from \"redux\";\r\n\r\nimport { BoingServiceState, defaultBoingServiceState } from \"../state\";\r\n\r\nimport { isTickAction } from \"../actions/tick\";\r\n\r\nimport reset from \"./reset\";\r\nimport tickEmittersReducer from \"./tick-emitters\";\r\nimport tickBallsReducer from \"./tick-balls\";\r\nimport createBouncerReducer from \"./create-bouncer\";\r\nimport moveEmitterReducer from \"./move-emitter\";\r\nimport moveBouncerReducer from \"./move-bouncer\";\r\nimport setEmitterRateReducer from \"./set-emitter-rate\";\r\nimport setEmitterVelocityReducer from \"./set-emitter-velocity\";\r\nimport setSizeReducer from \"./set-size\";\r\nimport setGravityReducer from \"./set-gravity\";\r\n\r\nconst childReducers = reduceReducers(\r\n  reset,\r\n  tickEmittersReducer,\r\n  tickBallsReducer,\r\n  createBouncerReducer,\r\n  moveEmitterReducer,\r\n  moveBouncerReducer,\r\n  setEmitterRateReducer,\r\n  setEmitterVelocityReducer,\r\n  setSizeReducer,\r\n  setGravityReducer\r\n);\r\n\r\nexport default function reducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n) {\r\n  if (isTickAction(action)) {\r\n    state = {\r\n      ...state,\r\n      tick: state.tick + action.payload.millisElapsed\r\n    };\r\n  }\r\n\r\n  return childReducers(state, action);\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport { BoingServiceState, defaultBoingServiceState } from \"../state\";\r\nimport { isResetAction } from \"../actions/reset\";\r\n\r\nexport default function resetReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (isResetAction(action)) {\r\n    return defaultBoingServiceState;\r\n  }\r\n  return state;\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport uuid from \"uuid/v4\";\r\n\r\nimport {\r\n  BoingServiceState,\r\n  defaultBoingServiceState,\r\n  defaultBallState\r\n} from \"../state\";\r\n\r\nimport { identities } from \"@/identity\";\r\nimport { VEC_ZERO } from \"@/math\";\r\n\r\nimport { isTickAction } from \"../actions/tick\";\r\n\r\nexport default function tickEmittersReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (!isTickAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  for (const emitterId of identities(state.emittersById)) {\r\n    const emitter = state.emittersById[emitterId];\r\n    if (state.tick - emitter.lastEmit >= emitter.rate) {\r\n      const newBallId = uuid();\r\n      state = {\r\n        ...state,\r\n        emittersById: {\r\n          ...state.emittersById,\r\n          [emitterId]: {\r\n            ...state.emittersById[emitterId],\r\n            lastEmit: state.tick\r\n          }\r\n        },\r\n        ballsById: {\r\n          ...state.ballsById,\r\n          [newBallId]: {\r\n            ...defaultBallState,\r\n            id: newBallId,\r\n            position: emitter.position,\r\n            velocity: emitter.velocity\r\n          }\r\n        }\r\n      };\r\n    }\r\n  }\r\n\r\n  return state;\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport { first } from \"lodash\";\r\nimport { set, unset } from \"lodash/fp\";\r\n\r\nimport {\r\n  add,\r\n  scale,\r\n  Line,\r\n  intercept,\r\n  length,\r\n  Vector2,\r\n  angle,\r\n  vector,\r\n  magnitude,\r\n  VEC_X,\r\n  subtract\r\n} from \"@/math\";\r\nimport { isNotNull } from \"@/utils\";\r\nimport { values, identities } from \"@/identity\";\r\n\r\nimport {\r\n  BoingServiceState,\r\n  defaultBoingServiceState,\r\n  BallState,\r\n  BouncerState\r\n} from \"../state\";\r\n\r\nimport { isTickAction } from \"../actions/tick\";\r\n\r\nexport default function tickBallsReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (!isTickAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { millisElapsed } = action.payload;\r\n\r\n  const ballIds = identities(state.ballsById);\r\n\r\n  state = ballIds.reduce(\r\n    (state, id) => tickBall(state, id, millisElapsed),\r\n    state\r\n  );\r\n\r\n  return state;\r\n}\r\n\r\nfunction tickBall(\r\n  state: BoingServiceState,\r\n  ballId: string,\r\n  millisElapsed: number\r\n): BoingServiceState {\r\n  const { gravity, fieldMin, fieldMax, ballsById: balls } = state;\r\n  const ball = balls[ballId];\r\n\r\n  let velocity = add(ball.velocity, scale(gravity, millisElapsed));\r\n  let position = add(ball.position, velocity);\r\n\r\n  if (\r\n    position.x < fieldMin.x ||\r\n    position.x > fieldMax.x ||\r\n    position.y > fieldMax.y\r\n  ) {\r\n    return unset([\"ballsById\", ballId], state);\r\n  }\r\n\r\n  // Trace a line from the ball's previous position to the\r\n  //  current position, then see if it intercepts a bouncer\r\n  const movementLine: Line = { p1: ball.position, p2: position };\r\n  const movementVec: Vector2 = subtract(movementLine.p1, movementLine.p2);\r\n  const interceptData = interceptBouncer(movementLine, state);\r\n\r\n  if (interceptData) {\r\n    const { bouncerId, intercept } = interceptData;\r\n    const bouncer = state.bouncersById[bouncerId];\r\n    const bouncerVec = subtract(bouncer.p2, bouncer.p1);\r\n\r\n    const interceptAngle = angle(bouncerVec, movementVec);\r\n    const lineAngle = angle(VEC_X, bouncerVec);\r\n    const bounceAngle = lineAngle + (Math.PI - interceptAngle);\r\n\r\n    let reflect = Math.abs(\r\n      length(movementLine) - length({ p1: ball.position, p2: intercept })\r\n    );\r\n    reflect = Math.max(reflect, 1);\r\n\r\n    position = add(intercept, vector(bounceAngle, reflect));\r\n    velocity = vector(bounceAngle, magnitude(velocity));\r\n\r\n    const bouncerState: BouncerState = {\r\n      ...bouncer,\r\n      toneTriggerTimestamp: Date.now()\r\n    };\r\n    Object.freeze(bouncerState);\r\n    Object.freeze(bouncerState.p1);\r\n    Object.freeze(bouncerState.p2);\r\n\r\n    state = set([\"bouncersById\", bouncerId], bouncerState, state);\r\n  }\r\n\r\n  const ballState: BallState = {\r\n    ...ball,\r\n    position,\r\n    velocity\r\n  };\r\n  Object.freeze(ballState);\r\n\r\n  state = set([\"ballsById\", ballId], ballState, state);\r\n\r\n  return state;\r\n}\r\n\r\nfunction interceptBouncer(\r\n  line: Line,\r\n  state: BoingServiceState\r\n): { bouncerId: string; intercept: Vector2 } | null {\r\n  const intercepts = values(state.bouncersById)\r\n    .map(bouncer => {\r\n      const i = intercept(line, bouncer);\r\n      if (i) {\r\n        return {\r\n          bouncerId: bouncer.id,\r\n          intercept: i\r\n        };\r\n      }\r\n      return null;\r\n    })\r\n    .filter(isNotNull);\r\n  return first(intercepts) || null;\r\n}\r\n","export function isNotNull<T>(val: T | null | undefined): val is T {\r\n  return val != null;\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport uuid from \"uuid/v4\";\r\n\r\nimport {\r\n  defaultBoingServiceState,\r\n  BoingServiceState,\r\n  defaultBouncerState\r\n} from \"../state\";\r\n\r\nimport { isCreateBouncerAction } from \"../actions/create-bouncer\";\r\n\r\nexport default function createBouncerReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (!isCreateBouncerAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { p1, p2 } = action.payload;\r\n  const id = uuid();\r\n\r\n  return {\r\n    ...state,\r\n    bouncersById: {\r\n      ...state.bouncersById,\r\n      [id]: {\r\n        ...defaultBouncerState,\r\n        id,\r\n        p1,\r\n        p2\r\n      }\r\n    }\r\n  };\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport { set } from \"lodash/fp\";\r\n\r\nimport {\r\n  BoingServiceState,\r\n  defaultBoingServiceState,\r\n  EmitterState\r\n} from \"../state\";\r\n\r\nimport { isMoveEmitterAction } from \"../actions/move-emitter\";\r\n\r\nexport default function moveEmitterReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (!isMoveEmitterAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { id, x, y } = action.payload;\r\n\r\n  const emitter = state.emittersById[id];\r\n  if (!emitter) {\r\n    return state;\r\n  }\r\n\r\n  const newEmitter: EmitterState = {\r\n    ...emitter,\r\n    position: { x, y }\r\n  };\r\n\r\n  return set([\"emittersById\", id], newEmitter, state);\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport { set } from \"lodash/fp\";\r\n\r\nimport {\r\n  BoingServiceState,\r\n  defaultBoingServiceState,\r\n  BouncerState\r\n} from \"../state\";\r\n\r\nimport { isMoveBouncerAction } from \"../actions/move-bouncer\";\r\n\r\nexport default function moveBouncerReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (!isMoveBouncerAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { id, p1, p2 } = action.payload;\r\n\r\n  const bouncer = state.bouncersById[id];\r\n  if (!bouncer) {\r\n    return state;\r\n  }\r\n\r\n  const newBouncer: BouncerState = {\r\n    ...bouncer,\r\n    p1,\r\n    p2\r\n  };\r\n\r\n  return set([\"bouncersById\", id], newBouncer, state);\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport { set } from \"lodash/fp\";\r\n\r\nimport {\r\n  BoingServiceState,\r\n  defaultBoingServiceState,\r\n  EmitterState\r\n} from \"../state\";\r\nimport { isSetEmitterRateAction } from \"../actions/set-emitter-rate\";\r\n\r\nexport default function setEmitterRateReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (!isSetEmitterRateAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const { id, rate } = action.payload;\r\n\r\n  const emitter = state.emittersById[id];\r\n  if (!emitter) {\r\n    return state;\r\n  }\r\n\r\n  const newEmitter: EmitterState = {\r\n    ...emitter,\r\n    rate\r\n  };\r\n\r\n  return set([\"emittersById\", id], newEmitter, state);\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport { set } from \"lodash/fp\";\r\n\r\nimport {\r\n  BoingServiceState,\r\n  defaultBoingServiceState,\r\n  EmitterState\r\n} from \"../state\";\r\nimport { isSetEmitterDirectionAction } from \"../actions/set-emitter-velocity\";\r\nimport { vector, magnitude } from \"@/math\";\r\n\r\nexport default function setEmitterVelocityReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (isSetEmitterDirectionAction(action)) {\r\n    const { id, angle } = action.payload;\r\n    const emitter = state.emittersById[id];\r\n    if (!emitter) {\r\n      return state;\r\n    }\r\n    const newEmitter: EmitterState = {\r\n      ...emitter,\r\n      velocity: vector(angle, magnitude(emitter.velocity))\r\n    };\r\n    return set([\"emittersById\", id], newEmitter, state);\r\n  }\r\n\r\n  return state;\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { BoingServiceState, defaultBoingServiceState } from \"../state\";\r\n\r\nimport { isSetSizeAction } from \"../actions/set-size\";\r\n\r\nexport default function setSizeReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (!isSetSizeAction(action)) {\r\n    return state;\r\n  }\r\n\r\n  const size = action.payload;\r\n\r\n  return {\r\n    ...state,\r\n    fieldMax: size\r\n  };\r\n}\r\n","import { AnyAction } from \"redux\";\r\nimport { vector, magnitude, angle, VEC_X } from \"@/math\";\r\n\r\nimport { BoingServiceState, defaultBoingServiceState } from \"../state\";\r\nimport {\r\n  isSetGravityDirectionAction,\r\n  isSetGravityStrengthAction\r\n} from \"../actions/set-gravity\";\r\n\r\nexport default function setGravityReducer(\r\n  state: BoingServiceState = defaultBoingServiceState,\r\n  action: AnyAction\r\n): BoingServiceState {\r\n  if (isSetGravityDirectionAction(action)) {\r\n    const { angle } = action.payload;\r\n    return {\r\n      ...state,\r\n      gravity: vector(angle, magnitude(state.gravity))\r\n    };\r\n  }\r\n\r\n  if (isSetGravityStrengthAction(action)) {\r\n    const { strength } = action.payload;\r\n    return {\r\n      ...state,\r\n      gravity: vector(angle(VEC_X, state.gravity), strength)\r\n    };\r\n  }\r\n\r\n  return state;\r\n}\r\n","import { fork } from \"redux-saga/effects\";\r\n\r\nimport boingSaga from \"@/services/boing/saga\";\r\n\r\nexport default function* rootSaga(): IterableIterator<any> {\r\n  yield fork(boingSaga);\r\n}\r\n","import tickSaga from \"./tick\";\r\n\r\nexport default tickSaga;\r\n","import { eventChannel } from \"redux-saga\";\r\nimport { takeEvery, put } from \"redux-saga/effects\";\r\n\r\nimport { tick } from \"@/services/boing/actions/tick\";\r\n\r\n// Allowing us to calculate the offset seems to cause crazyness,\r\n//  rounding errors?\r\nconst FIXED_TIME = true;\r\n\r\nexport default function* tickSaga() {\r\n  yield takeEvery(interval(10), onTick);\r\n}\r\n\r\nfunction* onTick(elapsedMillis: number) {\r\n  yield put(tick(elapsedMillis));\r\n}\r\n\r\nfunction interval(delayMillis: number) {\r\n  let previous = Date.now();\r\n  return eventChannel(emitter => {\r\n    const iv = setInterval(() => {\r\n      const current = Date.now();\r\n      const elapsed = current - previous;\r\n      emitter(FIXED_TIME ? 10 : elapsed);\r\n      previous - current;\r\n    }, delayMillis);\r\n    return () => {\r\n      clearInterval(iv);\r\n    };\r\n  });\r\n}\r\n","import { AnyAction } from \"redux\";\r\n\r\nimport { AppState } from \"@/state\";\r\n\r\nimport { ACTION_TICK } from \"@/services/boing/actions/tick\";\r\n\r\nexport const actionsBlacklist: string[] = [ACTION_TICK];\r\n\r\nexport function actionSanitizer(action: AnyAction): AnyAction {\r\n  return action;\r\n}\r\n\r\nexport function stateSanitizer(state: AppState): any {\r\n  return state;\r\n}\r\n","import App from \"./component\";\r\nexport default App;\r\n","import * as React from \"react\";\r\nimport withSheet from \"react-jss\";\r\n\r\nimport { createStyles, WithStyles } from \"@/theme\";\r\n\r\nimport Game from \"../Game\";\r\n\r\nconst styles = createStyles({\r\n  game: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  }\r\n});\r\n\r\ntype Props = WithStyles<typeof styles>;\r\nconst App: React.FC<Props> = ({ classes }) => {\r\n  return <Game className={classes.game} />;\r\n};\r\n\r\nexport default withSheet(styles)(App);\r\n","import { CSSProperties } from \"react-jss\";\r\n\r\nexport function createStyles<C extends string>(\r\n  styles: Record<C, CSSProperties<{}>>\r\n): Record<C, CSSProperties<{}>> {\r\n  return styles;\r\n}\r\n\r\nexport type WithStyles<T> = { classes: { [K in keyof T]: string } };\r\n","import Game from \"./component\";\r\nimport connectGame from \"./connector\";\r\n\r\nexport default connectGame(Game);\r\n","import * as React from \"react\";\r\nimport useComponentSize from \"@rehooks/component-size\";\r\nimport injectSheet from \"react-jss\";\r\n\r\nimport { createStyles, WithStyles } from \"@/theme\";\r\n\r\nimport { init } from \"@/tone\";\r\n\r\nimport { Vector2, VEC_ZERO, magnitude, subtract } from \"@/math\";\r\n\r\nimport usePointerDrag, { DragEvent } from \"@/hooks/use-pointer-drag\";\r\n\r\nimport BallField from \"../BallField\";\r\nimport BouncerField from \"../BouncerField\";\r\nimport EmitterField from \"../EmitterField\";\r\nimport GravityDirectionSlider from \"../GravityDirectionSlider\";\r\nimport ResetButton from \"../ResetButton\";\r\nimport PlayButton from \"../PlayButton\";\r\n\r\nexport interface GameProps {\r\n  className?: string;\r\n  onCreateBouncer(p1: Vector2, p2: Vector2): void;\r\n  onResize(x: number, y: number): void;\r\n}\r\n\r\nconst styles = createStyles({\r\n  svg: {\r\n    touchAction: \"none\"\r\n  }\r\n});\r\n\r\ntype Props = GameProps & WithStyles<typeof styles>;\r\nconst Game: React.FC<Props> = ({\r\n  className,\r\n  classes,\r\n  onCreateBouncer,\r\n  onResize\r\n}) => {\r\n  const [started, setStarted] = React.useState(false);\r\n  const rootRef = React.useRef(null);\r\n  const svgRef = React.useRef(null);\r\n\r\n  const onStart = React.useCallback(() => {\r\n    setStarted(true);\r\n    init();\r\n  }, []);\r\n\r\n  const createBouncerDragRelease = React.useCallback(\r\n    (e: DragEvent) => {\r\n      const start = { x: e.start.clientX, y: e.start.clientY };\r\n      const end = { x: e.clientX, y: e.clientY };\r\n      const length = Math.abs(magnitude(subtract(start, end)));\r\n      if (length >= 10) {\r\n        onCreateBouncer(start, end);\r\n      }\r\n    },\r\n    [onCreateBouncer]\r\n  );\r\n\r\n  const createBouncer = usePointerDrag(\r\n    createBouncerDragRelease,\r\n    undefined,\r\n    target => target === svgRef.current\r\n  );\r\n\r\n  const [oldSize, setOldSize] = React.useState(VEC_ZERO);\r\n  const size = useComponentSize(rootRef);\r\n  if (size.width !== oldSize.x || size.height !== oldSize.y) {\r\n    setOldSize({ x: size.width, y: size.height });\r\n    onResize(size.width, size.height);\r\n  }\r\n\r\n  return (\r\n    <div className={className} ref={rootRef}>\r\n      <svg\r\n        ref={svgRef}\r\n        className={classes.svg}\r\n        width={`${size.width}`}\r\n        height={`${size.height}`}\r\n        viewBox={`0 0 ${size.width} ${size.height}`}\r\n        onPointerDown={createBouncer.pointerDown}\r\n        onPointerMove={createBouncer.pointerMove}\r\n        onPointerUp={createBouncer.pointerUp}\r\n      >\r\n        <GravityDirectionSlider\r\n          r={15}\r\n          cx={size.width - 35}\r\n          cy={size.height - 35}\r\n        />\r\n        <ResetButton x={15} y={size.height - 35} onClick={() => {}} />\r\n        <BallField />\r\n        <BouncerField />\r\n        <EmitterField />\r\n        {createBouncer.start && createBouncer.end && (\r\n          <line\r\n            x1={createBouncer.start.clientX}\r\n            y1={createBouncer.start.clientY}\r\n            x2={createBouncer.end.clientX}\r\n            y2={createBouncer.end.clientY}\r\n            stroke=\"darkgrey\"\r\n          />\r\n        )}\r\n\r\n        {!started && (\r\n          <g>\r\n            <rect\r\n              x={0}\r\n              y={0}\r\n              width={size.width}\r\n              height={size.height}\r\n              opacity={0.4}\r\n              fill=\"dimgrey\"\r\n            />\r\n            <PlayButton\r\n              x={size.width / 2 - 128}\r\n              y={size.height / 2 - 128}\r\n              onClick={onStart}\r\n            />\r\n          </g>\r\n        )}\r\n      </svg>\r\n    </div>\r\n  );\r\n};\r\nexport default injectSheet(styles)(Game);\r\n","import BallField from \"./component\";\r\nimport connectBallField from \"./connector\";\r\nexport default connectBallField(BallField);\r\n","import * as React from \"react\";\r\n\r\nimport Ball from \"../Ball\";\r\n\r\nexport interface BallFieldProps {\r\n  ballIds: string[];\r\n}\r\n\r\nconst BallField: React.FC<BallFieldProps> = ({ ballIds }) => (\r\n  <g>\r\n    {ballIds.map(id => (\r\n      <Ball key={id} id={id} />\r\n    ))}\r\n  </g>\r\n);\r\n\r\nexport default BallField;\r\n","import Ball from \"./component\";\r\nimport connectBall from \"./connector\";\r\nexport default connectBall(Ball);\r\n","import * as React from \"react\";\r\n\r\nimport { Vector2 } from \"@/math\";\r\n\r\nexport interface BallProps {\r\n  position: Vector2;\r\n}\r\n\r\nconst Ball: React.FC<BallProps> = ({ position }) => {\r\n  return <circle r={3} cx={position.x} cy={position.y} />;\r\n};\r\n\r\nexport default Ball;\r\n","import { connect } from \"react-redux\";\r\nimport { pick } from \"lodash\";\r\n\r\nimport { AppState } from \"@/state\";\r\nimport { ballsByIdSelector } from \"@/services/boing/selectors/balls\";\r\n\r\nexport interface BallInputProps {\r\n  id: string;\r\n}\r\n\r\nfunction mapStateToProps(state: AppState, props: BallInputProps) {\r\n  const { id } = props;\r\n  const ball = ballsByIdSelector(state)[id];\r\n  return pick(ball, [\"position\"]);\r\n}\r\n\r\nexport default connect(mapStateToProps);\r\n","import { connect } from \"react-redux\";\r\n\r\nimport { identities } from \"@/identity\";\r\n\r\nimport { AppState } from \"@/state\";\r\n\r\nimport { ballsByIdSelector } from \"@/services/boing/selectors/balls\";\r\n\r\nfunction mapStateToProps(state: AppState) {\r\n  const ballsById = ballsByIdSelector(state);\r\n  const ballIds = identities(ballsById);\r\n\r\n  return {\r\n    ballIds\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps);\r\n","import BouncerField from \"./component\";\r\nimport connectBallField from \"./connector\";\r\nexport default connectBallField(BouncerField);\r\n","import * as React from \"react\";\r\n\r\nimport Bouncer from \"../Bouncer\";\r\n\r\nexport interface BouncerFieldProps {\r\n  bouncerIds: string[];\r\n}\r\n\r\nconst BouncerField: React.FC<BouncerFieldProps> = ({ bouncerIds }) => (\r\n  <g>\r\n    {bouncerIds.map(id => (\r\n      <Bouncer key={id} id={id} />\r\n    ))}\r\n  </g>\r\n);\r\n\r\nexport default BouncerField;\r\n","import Bouncer from \"./component\";\r\nimport connectBouncer from \"./connector\";\r\nexport default connectBouncer(Bouncer);\r\n","import * as React from \"react\";\r\n\r\nimport playTone from \"@/tone\";\r\nimport { Vector2, constrain, length, subtract, add } from \"@/math\";\r\n\r\nimport DragHandle from \"../DragHandle\";\r\nimport MouseReveal from \"../MouseReveal\";\r\n\r\nexport interface BouncerProps {\r\n  toneTriggerTimestamp: number;\r\n  p1: Vector2;\r\n  p2: Vector2;\r\n  onMove(p1: Vector2, p2: Vector2): void;\r\n}\r\n\r\nconst Bouncer: React.FC<BouncerProps> = ({\r\n  p1,\r\n  p2,\r\n  toneTriggerTimestamp,\r\n  onMove\r\n}) => {\r\n  const [lastTone, setLastTone] = React.useState(0);\r\n  if (toneTriggerTimestamp > lastTone) {\r\n    setLastTone(toneTriggerTimestamp);\r\n    const l = length({ p1, p2 });\r\n    const tone = getTone(l);\r\n    playTone(tone, \"32n\");\r\n  }\r\n\r\n  const onP1Move = React.useCallback(\r\n    (x: number, y: number) => {\r\n      onMove({ x, y }, p2);\r\n    },\r\n    [onMove, p2]\r\n  );\r\n\r\n  const onP2Move = React.useCallback(\r\n    (x: number, y: number) => {\r\n      onMove(p1, { x, y });\r\n    },\r\n    [onMove, p1]\r\n  );\r\n\r\n  const center = {\r\n    x: p1.x + (p2.x - p1.x) / 2,\r\n    y: p1.y + (p2.y - p1.y) / 2\r\n  };\r\n\r\n  const onCenterMove = React.useCallback(\r\n    (x: number, y: number) => {\r\n      const pt = { x, y };\r\n      const movement = subtract(pt, center);\r\n      onMove(add(p1, movement), add(p2, movement));\r\n    },\r\n    [onMove, p1, [2]]\r\n  );\r\n\r\n  return (\r\n    <g>\r\n      <line x1={p1.x} y1={p1.y} x2={p2.x} y2={p2.y} stroke=\"black\" />\r\n      <MouseReveal originVec={p1} revealDistance={25}>\r\n        <DragHandle x={p1.x} y={p1.y} onDrag={onP1Move} />\r\n      </MouseReveal>\r\n      <MouseReveal originVec={p2} revealDistance={25}>\r\n        <DragHandle x={p2.x} y={p2.y} onDrag={onP2Move} />\r\n      </MouseReveal>\r\n      <MouseReveal originVec={center} revealDistance={25}>\r\n        <DragHandle x={center.x} y={center.y} onDrag={onCenterMove} />\r\n      </MouseReveal>\r\n    </g>\r\n  );\r\n};\r\n\r\nconst TONE_MIN = 50;\r\nconst TONE_MAX = 1400;\r\n\r\nconst LENGTH_MIN = 50;\r\nconst LENGTH_MAX = 500;\r\nfunction getTone(length: number): number {\r\n  // (length - minLength ) / (maxLength) = (tone - minTone) / (maxTone)\r\n  // (length - minLength) / maxLength * maxTone = tone - minTone\r\n  length = constrain(LENGTH_MAX - length, LENGTH_MIN, LENGTH_MAX);\r\n  return (\r\n    ((length - LENGTH_MIN) / (LENGTH_MAX - LENGTH_MIN)) *\r\n      (TONE_MAX - TONE_MIN) +\r\n    TONE_MIN\r\n  );\r\n}\r\n\r\nexport default Bouncer;\r\n","import DragHandle from \"./component\";\r\nexport default DragHandle;\r\n","import * as React from \"react\";\r\nimport injectSheet from \"react-jss\";\r\n\r\nimport { createStyles, WithStyles } from \"@/theme\";\r\n\r\nexport interface DragHandleProps {\r\n  x: number;\r\n  y: number;\r\n  onDrag(x: number, y: number): void;\r\n}\r\n\r\nconst styles = createStyles({\r\n  rect: {\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\ntype Props = DragHandleProps & WithStyles<typeof styles>;\r\nconst DragHandle: React.FC<Props> = ({ x, y, classes, onDrag }) => {\r\n  const ref = React.useRef<SVGCircleElement>(null);\r\n  const [isMoving, setMoving] = React.useState(false);\r\n  const pointerDown = React.useCallback(\r\n    (e: React.PointerEvent<SVGCircleElement>) => {\r\n      if (!ref.current) {\r\n        return;\r\n      }\r\n      ref.current.setPointerCapture(e.pointerId);\r\n      setMoving(true);\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    },\r\n    [ref, setMoving]\r\n  );\r\n  const pointerMove = React.useCallback(\r\n    (e: React.PointerEvent<SVGCircleElement>) => {\r\n      if (!isMoving) {\r\n        return false;\r\n      }\r\n      onDrag(e.clientX, e.clientY);\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    },\r\n    [isMoving]\r\n  );\r\n  const pointerUp = React.useCallback(\r\n    (e: React.PointerEvent<SVGCircleElement>) => {\r\n      if (!ref.current) {\r\n        return;\r\n      }\r\n      ref.current.releasePointerCapture(e.pointerId);\r\n      setMoving(false);\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    },\r\n    [ref, setMoving]\r\n  );\r\n  return (\r\n    <circle\r\n      className={classes.rect}\r\n      ref={ref}\r\n      cx={x}\r\n      cy={y}\r\n      r={6}\r\n      fill=\"darkgrey\"\r\n      onPointerDown={pointerDown}\r\n      onPointerMove={pointerMove}\r\n      onPointerUp={pointerUp}\r\n    />\r\n  );\r\n};\r\n\r\nexport default injectSheet(styles)(DragHandle);\r\n","import * as React from \"react\";\r\n\r\nimport { Vector2 } from \"@/math\";\r\nimport { useMouseDistance } from \"@/hooks/use-mouse-distance\";\r\n\r\nexport interface MouseRevealProps {\r\n  originRef?: React.RefObject<Element | null>;\r\n  originVec?: Vector2;\r\n  revealDistance?: number;\r\n}\r\n\r\nconst MouseReveal: React.FC<MouseRevealProps> = ({\r\n  originRef,\r\n  originVec,\r\n  revealDistance = 50,\r\n  children\r\n}) => {\r\n  if (!originRef && !originVec) {\r\n    console.warn(\"MouseReveal requires originRef or originVec\");\r\n    return <React.Fragment />;\r\n  }\r\n\r\n  const [mouseInRange, setMouseInRange] = React.useState(false);\r\n  const onMouseDistance = React.useCallback(\r\n    (length: number) => {\r\n      if (!mouseInRange && length <= revealDistance) {\r\n        setMouseInRange(true);\r\n      } else if (mouseInRange && length > revealDistance) {\r\n        setMouseInRange(false);\r\n      }\r\n    },\r\n    [mouseInRange]\r\n  );\r\n  useMouseDistance((originRef || originVec) as any, onMouseDistance);\r\n\r\n  return <React.Fragment>{mouseInRange && children}</React.Fragment>;\r\n};\r\n\r\nexport default MouseReveal;\r\n","import * as React from \"react\";\r\nimport { magnitude, Vector2, isVector2 } from \"@/math\";\r\n\r\nexport function useMouseDistance(\r\n  ref: React.RefObject<Element | null> | Vector2,\r\n  onMouseDistanceChanged: (distance: number) => void\r\n) {\r\n  React.useEffect(() => {\r\n    const onMouseMove = (e: MouseEvent) => {\r\n      let origin: Vector2;\r\n      if (isVector2(ref)) {\r\n        origin = ref;\r\n      } else {\r\n        if (!ref.current) {\r\n          return;\r\n        }\r\n        const rect = ref.current.getBoundingClientRect();\r\n        origin = { x: rect.left, y: rect.top };\r\n      }\r\n\r\n      const vec = { x: e.clientX - origin.x, y: e.clientY - origin.y };\r\n      const length = magnitude(vec);\r\n      onMouseDistanceChanged(length);\r\n    };\r\n\r\n    document.addEventListener(\"mousemove\", onMouseMove);\r\n\r\n    return () => {\r\n      document.removeEventListener(\"mousemove\", onMouseMove);\r\n    };\r\n  }, [ref, onMouseDistanceChanged]);\r\n}\r\n","import { connect } from \"react-redux\";\r\nimport { Dispatch } from \"redux\";\r\nimport { pick } from \"lodash\";\r\n\r\nimport { Vector2 } from \"@/math\";\r\n\r\nimport { AppState } from \"@/state\";\r\nimport { bouncersByIdSelector } from \"@/services/boing/selectors/bouncers\";\r\nimport { moveBouncer } from \"@/services/boing/actions/move-bouncer\";\r\n\r\nexport interface BouncerInputProps {\r\n  id: string;\r\n}\r\n\r\nfunction mapStateToProps(state: AppState, props: BouncerInputProps) {\r\n  const { id } = props;\r\n  const ball = bouncersByIdSelector(state)[id];\r\n  return pick(ball, [\"p1\", \"p2\", \"toneTriggerTimestamp\"]);\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch, props: BouncerInputProps) {\r\n  const { id } = props;\r\n  return {\r\n    onMove: (p1: Vector2, p2: Vector2) => dispatch(moveBouncer(id, p1, p2))\r\n  };\r\n}\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n);\r\n","import { connect } from \"react-redux\";\r\n\r\nimport { identities } from \"@/identity\";\r\n\r\nimport { AppState } from \"@/state\";\r\n\r\nimport { bouncersByIdSelector } from \"@/services/boing/selectors/bouncers\";\r\n\r\nfunction mapStateToProps(state: AppState) {\r\n  const bouncersById = bouncersByIdSelector(state);\r\n  const bouncerIds = identities(bouncersById);\r\n\r\n  return {\r\n    bouncerIds\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps);\r\n","import Emitter from \"./component\";\r\nimport connectEmitter from \"./connector\";\r\nexport default connectEmitter(Emitter);\r\n","import * as React from \"react\";\r\n\r\nimport Emitter from \"../Emitter\";\r\n\r\nexport interface BouncerFieldProps {\r\n  emitterIds: string[];\r\n}\r\n\r\nconst EmitterField: React.FC<BouncerFieldProps> = ({ emitterIds }) => (\r\n  <g>\r\n    {emitterIds.map(id => (\r\n      <Emitter key={id} id={id} />\r\n    ))}\r\n  </g>\r\n);\r\n\r\nexport default EmitterField;\r\n","import Emitter from \"./component\";\r\nimport connectEmitter from \"./connector\";\r\nexport default connectEmitter(Emitter);\r\n","import * as React from \"react\";\r\nimport injectSheet from \"react-jss\";\r\n\r\nimport { Vector2 } from \"@/math\";\r\nimport { createStyles, WithStyles } from \"@/theme\";\r\n\r\nimport usePointerDrag, { DragEvent } from \"@/hooks/use-pointer-drag\";\r\n\r\nimport RadialSvgSlider from \"../RadialSvgSlider\";\r\nimport AngleSvgSlider from \"../AngleSvgSlider\";\r\nimport MouseReveal from \"../MouseReveal\";\r\n\r\nexport interface EmitterProps {\r\n  position: Vector2;\r\n  rate: number;\r\n  angle: number;\r\n  onMove(x: number, y: number): void;\r\n  onSetRate(rate: number): void;\r\n  onSetDirection(angle: number): void;\r\n}\r\n\r\nconst styles = createStyles({\r\n  circle: {\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\ntype Props = EmitterProps & WithStyles<typeof styles>;\r\nconst Emitter: React.FC<Props> = ({\r\n  classes,\r\n  position,\r\n  rate,\r\n  angle,\r\n  onMove,\r\n  onSetRate,\r\n  onSetDirection\r\n}) => {\r\n  const ref = React.useRef<SVGCircleElement>(null);\r\n\r\n  const onDragMove = React.useCallback(\r\n    (e: DragEvent) => {\r\n      onMove(e.clientX, e.clientY);\r\n    },\r\n    [onMove]\r\n  );\r\n\r\n  const dragMove = usePointerDrag(null, onDragMove);\r\n\r\n  return (\r\n    <g transform={`translate(${position.x}, ${position.y})`}>\r\n      <circle\r\n        className={classes.circle}\r\n        ref={ref}\r\n        fill=\"grey\"\r\n        r={5}\r\n        cx={0}\r\n        cy={0}\r\n        onPointerDown={dragMove.pointerDown}\r\n        onPointerMove={dragMove.pointerMove}\r\n        onPointerUp={dragMove.pointerUp}\r\n      />\r\n      <MouseReveal originRef={ref}>\r\n        <RadialSvgSlider\r\n          cx={0}\r\n          cy={0}\r\n          r={15}\r\n          min={250}\r\n          max={3000}\r\n          value={rate}\r\n          onChange={onSetRate}\r\n        />\r\n        <AngleSvgSlider\r\n          cx={0}\r\n          cy={0}\r\n          r={30}\r\n          value={angle}\r\n          onChange={onSetDirection}\r\n        />\r\n      </MouseReveal>\r\n    </g>\r\n  );\r\n};\r\n\r\nexport default injectSheet(styles)(Emitter);\r\n","import RadialSvgSlider from \"./component\";\r\nexport default RadialSvgSlider;\r\n","import * as React from \"react\";\r\nimport injectSheet from \"react-jss\";\r\n\r\nimport { constrain, Vector2, angle, VEC_X } from \"@/math\";\r\n\r\nimport { createStyles, WithStyles } from \"@/theme\";\r\n\r\nexport interface RadialSvgSliderProps {\r\n  cx: number;\r\n  cy: number;\r\n  r: number;\r\n  min: number;\r\n  max: number;\r\n  value: number;\r\n  onChange(value: number): void;\r\n}\r\n\r\nconst styles = createStyles({\r\n  handle: {\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\nconst startAngle = Math.PI * (1 / 3);\r\nconst endAngle = Math.PI * (2 / 3);\r\nconst range = Math.PI * 2 - (endAngle - startAngle);\r\n\r\ntype Props = RadialSvgSliderProps & WithStyles<typeof styles>;\r\nconst RadialSvgSlider: React.FC<Props> = ({\r\n  cx,\r\n  cy,\r\n  r,\r\n  min,\r\n  max,\r\n  value,\r\n  classes,\r\n  onChange\r\n}) => {\r\n  const percent = constrain((value - min) / (max - min), 0, 1);\r\n  const rootRef = React.useRef<SVGPathElement>(null);\r\n  const handleRef = React.useRef<SVGPathElement>(null);\r\n  const [isPointerDown, setPointerDown] = React.useState(false);\r\n  const onHandlePointerDown = React.useCallback(\r\n    (e: React.PointerEvent<SVGPathElement>) => {\r\n      if (!handleRef.current) {\r\n        return;\r\n      }\r\n      setPointerDown(true);\r\n      handleRef.current.setPointerCapture(e.pointerId);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    [handleRef]\r\n  );\r\n  const onHandlePointerMove = React.useCallback(\r\n    (e: React.PointerEvent<SVGPathElement>) => {\r\n      if (!isPointerDown || !rootRef.current) {\r\n        return;\r\n      }\r\n\r\n      const box = rootRef.current.getBoundingClientRect();\r\n      const handleVec: Vector2 = {\r\n        x: e.clientX - (box.left + box.width / 2),\r\n        y: e.clientY - (box.top + box.height / 2)\r\n      };\r\n      const handleAngle = angle(VEC_X, handleVec);\r\n      let valueAngle = startAngle - handleAngle;\r\n      if (valueAngle < 0) {\r\n        valueAngle += Math.PI * 2;\r\n      }\r\n      const percent = constrain(valueAngle / range, 0, 1);\r\n      onChange(min + (max - min) * percent);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    [isPointerDown, rootRef, min, max, onChange]\r\n  );\r\n  const onHandlePointerUp = React.useCallback(\r\n    (e: React.PointerEvent<SVGPathElement>) => {\r\n      if (!handleRef.current) {\r\n        return;\r\n      }\r\n      setPointerDown(false);\r\n      handleRef.current.releasePointerCapture(e.pointerId);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    [handleRef]\r\n  );\r\n  return (\r\n    <g>\r\n      <path\r\n        ref={rootRef}\r\n        d={generatePath(cx, cy, r)}\r\n        stroke=\"dimgrey\"\r\n        strokeWidth={2}\r\n        fill=\"none\"\r\n      />\r\n      <path\r\n        className={classes.handle}\r\n        ref={handleRef}\r\n        d={generateHandlePath(cx, cy, r, percent)}\r\n        stroke=\"red\"\r\n        strokeWidth={5}\r\n        fill=\"none\"\r\n        onPointerDown={onHandlePointerDown}\r\n        onPointerMove={onHandlePointerMove}\r\n        onPointerUp={onHandlePointerUp}\r\n      />\r\n    </g>\r\n  );\r\n};\r\n\r\nexport default injectSheet(styles)(RadialSvgSlider);\r\n\r\nfunction generatePath(cx: number, cy: number, r: number): string {\r\n  return [\r\n    \"M\",\r\n    cx + Math.cos(startAngle) * r,\r\n    cy + Math.sin(startAngle) * r,\r\n    \"A\",\r\n    r,\r\n    r,\r\n    0,\r\n    1, //large\r\n    0,\r\n    cx + Math.cos(endAngle) * r,\r\n    cy + Math.sin(endAngle) * r\r\n  ].join(\" \");\r\n}\r\n\r\nfunction generateHandlePath(\r\n  cx: number,\r\n  cy: number,\r\n  r: number,\r\n  percent: number\r\n): string {\r\n  const angle = startAngle - range * percent;\r\n  return [\r\n    \"M\",\r\n    cx + Math.cos(angle) * (r - 6),\r\n    cy + Math.sin(angle) * (r - 6),\r\n    \"L\",\r\n    cx + Math.cos(angle) * (r + 6),\r\n    cy + Math.sin(angle) * (r + 6)\r\n  ].join(\" \");\r\n}\r\n","import * as React from \"react\";\r\nimport injectSheet from \"react-jss\";\r\n\r\nimport { createStyles, WithStyles } from \"@/theme\";\r\nimport { VEC_X, Vector2, angle } from \"@/math\";\r\n\r\nexport interface AngleSvgSliderProps {\r\n  cx: number;\r\n  cy: number;\r\n  r: number;\r\n  value: number;\r\n  onChange(value: number): void;\r\n}\r\n\r\nconst styles = createStyles({\r\n  handle: {\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\ntype Props = AngleSvgSliderProps & WithStyles<typeof styles>;\r\nconst AngleSvgSlider: React.FC<Props> = ({\r\n  cx,\r\n  cy,\r\n  r,\r\n  value,\r\n  classes,\r\n  onChange\r\n}) => {\r\n  const rootRef = React.useRef<SVGCircleElement>(null);\r\n  const handleRef = React.useRef<SVGPathElement>(null);\r\n  const [isPointerDown, setPointerDown] = React.useState(false);\r\n  const onHandlePointerDown = React.useCallback(\r\n    (e: React.PointerEvent<SVGPathElement>) => {\r\n      if (!handleRef.current) {\r\n        return;\r\n      }\r\n      setPointerDown(true);\r\n      handleRef.current.setPointerCapture(e.pointerId);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    [handleRef]\r\n  );\r\n  const onHandlePointerMove = React.useCallback(\r\n    (e: React.PointerEvent<SVGPathElement>) => {\r\n      if (!isPointerDown || !rootRef.current) {\r\n        return;\r\n      }\r\n      const box = rootRef.current.getBoundingClientRect();\r\n      const handleVec: Vector2 = {\r\n        x: e.clientX - (box.left + box.width / 2),\r\n        y: e.clientY - (box.top + box.height / 2)\r\n      };\r\n      let handleAngle = angle(VEC_X, handleVec);\r\n      if (handleAngle < 0) {\r\n        handleAngle += Math.PI * 2;\r\n      }\r\n      onChange(handleAngle);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    [isPointerDown, rootRef, onChange]\r\n  );\r\n  const onHandlePointerUp = React.useCallback(\r\n    (e: React.PointerEvent<SVGPathElement>) => {\r\n      if (!handleRef.current) {\r\n        return;\r\n      }\r\n      setPointerDown(false);\r\n      handleRef.current.releasePointerCapture(e.pointerId);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    [handleRef]\r\n  );\r\n  return (\r\n    <g>\r\n      <circle\r\n        ref={rootRef}\r\n        cx={cx}\r\n        cy={cy}\r\n        r={r}\r\n        stroke=\"grey\"\r\n        fill=\"none\"\r\n        strokeWidth={2}\r\n      />\r\n      <path\r\n        ref={handleRef}\r\n        className={classes.handle}\r\n        d={generateHandlePath(cx, cy, r, value)}\r\n        stroke=\"red\"\r\n        strokeWidth={5}\r\n        fill=\"none\"\r\n        onPointerDown={onHandlePointerDown}\r\n        onPointerMove={onHandlePointerMove}\r\n        onPointerUp={onHandlePointerUp}\r\n      />\r\n    </g>\r\n  );\r\n};\r\n\r\nexport default injectSheet(styles)(AngleSvgSlider);\r\n\r\nfunction generateHandlePath(\r\n  cx: number,\r\n  cy: number,\r\n  r: number,\r\n  angle: number\r\n): string {\r\n  return [\r\n    \"M\",\r\n    cx + Math.cos(angle) * (r - 6),\r\n    cy + Math.sin(angle) * (r - 6),\r\n    \"L\",\r\n    cx + Math.cos(angle) * (r + 6),\r\n    cy + Math.sin(angle) * (r + 6)\r\n  ].join(\" \");\r\n}\r\n","import { connect } from \"react-redux\";\r\nimport { Dispatch } from \"redux\";\r\nimport { pick } from \"lodash\";\r\n\r\nimport { VEC_X, angle } from \"@/math\";\r\n\r\nimport { AppState } from \"@/state\";\r\nimport { emittersByIdSelector } from \"@/services/boing/selectors/emitters\";\r\nimport { moveEmitter } from \"@/services/boing/actions/move-emitter\";\r\nimport { setEmitterRate } from \"@/services/boing/actions/set-emitter-rate\";\r\nimport { setEmitterDirection } from \"@/services/boing/actions/set-emitter-velocity\";\r\n\r\nexport interface EmitterInputProps {\r\n  id: string;\r\n}\r\n\r\nfunction mapStateToProps(state: AppState, props: EmitterInputProps) {\r\n  const { id } = props;\r\n  const emitter = emittersByIdSelector(state)[id];\r\n  return {\r\n    ...pick(emitter, [\"position\", \"rate\"]),\r\n    angle: angle(VEC_X, emitter.velocity)\r\n  };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch, props: EmitterInputProps) {\r\n  const { id } = props;\r\n  return {\r\n    onMove: (x: number, y: number) => dispatch(moveEmitter(id, x, y)),\r\n    onSetRate: (rate: number) => dispatch(setEmitterRate(id, rate)),\r\n    onSetDirection: (angle: number) => dispatch(setEmitterDirection(id, angle))\r\n  };\r\n}\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n);\r\n","import { connect } from \"react-redux\";\r\n\r\nimport { identities } from \"@/identity\";\r\n\r\nimport { AppState } from \"@/state\";\r\n\r\nimport { emittersByIdSelector } from \"@/services/boing/selectors/emitters\";\r\n\r\nfunction mapStateToProps(state: AppState) {\r\n  const emittersById = emittersByIdSelector(state);\r\n  const emitterIds = identities(emittersById);\r\n\r\n  return {\r\n    emitterIds\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps);\r\n","import AngleSvgSlider from \"../AngleSvgSlider\";\r\nimport connectGravitySlider from \"./connector\";\r\nexport default connectGravitySlider(AngleSvgSlider);\r\n","import { connect } from \"react-redux\";\r\n\r\nimport { AppState } from \"@/state\";\r\nimport { setGravityDirection } from \"@/services/boing/actions/set-gravity\";\r\nimport { gravityDirectionSelector } from \"@/services/boing/selectors/field\";\r\n\r\nfunction mapStateToProps(state: AppState) {\r\n  return {\r\n    value: gravityDirectionSelector(state)\r\n  };\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n  onChange: setGravityDirection\r\n};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n);\r\n","import { AppState } from \"@/state\";\r\nimport { angle, VEC_X } from \"@/math\";\r\n\r\nexport const gravitySelector = (state: AppState) =>\r\n  state.services.boing.gravity;\r\n\r\nexport const gravityDirectionSelector = (state: AppState) =>\r\n  angle(VEC_X, gravitySelector(state));\r\n","import ResetButton from \"./component\";\r\nimport connectResetButton from \"./connector\";\r\nexport default connectResetButton(ResetButton);\r\n","import * as React from \"react\";\r\nimport injectSheet from \"react-jss\";\r\n\r\nimport { createStyles, WithStyles } from \"@/theme\";\r\n\r\nexport interface ResetButtonProps {\r\n  x: number;\r\n  y: number;\r\n  onClick(): void;\r\n}\r\n\r\nconst styles = createStyles({\r\n  button: {\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\ntype Props = ResetButtonProps & WithStyles<typeof styles>;\r\nconst ResetButton: React.FC<Props> = ({ classes, x, y, onClick }) => (\r\n  // FontAwesome: times-circle\r\n  <svg\r\n    className={classes.button}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    x={x}\r\n    y={y}\r\n    width=\"20\"\r\n    height=\"20\"\r\n    viewBox=\"0 0 512 512\"\r\n    fill=\"grey\"\r\n    onClick={() => {\r\n      console.log(\"click\");\r\n      onClick();\r\n    }}\r\n  >\r\n    <circle cx={256} cy={256} r={256} fill=\"transparent\" />\r\n    <path d=\"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z\" />\r\n  </svg>\r\n);\r\n\r\nexport default injectSheet(styles)(ResetButton);\r\n","import { connect } from \"react-redux\";\r\n\r\nimport { reset } from \"@/services/boing/actions/reset\";\r\n\r\nconst mapDispatchToProps = {\r\n  onClick: reset\r\n};\r\n\r\nexport default connect(\r\n  null,\r\n  mapDispatchToProps\r\n);\r\n","import PlayButton from \"./component\";\r\nexport default PlayButton;\r\n","import * as React from \"react\";\r\nimport { createStyles, WithStyles } from \"@/theme\";\r\nimport injectSheet from \"react-jss\";\r\n\r\nexport interface PlayButtonProps {\r\n  x: number;\r\n  y: number;\r\n  onClick(): void;\r\n}\r\n\r\nconst styles = createStyles({\r\n  button: {\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\ntype Props = PlayButtonProps & WithStyles<typeof styles>;\r\nconst PlayButton: React.FC<Props> = ({ classes, x, y, onClick }) => (\r\n  <svg\r\n    className={classes.button}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    x={x}\r\n    y={y}\r\n    width=\"256\"\r\n    height=\"256\"\r\n    viewBox=\"0 0 512 512\"\r\n    fill=\"grey\"\r\n    onClick={onClick}\r\n  >\r\n    <circle cx={256} cy={256} r={256} fill=\"transparent\" />\r\n    <path d=\"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm115.7 272l-176 101c-15.8 8.8-35.7-2.5-35.7-21V152c0-18.4 19.8-29.8 35.7-21l176 107c16.4 9.2 16.4 32.9 0 42z\" />\r\n  </svg>\r\n);\r\n\r\nexport default injectSheet(styles)(PlayButton);\r\n","import { connect } from \"react-redux\";\r\n\r\nimport { createBouncer } from \"@/services/boing/actions/create-bouncer\";\r\nimport { setSize } from \"@/services/boing/actions/set-size\";\r\n\r\nconst mapDispatchToProps = {\r\n  onCreateBouncer: createBouncer,\r\n  onResize: setSize\r\n};\r\n\r\nexport default connect(\r\n  null,\r\n  mapDispatchToProps\r\n);\r\n"],"sourceRoot":""}